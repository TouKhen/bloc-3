<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.4"/>
    <title>viz API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.tip{color:#0a3622;background-color:#d1e7dd;border-color:#a3cfbb;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%230a3622%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%206a6%206%200%201%201%2010.174%204.31c-.203.196-.359.4-.453.619l-.762%201.769A.5.5%200%200%201%2010.5%2013a.5.5%200%200%201%200%201%20.5.5%200%200%201%200%201l-.224.447a1%201%200%200%201-.894.553H6.618a1%201%200%200%201-.894-.553L5.5%2015a.5.5%200%200%201%200-1%20.5.5%200%200%201%200-1%20.5.5%200%200%201-.46-.302l-.761-1.77a2%202%200%200%200-.453-.618A5.98%205.98%200%200%201%202%206m6-5a5%205%200%200%200-3.479%208.592c.263.254.514.564.676.941L5.83%2012h4.342l.632-1.467c.162-.377.413-.687.676-.941A5%205%200%200%200%208%201%22/%3E%3C/svg%3E");}.pdoc .alert.important{color:#055160;background-color:#cff4fc;border-color:#9eeaf9;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23055160%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%200a2%202%200%200%200-2%202v12a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V2a2%202%200%200%200-2-2zm6%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.caution{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M11.46.146A.5.5%200%200%200%2011.107%200H4.893a.5.5%200%200%200-.353.146L.146%204.54A.5.5%200%200%200%200%204.893v6.214a.5.5%200%200%200%20.146.353l4.394%204.394a.5.5%200%200%200%20.353.146h6.214a.5.5%200%200%200%20.353-.146l4.394-4.394a.5.5%200%200%200%20.146-.353V4.893a.5.5%200%200%200-.146-.353zM8%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>




            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#Viz">Viz</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Viz.plot_corr_with_target">plot_corr_with_target</a>
                        </li>
                        <li>
                                <a class="function" href="#Viz.simple_comparison_bar_plot">simple_comparison_bar_plot</a>
                        </li>
                        <li>
                                <a class="function" href="#Viz.superposed_bar_plot">superposed_bar_plot</a>
                        </li>
                        <li>
                                <a class="function" href="#Viz.stacked_bar_plot">stacked_bar_plot</a>
                        </li>
                        <li>
                                <a class="function" href="#Viz.total_charges_distribution">total_charges_distribution</a>
                        </li>
                        <li>
                                <a class="function" href="#Viz.feature_weights_bar">feature_weights_bar</a>
                        </li>
                        <li>
                                <a class="function" href="#Viz.confusion_matrix">confusion_matrix</a>
                        </li>
                        <li>
                                <a class="function" href="#Viz.roc_curve">roc_curve</a>
                        </li>
                        <li>
                                <a class="function" href="#Viz.coef_plot">coef_plot</a>
                        </li>
                        <li>
                                <a class="function" href="#Viz.residuals_scatter">residuals_scatter</a>
                        </li>
                        <li>
                                <a class="function" href="#Viz.plot_r2_poly_degree">plot_r2_poly_degree</a>
                        </li>
                        <li>
                                <a class="function" href="#Viz.plot_tree">plot_tree</a>
                        </li>
                        <li>
                                <a class="function" href="#Viz.importance_viz_barplot">importance_viz_barplot</a>
                        </li>
                        <li>
                                <a class="function" href="#Viz.scores_comparison_plot">scores_comparison_plot</a>
                        </li>
                        <li>
                                <a class="function" href="#Viz.cross_validation_comparison_plot">cross_validation_comparison_plot</a>
                        </li>
                        <li>
                                <a class="function" href="#Viz.grid_search_plot">grid_search_plot</a>
                        </li>
                        <li>
                                <a class="function" href="#Viz.cv_plot">cv_plot</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
viz    </h1>

                
                        <input id="mod-viz-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-viz-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> \
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a>    <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">auc</span><span class="p">,</span> <span class="n">roc_auc_score</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Viz</span><span class="p">:</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a>        <span class="k">pass</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_corr_with_target</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="sd">        Plots the correlation of the given target variable with all other features in the</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="sd">        DataFrame. The function calculates the Pearson correlation of the target variable</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="sd">        with other features, sorts them in descending order, and visualizes them using</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="sd">        a horizontal bar plot.</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="sd">        :param df: A pandas DataFrame containing the features and the target variable.</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="sd">        :type df: pd.DataFrame</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="sd">        :param target: The column name of the target variable for which correlation</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="sd">            is to be visualized.</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="sd">        :type target: str</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="sd">        :return: Does not return a value. Saves the plot as a PNG file named</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="sd">            &#39;corr_with_&lt;target&gt;.png&#39; in the &#39;../reports/figures/&#39; directory.</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">        :rtype: None</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>        <span class="n">corr</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">()[</span><span class="n">target</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">corr</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">corr</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Set2&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="n">corr</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Correlation with Churn&#39;</span><span class="p">)</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Pearson correlation&#39;</span><span class="p">)</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Feature&#39;</span><span class="p">)</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;../reports/figures/corr_with_</span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">)</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">simple_comparison_bar_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="p">:</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">        Create a bar plot to visualize the percentage distribution of a target column in</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">        a given DataFrame. The function calculates the percentage for each unique value</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">        in the column and displays them as a bar chart with percentage labels.</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">        :param df: Input DataFrame containing the dataset.</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">        :type df: pd.DataFrame</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">        :param target: Column name in the DataFrame for which the distribution is visualized.</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">        :type target: str</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">        :return: None</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>        <span class="c1"># Calculate percentages</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>        <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target</span><span class="p">])</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>        <span class="n">percentages</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span> <span class="o">/</span> <span class="n">total</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>        <span class="c1"># Create a bar plot with percentages</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">percentages</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s1"> Distribution&#39;</span><span class="p">)</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>        <span class="c1"># Add percentage labels on top of each bar</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">percentages</span><span class="p">):</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Percentage&#39;</span><span class="p">)</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">superposed_bar_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">target_1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target_2</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">        Generates a superposed bar plot to visualize the distribution of a specified target</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">        variable for two subsets of data, split based on another categorical column.</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">        This function creates overlaid histograms for two groups within the dataset,</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">        distinguished by the binary values of the categorical column (`target_1`). The</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">        distribution is shown for another numerical or categorical column (`target_2`),</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">        providing insights on how the values of the numerical/categorical column vary</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">        across the two subsets.</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">        :param df: A pandas DataFrame containing the data to be visualized.</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">        :param target_1: The name of the categorical column is used to split the data into</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">            two subsets. Should have binary values (e.g., 0 and 1).</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">        :param target_2: The name of the numerical or categorical column for which the</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">            distribution is visualized using histograms.</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">        :return: None</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">target_1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">target_2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;No </span><span class="si">{</span><span class="n">target_1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">target_1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">target_2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">target_1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Distribution of Customer </span><span class="si">{</span><span class="n">target_2</span><span class="si">}</span><span class="s1"> by </span><span class="si">{</span><span class="n">target_1</span><span class="si">}</span><span class="s1"> Status&#39;</span><span class="p">)</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">target_2</span><span class="si">}</span><span class="s1"> (months)&#39;</span><span class="p">)</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">stacked_bar_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">target_1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target_2</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">        Creates a stacked bar plot visualizing the proportion of a target variable</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="sd">        across subcategories of another categorical variable. The proportions are</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">        displayed as percentages within each bar.</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">        :param df: Pandas DataFrame containing the data used for the plot.</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">        :type df: pd.DataFrame</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="sd">        :param target_1: The column name for the first categorical variable to group by.</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">        :type target_1: str</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">        :param target_2: The column name for the second categorical variable</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">                         representing the target whose distribution is plotted.</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">        :type target_2: str</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">        :return: None. Displays a matplotlib plot.</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="sd">        :rtype: None</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>        <span class="n">churn_by_senior</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">target_1</span><span class="p">,</span> <span class="n">target_2</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>        <span class="n">total</span> <span class="o">=</span> <span class="n">churn_by_senior</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>        <span class="n">percentages</span> <span class="o">=</span> <span class="p">(</span><span class="n">churn_by_senior</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">total</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>        <span class="n">churn_by_senior</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Churn Distribution by </span><span class="si">{</span><span class="n">target_1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Senior Citizen (0=No, 1=Yes)&#39;</span><span class="p">)</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Number of Customers&#39;</span><span class="p">)</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Churn&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;Yes&#39;</span><span class="p">])</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">churn_by_senior</span><span class="o">.</span><span class="n">index</span><span class="p">)):</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>            <span class="n">no_churn</span> <span class="o">=</span> <span class="n">percentages</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>            <span class="n">churn</span> <span class="o">=</span> <span class="n">percentages</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">churn_by_senior</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>                     <span class="sa">f</span><span class="s1">&#39;No: </span><span class="si">{</span><span class="n">no_churn</span><span class="si">}</span><span class="s1">%</span><span class="se">\n</span><span class="s1">Yes: </span><span class="si">{</span><span class="n">churn</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>                     <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">total_charges_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a><span class="sd">        Generates and displays a histogram representing the distribution of the</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a><span class="sd">        &#39;TotalCharges&#39; column of a given DataFrame, segmented by the &#39;Churn&#39;</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a><span class="sd">        status. The histogram includes percentage labels for each bin, indicating</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a><span class="sd">        the percentage count of entries by churn group.</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a><span class="sd">        :param df: A Pandas DataFrame containing the data to be visualized.</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a><span class="sd">                   The DataFrame must include columns &#39;TotalCharges&#39; and &#39;Churn&#39;.</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a><span class="sd">        :type df: pd.DataFrame</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="sd">        :return: None</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>        <span class="c1"># Calculate the percentage for each bin</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>        <span class="n">hist_data_no</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Churn&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;TotalCharges&#39;</span><span class="p">],</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>                                <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>        <span class="n">hist_data_yes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Churn&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s1">&#39;TotalCharges&#39;</span><span class="p">],</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>                                 <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>  <span class="c1"># Clear the figure</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>        <span class="c1"># Plot with percentages</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;TotalCharges&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Churn&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>                     <span class="n">multiple</span><span class="o">=</span><span class="s2">&quot;layer&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>        <span class="c1"># Add percentage labels</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hist_data_no</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>            <span class="k">if</span> <span class="n">hist_data_no</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Only add label if there are values in the bin</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">hist_data_no</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">hist_data_no</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>                         <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">(</span><span class="n">hist_data_no</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Churn&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>                         <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>            <span class="k">if</span> <span class="n">hist_data_yes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Only add label if there are values in the bin</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">hist_data_yes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">hist_data_yes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>                         <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">(</span><span class="n">hist_data_yes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Churn&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>                         <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Total Charges by Churn Status&#39;</span><span class="p">)</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Total Charges ($)&#39;</span><span class="p">)</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Churn&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;Yes&#39;</span><span class="p">])</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">feature_weights_bar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feature_weights</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a><span class="sd">        Generates a bar plot for visualizing feature weights from a logistic regression model.</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a><span class="sd">        This method uses seaborn to create a bar plot where the weights of the features</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a><span class="sd">        are displayed along the x-axis and their corresponding feature names on the y-axis.</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a><span class="sd">        The output figure provides an intuitive understanding of the importance of features</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a><span class="sd">        in the logistic regression model.</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a><span class="sd">        :param feature_weights: A Pandas DataFrame containing two columns, &#39;Weight&#39; and</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a><span class="sd">            &#39;Feature&#39;, where &#39;Weight&#39; represents the corresponding feature importance and</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a><span class="sd">            &#39;Feature&#39; provides the feature names.</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a><span class="sd">        :return: None</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">feature_weights</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Weight&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Feature&#39;</span><span class="p">)</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Logistic Regression Feature Weights&#39;</span><span class="p">)</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Weight&#39;</span><span class="p">)</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Feature&#39;</span><span class="p">)</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">confusion_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a><span class="sd">        Generates and visualizes a confusion matrix for the provided predictions and</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a><span class="sd">        true labels. Calculates and displays various performance metrics such as</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a><span class="sd">        accuracy, precision, specificity, and F1 score.</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a><span class="sd">        :param predictions: Array of predicted labels, typically coming from</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a><span class="sd">            a machine learning model&#39;s output.</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a><span class="sd">        :type predictions: array-like</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a><span class="sd">        :param y_test: Array of true labels against which predictions are compared.</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a><span class="sd">        :type y_test: array-like</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a><span class="sd">        :return: None</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>        <span class="c1"># Create confusion matrix</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>        <span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>        <span class="c1"># Calculate specificity</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>        <span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>        <span class="n">specificity</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span> <span class="o">+</span> <span class="n">fp</span><span class="p">)</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>        <span class="c1"># Calculate other metrics</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>        <span class="n">precision</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>        <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>        <span class="c1"># Plot confusion matrix</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion Matrix&#39;</span><span class="p">)</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;True Label&#39;</span><span class="p">)</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted Label&#39;</span><span class="p">)</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Accuracy: </span><span class="si">{</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">predictions</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Precision: </span><span class="si">{</span><span class="n">precision</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Specificity: </span><span class="si">{</span><span class="n">specificity</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;F1 Score: </span><span class="si">{</span><span class="n">f1</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">roc_curve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_pred_probas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_test</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a><span class="sd">        Plots the Receiver Operating Characteristic (ROC) Curve for given predicted probabilities and</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a><span class="sd">        true labels. If a list of predicted probabilities and true labels is provided, it generates</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a><span class="sd">        multiple ROC curves. The Area Under the Curve (AUC) is also computed and displayed for</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a><span class="sd">        each curve.</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a><span class="sd">        :param y_pred_probas: List or single array-like of predicted probabilities.</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a><span class="sd">        :param y_test: List or single array-like of true labels.</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a><span class="sd">        :param labels: List of strings to label each ROC curve. Defaults to [&#39;ROC curve&#39;] if not provided.</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a><span class="sd">        :return: None</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>        <span class="c1"># If single curve</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred_probas</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>            <span class="n">y_pred_probas</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_pred_probas</span><span class="p">]</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>            <span class="n">y_test</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_test</span><span class="p">]</span> 
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ROC curve&#39;</span><span class="p">]</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>        <span class="c1"># Plot ROC curve</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>        
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>        <span class="k">for</span> <span class="n">y_pred_proba</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">y_pred_probas</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>            <span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">)</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>            <span class="n">roc_auc</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">)</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1"> (AUC = </span><span class="si">{</span><span class="n">roc_auc</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;False Positive Rate&#39;</span><span class="p">)</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;True Positive Rate&#39;</span><span class="p">)</span> 
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Receiver Operating Characteristic (ROC) Curve&#39;</span><span class="p">)</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">coef_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lr_model</span><span class="p">,</span> <span class="n">subset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a><span class="sd">        Creates a bar plot of the coefficients of features for a given linear regression model</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a><span class="sd">        and a subset of features. This visualization helps in understanding the importance or</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a><span class="sd">        impact of each feature in the trained linear regression model.</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a><span class="sd">        :param lr_model: A trained linear regression model whose coefficients will be used</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a><span class="sd">            for plotting.</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a><span class="sd">        :type lr_model: sklearn.linear_model._base.LinearRegression</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a><span class="sd">        :param subset: A DataFrame containing the subset of features corresponding to the</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a><span class="sd">            coefficients in the linear regression model.</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a><span class="sd">        :type subset: pandas.DataFrame</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a><span class="sd">        :return: None</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>        <span class="n">coef_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>            <span class="s1">&#39;Feature&#39;</span><span class="p">:</span> <span class="n">subset</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>            <span class="s1">&#39;Coefficient&#39;</span><span class="p">:</span> <span class="n">lr_model</span><span class="o">.</span><span class="n">coef_</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>        <span class="p">})</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">coef_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Coefficient&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Feature&#39;</span><span class="p">)</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Feature Coefficients in Linear Regression&#39;</span><span class="p">)</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Coefficient Value&#39;</span><span class="p">)</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Feature&#39;</span><span class="p">)</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">residuals_scatter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_test_sub</span><span class="p">,</span> <span class="n">prediction</span><span class="p">):</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a><span class="sd">        Compute and display a residuals scatter plot. The residuals are calculated as</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a><span class="sd">        the difference between the true values (`y_test_sub`) and the predicted</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a><span class="sd">        values (`prediction`). The scatter plot visualizes these residuals against the</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a><span class="sd">        predicted values, which can provide insights into the prediction model&#39;s</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a><span class="sd">        performance and highlight any patterns or biases.</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a><span class="sd">        :param y_test_sub: Array of true target values.</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a><span class="sd">        :param prediction: Array of predicted target values.</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a><span class="sd">        :return: None</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>        <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test_sub</span> <span class="o">-</span> <span class="n">prediction</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">prediction</span><span class="p">,</span> <span class="n">residuals</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Residual Plot&#39;</span><span class="p">)</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted Values&#39;</span><span class="p">)</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Residuals&#39;</span><span class="p">)</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_r2_poly_degree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">poly_reg_scores</span><span class="p">):</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a><span class="sd">        Plot the R² scores of polynomial regression models against their polynomial degrees.</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a><span class="sd">        This function visualizes the relationship between different polynomial degrees and their</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a><span class="sd">        corresponding R² scores using a bar chart. Each bar represents the R² score of a specific</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a><span class="sd">        polynomial degree, and its exact value is displayed as text above the bar.</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a><span class="sd">        :param poly_reg_scores: A dictionary where keys represent the degree of the polynomial</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a><span class="sd">            (int) and values are the corresponding R² scores (float).</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a><span class="sd">        :return: None. The function displays the plot but does not return any value.</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">poly_reg_scores</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">poly_reg_scores</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;R² Score by Polynomial Degree&#39;</span><span class="p">)</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Polynomial Degree&#39;</span><span class="p">)</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;R² Score&#39;</span><span class="p">)</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">poly_reg_scores</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clf_tree</span><span class="p">):</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a><span class="sd">        Visualizes a decision tree classifier using matplotlib.</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a><span class="sd">        This method takes a decision tree classifier and generates a visual</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a><span class="sd">        representation of the tree structure using matplotlib. The tree is</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a><span class="sd">        plotted with a filled node style.</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a><span class="sd">        :param clf_tree: The decision tree classifier model to be plotted.</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a><span class="sd">        :type clf_tree: sklearn.tree.DecisionTreeClassifier</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a><span class="sd">        :return: None</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn</span><span class="w"> </span><span class="kn">import</span> <span class="n">tree</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>        <span class="n">tree</span><span class="o">.</span><span class="n">plot_tree</span><span class="p">(</span><span class="n">clf_tree</span><span class="p">,</span> <span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">importance_viz_barplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">importances</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a><span class="sd">        Generates a bar plot visualization of feature importances for a specific model.</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a><span class="sd">        This function creates a horizontal bar plot for representing feature importance</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a><span class="sd">        data by using Matplotlib and Seaborn libraries. The plot is titled to</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a><span class="sd">        indicate the model&#39;s name, and it highlights the most important features</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a><span class="sd">        in descending order of their importance.</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a><span class="sd">        :param importances:</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a><span class="sd">            A pandas DataFrame containing feature importance information. It is</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a><span class="sd">            expected to have at least two columns:</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a><span class="sd">            - &#39;feature&#39;: Names of the features.</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a><span class="sd">            - &#39;importance&#39;: Importance scores for the features (assumed to be numerical).</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a><span class="sd">        :param name:</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a><span class="sd">            A string representing the name of the model whose feature</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a><span class="sd">            importance is visualized.</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a><span class="sd">        :return:</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a><span class="sd">            None</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">importances</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;importance&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;feature&#39;</span><span class="p">)</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Top </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">importances</span><span class="p">)</span><span class="si">}</span><span class="s1"> Most Important Features in </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> Model&#39;</span><span class="p">)</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Feature Importance&#39;</span><span class="p">)</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">scores_comparison_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metrics</span><span class="p">):</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a><span class="sd">        Generates a series of bar plots to compare a set of classification metrics across</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a><span class="sd">        different models or configurations.</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a><span class="sd">        The function takes in a dictionary containing metric scores (Precision, Recall,</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a><span class="sd">        F1, and AUC) for each model. It creates a 2x2 grid of subplots, where each subplot</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a><span class="sd">        represents one of the metrics, and displays a side-by-side bar plot for the models.</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a><span class="sd">        The function ensures the y-axis for each plot ranges from 0 to 1 to enhance</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a><span class="sd">        comparability.</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a><span class="sd">        :param metrics: A dictionary where keys are model names or configurations and</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a><span class="sd">            values are nested dictionaries containing the metrics (&#39;Precision&#39;, &#39;Recall&#39;,</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a><span class="sd">            &#39;F1&#39;, and &#39;AUC&#39;) as keys and their corresponding scores as values.</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a><span class="sd">            Example:</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a><span class="sd">                {</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a><span class="sd">                    &quot;Model_1&quot;: {&quot;Precision&quot;: 0.85, &quot;Recall&quot;: 0.80, &quot;F1&quot;: 0.82, &quot;AUC&quot;: 0.90},</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a><span class="sd">                    &quot;Model_2&quot;: {&quot;Precision&quot;: 0.83, &quot;Recall&quot;: 0.78, &quot;F1&quot;: 0.80, &quot;AUC&quot;: 0.89}</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a><span class="sd">                }</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a><span class="sd">        :return: None</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>        <span class="c1"># Create comparison plots</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">),</span> <span class="p">(</span><span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">))</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>        <span class="n">metrics_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>        <span class="c1"># Precision plot</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>        <span class="n">metrics_df</span><span class="p">[</span><span class="s1">&#39;Precision&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Precision Comparison&#39;</span><span class="p">)</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>        <span class="c1"># Recall plot</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>        <span class="n">metrics_df</span><span class="p">[</span><span class="s1">&#39;Recall&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgreen&#39;</span><span class="p">)</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Recall Comparison&#39;</span><span class="p">)</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>        <span class="c1"># F1 plot</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>        <span class="n">metrics_df</span><span class="p">[</span><span class="s1">&#39;F1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">)</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;F1 Score Comparison&#39;</span><span class="p">)</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>        <span class="c1"># AUC plot</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>        <span class="n">metrics_df</span><span class="p">[</span><span class="s1">&#39;AUC&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;plum&#39;</span><span class="p">)</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>        <span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;AUC Score Comparison&#39;</span><span class="p">)</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>        <span class="n">ax4</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cross_validation_comparison_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">models</span><span class="p">):</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a><span class="sd">        Generates a bar plot comparing the mean and standard deviation of cross-validation</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a><span class="sd">        scores for multiple models. The input `models` should be a dictionary where keys</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a><span class="sd">        are model names and values are lists of cross-validation scores.</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a><span class="sd">        The function computes the mean and standard deviation for each model, and visualizes</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a><span class="sd">        them using a bar plot with error bars. Each bar represents a model&#39;s average score</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a><span class="sd">        with corresponding error bars indicating its standard deviation.</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a><span class="sd">        :param models: A dictionary where keys are model names (str) and values are lists</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a><span class="sd">            of cross-validation scores (list of floats).</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a><span class="sd">        :type models: dict</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a><span class="sd">        :return: None</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>        <span class="n">means</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">scores</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>        <span class="n">stds</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">scores</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>        <span class="c1"># Plot comparison</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">means</span><span class="p">)),</span> <span class="n">means</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">yerr</span><span class="o">=</span><span class="n">stds</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>                <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="s1">&#39;lightgreen&#39;</span><span class="p">,</span> <span class="s1">&#39;salmon&#39;</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">])</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">means</span><span class="p">)),</span> <span class="n">means</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Cross-Validation Scores Comparison&#39;</span><span class="p">)</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Mean CV Score&#39;</span><span class="p">)</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>        <span class="c1"># Add value labels</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">means</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="o">+</span> <span class="n">stds</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">means</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">i</span><span class="p">]],</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>                     <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">grid_search_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metrics_comparison</span><span class="p">,</span> <span class="n">old_model</span><span class="p">,</span> <span class="n">old_model_class</span><span class="p">,</span> <span class="n">new_model</span><span class="p">,</span> <span class="n">new_model_class</span><span class="p">):</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a><span class="sd">        Plots the comparison of multiple metrics (Accuracy, Precision, Recall, F1) between</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a><span class="sd">        two models, and their respective ROC curves. The function creates a visual comparison</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a><span class="sd">        of an original model and a tuned model, with subplots for each metric and a separate</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a><span class="sd">        plot for the ROC curves. Metrics are displayed as bar plots, and ROC/AUC metrics</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a><span class="sd">        are presented as line graphs.</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a><span class="sd">        :param metrics_comparison: A dictionary containing metric values (e.g. Accuracy,</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a><span class="sd">            Precision, Recall, F1) for the models being compared. The keys should include &#39;Original&#39;</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a><span class="sd">            and &#39;Tuned&#39;, with associated metrics as subkeys.</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a><span class="sd">        :type metrics_comparison: dict</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a><span class="sd">        :param old_model: The original, &#39;untuned&#39; machine learning model. Must be a model</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a><span class="sd">            object with a `predict_proba` method.</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a><span class="sd">        :param old_model_class: An object encapsulating the test data (`X_test`, `y_test`).</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a><span class="sd">            Must provide a `y_test` attribute and `X_test` attribute for predictions.</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a><span class="sd">        :type old_model_class: object</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a><span class="sd">        :param new_model: The optimized or tuned machine learning model. Must be a model</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a><span class="sd">            object with a `predict_proba` method.</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a><span class="sd">        :param new_model_class: An object encapsulating test data (`X_test`, `y_test`)</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a><span class="sd">            for the tuned model. Must provide a `y_test` attribute and `X_test` attribute</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a><span class="sd">            for predictions.</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a><span class="sd">        :type new_model_class: object</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a><span class="sd">        :return: None</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a>        <span class="c1"># Create subplots for each metric</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">),</span> <span class="p">(</span><span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">))</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>        <span class="c1"># Plot each metric</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>        <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;Precision&#39;</span><span class="p">,</span> <span class="s1">&#39;Recall&#39;</span><span class="p">,</span> <span class="s1">&#39;F1&#39;</span><span class="p">]</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="s1">&#39;lightgreen&#39;</span><span class="p">]</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>        <span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">metrics</span><span class="p">,</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">]):</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">metrics_comparison</span><span class="p">[</span><span class="s1">&#39;Original&#39;</span><span class="p">][</span><span class="n">metric</span><span class="p">],</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>                      <span class="n">metrics_comparison</span><span class="p">[</span><span class="s1">&#39;Tuned&#39;</span><span class="p">][</span><span class="n">metric</span><span class="p">]]</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="s1">&#39;Original&#39;</span><span class="p">,</span> <span class="s1">&#39;Tuned&#39;</span><span class="p">],</span> <span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s1"> Comparison&#39;</span><span class="p">)</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>            <span class="c1"># Add value labels</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>        <span class="c1"># Plot ROC curves for both models</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a>        <span class="c1"># Original model ROC curve</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>        <span class="n">fpr_orig</span><span class="p">,</span> <span class="n">tpr_orig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">old_model_class</span><span class="o">.</span><span class="n">y_test</span><span class="p">,</span> <span class="n">old_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">old_model_class</span><span class="o">.</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_orig</span><span class="p">,</span> <span class="n">tpr_orig</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a>                 <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Original (AUC = </span><span class="si">{</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">old_model_class</span><span class="o">.</span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">old_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">old_model_class</span><span class="o">.</span><span class="n">X_test</span><span class="p">)[:,</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>        <span class="c1"># Tuned model ROC curve</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>        <span class="n">fpr_tuned</span><span class="p">,</span> <span class="n">tpr_tuned</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">new_model_class</span><span class="o">.</span><span class="n">y_test</span><span class="p">,</span> <span class="n">new_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">new_model_class</span><span class="o">.</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_tuned</span><span class="p">,</span> <span class="n">tpr_tuned</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgreen&#39;</span><span class="p">,</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a>                 <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Tuned (AUC = </span><span class="si">{</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">new_model_class</span><span class="o">.</span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">new_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">new_model_class</span><span class="o">.</span><span class="n">X_test</span><span class="p">)[:,</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;False Positive Rate&#39;</span><span class="p">)</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;True Positive Rate&#39;</span><span class="p">)</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ROC Curves Comparison&#39;</span><span class="p">)</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cv_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cv_results</span><span class="p">,</span> <span class="n">models</span><span class="p">):</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a><span class="sd">        Plots cross-validation results for multiple models.</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a><span class="sd">        This function generates bar plots for evaluation metrics such as accuracy,</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a><span class="sd">        precision, recall, and F1-score. Each plot displays the mean values along</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a><span class="sd">        with error bars representing the standard deviation for the specified metrics.</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a><span class="sd">        The results are visualized using a grid layout.</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a><span class="sd">        :param cv_results: A dictionary containing cross-validation results for</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a><span class="sd">            each model. The format should be:</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a><span class="sd">            {</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a><span class="sd">                &#39;model_name&#39;: {</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a><span class="sd">                    &#39;accuracy&#39;: {&#39;mean&#39;: float, &#39;std&#39;: float},</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a><span class="sd">                    &#39;precision&#39;: {&#39;mean&#39;: float, &#39;std&#39;: float},</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a><span class="sd">                    &#39;recall&#39;: {&#39;mean&#39;: float, &#39;std&#39;: float},</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a><span class="sd">                    &#39;f1&#39;: {&#39;mean&#39;: float, &#39;std&#39;: float}</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a><span class="sd">                },</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a><span class="sd">                ...</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a><span class="sd">            }</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a><span class="sd">        :param dict models: A dictionary containing model names as keys and their</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a><span class="sd">            corresponding estimators or classifiers as values. The keys are used in the</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a><span class="sd">            plot as labels.</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a><span class="sd">        :return: None</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a>        <span class="c1"># Plot results</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">),</span> <span class="p">(</span><span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">))</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a>        <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="s1">&#39;recall&#39;</span><span class="p">,</span> <span class="s1">&#39;f1&#39;</span><span class="p">]</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a>        <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">]</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a>        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="s1">&#39;lightgreen&#39;</span><span class="p">,</span> <span class="s1">&#39;salmon&#39;</span><span class="p">]</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a>        <span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">metrics</span><span class="p">,</span> <span class="n">axes</span><span class="p">):</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a>            <span class="n">means</span> <span class="o">=</span> <span class="p">[</span><span class="n">cv_results</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">metric</span><span class="p">][</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a>            <span class="n">stds</span> <span class="o">=</span> <span class="p">[</span><span class="n">cv_results</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">metric</span><span class="p">][</span><span class="s1">&#39;std&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">))</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">means</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">stds</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">metric</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s1"> Score&#39;</span><span class="p">)</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a>            <span class="c1"># Add value labels</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">means</span><span class="p">):</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="o">+</span> <span class="n">stds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a>
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></pre></div>


            </section>
                <section id="Viz">
                            <input id="Viz-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Viz</span>:

                <label class="view-source-button" for="Viz-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Viz"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Viz-9"><a href="#Viz-9"><span class="linenos">  9</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Viz</span><span class="p">:</span>
</span><span id="Viz-10"><a href="#Viz-10"><span class="linenos"> 10</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Viz-11"><a href="#Viz-11"><span class="linenos"> 11</span></a>        <span class="k">pass</span>
</span><span id="Viz-12"><a href="#Viz-12"><span class="linenos"> 12</span></a>
</span><span id="Viz-13"><a href="#Viz-13"><span class="linenos"> 13</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_corr_with_target</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Viz-14"><a href="#Viz-14"><span class="linenos"> 14</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz-15"><a href="#Viz-15"><span class="linenos"> 15</span></a><span class="sd">        Plots the correlation of the given target variable with all other features in the</span>
</span><span id="Viz-16"><a href="#Viz-16"><span class="linenos"> 16</span></a><span class="sd">        DataFrame. The function calculates the Pearson correlation of the target variable</span>
</span><span id="Viz-17"><a href="#Viz-17"><span class="linenos"> 17</span></a><span class="sd">        with other features, sorts them in descending order, and visualizes them using</span>
</span><span id="Viz-18"><a href="#Viz-18"><span class="linenos"> 18</span></a><span class="sd">        a horizontal bar plot.</span>
</span><span id="Viz-19"><a href="#Viz-19"><span class="linenos"> 19</span></a>
</span><span id="Viz-20"><a href="#Viz-20"><span class="linenos"> 20</span></a><span class="sd">        :param df: A pandas DataFrame containing the features and the target variable.</span>
</span><span id="Viz-21"><a href="#Viz-21"><span class="linenos"> 21</span></a><span class="sd">        :type df: pd.DataFrame</span>
</span><span id="Viz-22"><a href="#Viz-22"><span class="linenos"> 22</span></a><span class="sd">        :param target: The column name of the target variable for which correlation</span>
</span><span id="Viz-23"><a href="#Viz-23"><span class="linenos"> 23</span></a><span class="sd">            is to be visualized.</span>
</span><span id="Viz-24"><a href="#Viz-24"><span class="linenos"> 24</span></a><span class="sd">        :type target: str</span>
</span><span id="Viz-25"><a href="#Viz-25"><span class="linenos"> 25</span></a><span class="sd">        :return: Does not return a value. Saves the plot as a PNG file named</span>
</span><span id="Viz-26"><a href="#Viz-26"><span class="linenos"> 26</span></a><span class="sd">            &#39;corr_with_&lt;target&gt;.png&#39; in the &#39;../reports/figures/&#39; directory.</span>
</span><span id="Viz-27"><a href="#Viz-27"><span class="linenos"> 27</span></a><span class="sd">        :rtype: None</span>
</span><span id="Viz-28"><a href="#Viz-28"><span class="linenos"> 28</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz-29"><a href="#Viz-29"><span class="linenos"> 29</span></a>        <span class="n">corr</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">()[</span><span class="n">target</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Viz-30"><a href="#Viz-30"><span class="linenos"> 30</span></a>
</span><span id="Viz-31"><a href="#Viz-31"><span class="linenos"> 31</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</span><span id="Viz-32"><a href="#Viz-32"><span class="linenos"> 32</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">corr</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">corr</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Set2&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="n">corr</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</span><span id="Viz-33"><a href="#Viz-33"><span class="linenos"> 33</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Correlation with Churn&#39;</span><span class="p">)</span>
</span><span id="Viz-34"><a href="#Viz-34"><span class="linenos"> 34</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Pearson correlation&#39;</span><span class="p">)</span>
</span><span id="Viz-35"><a href="#Viz-35"><span class="linenos"> 35</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Feature&#39;</span><span class="p">)</span>
</span><span id="Viz-36"><a href="#Viz-36"><span class="linenos"> 36</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</span><span id="Viz-37"><a href="#Viz-37"><span class="linenos"> 37</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;../reports/figures/corr_with_</span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">)</span>
</span><span id="Viz-38"><a href="#Viz-38"><span class="linenos"> 38</span></a>
</span><span id="Viz-39"><a href="#Viz-39"><span class="linenos"> 39</span></a>
</span><span id="Viz-40"><a href="#Viz-40"><span class="linenos"> 40</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">simple_comparison_bar_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="p">:</span>
</span><span id="Viz-41"><a href="#Viz-41"><span class="linenos"> 41</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz-42"><a href="#Viz-42"><span class="linenos"> 42</span></a><span class="sd">        Create a bar plot to visualize the percentage distribution of a target column in</span>
</span><span id="Viz-43"><a href="#Viz-43"><span class="linenos"> 43</span></a><span class="sd">        a given DataFrame. The function calculates the percentage for each unique value</span>
</span><span id="Viz-44"><a href="#Viz-44"><span class="linenos"> 44</span></a><span class="sd">        in the column and displays them as a bar chart with percentage labels.</span>
</span><span id="Viz-45"><a href="#Viz-45"><span class="linenos"> 45</span></a>
</span><span id="Viz-46"><a href="#Viz-46"><span class="linenos"> 46</span></a><span class="sd">        :param df: Input DataFrame containing the dataset.</span>
</span><span id="Viz-47"><a href="#Viz-47"><span class="linenos"> 47</span></a><span class="sd">        :type df: pd.DataFrame</span>
</span><span id="Viz-48"><a href="#Viz-48"><span class="linenos"> 48</span></a><span class="sd">        :param target: Column name in the DataFrame for which the distribution is visualized.</span>
</span><span id="Viz-49"><a href="#Viz-49"><span class="linenos"> 49</span></a><span class="sd">        :type target: str</span>
</span><span id="Viz-50"><a href="#Viz-50"><span class="linenos"> 50</span></a><span class="sd">        :return: None</span>
</span><span id="Viz-51"><a href="#Viz-51"><span class="linenos"> 51</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz-52"><a href="#Viz-52"><span class="linenos"> 52</span></a>        <span class="c1"># Calculate percentages</span>
</span><span id="Viz-53"><a href="#Viz-53"><span class="linenos"> 53</span></a>        <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target</span><span class="p">])</span>
</span><span id="Viz-54"><a href="#Viz-54"><span class="linenos"> 54</span></a>        <span class="n">percentages</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span> <span class="o">/</span> <span class="n">total</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="Viz-55"><a href="#Viz-55"><span class="linenos"> 55</span></a>
</span><span id="Viz-56"><a href="#Viz-56"><span class="linenos"> 56</span></a>        <span class="c1"># Create a bar plot with percentages</span>
</span><span id="Viz-57"><a href="#Viz-57"><span class="linenos"> 57</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">percentages</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s1"> Distribution&#39;</span><span class="p">)</span>
</span><span id="Viz-58"><a href="#Viz-58"><span class="linenos"> 58</span></a>
</span><span id="Viz-59"><a href="#Viz-59"><span class="linenos"> 59</span></a>        <span class="c1"># Add percentage labels on top of each bar</span>
</span><span id="Viz-60"><a href="#Viz-60"><span class="linenos"> 60</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">percentages</span><span class="p">):</span>
</span><span id="Viz-61"><a href="#Viz-61"><span class="linenos"> 61</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
</span><span id="Viz-62"><a href="#Viz-62"><span class="linenos"> 62</span></a>
</span><span id="Viz-63"><a href="#Viz-63"><span class="linenos"> 63</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Percentage&#39;</span><span class="p">)</span>
</span><span id="Viz-64"><a href="#Viz-64"><span class="linenos"> 64</span></a>
</span><span id="Viz-65"><a href="#Viz-65"><span class="linenos"> 65</span></a>
</span><span id="Viz-66"><a href="#Viz-66"><span class="linenos"> 66</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">superposed_bar_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">target_1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target_2</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Viz-67"><a href="#Viz-67"><span class="linenos"> 67</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz-68"><a href="#Viz-68"><span class="linenos"> 68</span></a><span class="sd">        Generates a superposed bar plot to visualize the distribution of a specified target</span>
</span><span id="Viz-69"><a href="#Viz-69"><span class="linenos"> 69</span></a><span class="sd">        variable for two subsets of data, split based on another categorical column.</span>
</span><span id="Viz-70"><a href="#Viz-70"><span class="linenos"> 70</span></a>
</span><span id="Viz-71"><a href="#Viz-71"><span class="linenos"> 71</span></a><span class="sd">        This function creates overlaid histograms for two groups within the dataset,</span>
</span><span id="Viz-72"><a href="#Viz-72"><span class="linenos"> 72</span></a><span class="sd">        distinguished by the binary values of the categorical column (`target_1`). The</span>
</span><span id="Viz-73"><a href="#Viz-73"><span class="linenos"> 73</span></a><span class="sd">        distribution is shown for another numerical or categorical column (`target_2`),</span>
</span><span id="Viz-74"><a href="#Viz-74"><span class="linenos"> 74</span></a><span class="sd">        providing insights on how the values of the numerical/categorical column vary</span>
</span><span id="Viz-75"><a href="#Viz-75"><span class="linenos"> 75</span></a><span class="sd">        across the two subsets.</span>
</span><span id="Viz-76"><a href="#Viz-76"><span class="linenos"> 76</span></a>
</span><span id="Viz-77"><a href="#Viz-77"><span class="linenos"> 77</span></a><span class="sd">        :param df: A pandas DataFrame containing the data to be visualized.</span>
</span><span id="Viz-78"><a href="#Viz-78"><span class="linenos"> 78</span></a><span class="sd">        :param target_1: The name of the categorical column is used to split the data into</span>
</span><span id="Viz-79"><a href="#Viz-79"><span class="linenos"> 79</span></a><span class="sd">            two subsets. Should have binary values (e.g., 0 and 1).</span>
</span><span id="Viz-80"><a href="#Viz-80"><span class="linenos"> 80</span></a><span class="sd">        :param target_2: The name of the numerical or categorical column for which the</span>
</span><span id="Viz-81"><a href="#Viz-81"><span class="linenos"> 81</span></a><span class="sd">            distribution is visualized using histograms.</span>
</span><span id="Viz-82"><a href="#Viz-82"><span class="linenos"> 82</span></a><span class="sd">        :return: None</span>
</span><span id="Viz-83"><a href="#Viz-83"><span class="linenos"> 83</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz-84"><a href="#Viz-84"><span class="linenos"> 84</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Viz-85"><a href="#Viz-85"><span class="linenos"> 85</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">target_1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">target_2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;No </span><span class="si">{</span><span class="n">target_1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="Viz-86"><a href="#Viz-86"><span class="linenos"> 86</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">target_1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">target_2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">target_1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="Viz-87"><a href="#Viz-87"><span class="linenos"> 87</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Distribution of Customer </span><span class="si">{</span><span class="n">target_2</span><span class="si">}</span><span class="s1"> by </span><span class="si">{</span><span class="n">target_1</span><span class="si">}</span><span class="s1"> Status&#39;</span><span class="p">)</span>
</span><span id="Viz-88"><a href="#Viz-88"><span class="linenos"> 88</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">target_2</span><span class="si">}</span><span class="s1"> (months)&#39;</span><span class="p">)</span>
</span><span id="Viz-89"><a href="#Viz-89"><span class="linenos"> 89</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
</span><span id="Viz-90"><a href="#Viz-90"><span class="linenos"> 90</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="Viz-91"><a href="#Viz-91"><span class="linenos"> 91</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="Viz-92"><a href="#Viz-92"><span class="linenos"> 92</span></a>
</span><span id="Viz-93"><a href="#Viz-93"><span class="linenos"> 93</span></a>
</span><span id="Viz-94"><a href="#Viz-94"><span class="linenos"> 94</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">stacked_bar_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">target_1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target_2</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Viz-95"><a href="#Viz-95"><span class="linenos"> 95</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz-96"><a href="#Viz-96"><span class="linenos"> 96</span></a><span class="sd">        Creates a stacked bar plot visualizing the proportion of a target variable</span>
</span><span id="Viz-97"><a href="#Viz-97"><span class="linenos"> 97</span></a><span class="sd">        across subcategories of another categorical variable. The proportions are</span>
</span><span id="Viz-98"><a href="#Viz-98"><span class="linenos"> 98</span></a><span class="sd">        displayed as percentages within each bar.</span>
</span><span id="Viz-99"><a href="#Viz-99"><span class="linenos"> 99</span></a>
</span><span id="Viz-100"><a href="#Viz-100"><span class="linenos">100</span></a><span class="sd">        :param df: Pandas DataFrame containing the data used for the plot.</span>
</span><span id="Viz-101"><a href="#Viz-101"><span class="linenos">101</span></a><span class="sd">        :type df: pd.DataFrame</span>
</span><span id="Viz-102"><a href="#Viz-102"><span class="linenos">102</span></a><span class="sd">        :param target_1: The column name for the first categorical variable to group by.</span>
</span><span id="Viz-103"><a href="#Viz-103"><span class="linenos">103</span></a><span class="sd">        :type target_1: str</span>
</span><span id="Viz-104"><a href="#Viz-104"><span class="linenos">104</span></a><span class="sd">        :param target_2: The column name for the second categorical variable</span>
</span><span id="Viz-105"><a href="#Viz-105"><span class="linenos">105</span></a><span class="sd">                         representing the target whose distribution is plotted.</span>
</span><span id="Viz-106"><a href="#Viz-106"><span class="linenos">106</span></a><span class="sd">        :type target_2: str</span>
</span><span id="Viz-107"><a href="#Viz-107"><span class="linenos">107</span></a><span class="sd">        :return: None. Displays a matplotlib plot.</span>
</span><span id="Viz-108"><a href="#Viz-108"><span class="linenos">108</span></a><span class="sd">        :rtype: None</span>
</span><span id="Viz-109"><a href="#Viz-109"><span class="linenos">109</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz-110"><a href="#Viz-110"><span class="linenos">110</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Viz-111"><a href="#Viz-111"><span class="linenos">111</span></a>        <span class="n">churn_by_senior</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">target_1</span><span class="p">,</span> <span class="n">target_2</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</span><span id="Viz-112"><a href="#Viz-112"><span class="linenos">112</span></a>        <span class="n">total</span> <span class="o">=</span> <span class="n">churn_by_senior</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Viz-113"><a href="#Viz-113"><span class="linenos">113</span></a>        <span class="n">percentages</span> <span class="o">=</span> <span class="p">(</span><span class="n">churn_by_senior</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">total</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Viz-114"><a href="#Viz-114"><span class="linenos">114</span></a>
</span><span id="Viz-115"><a href="#Viz-115"><span class="linenos">115</span></a>        <span class="n">churn_by_senior</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Viz-116"><a href="#Viz-116"><span class="linenos">116</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Churn Distribution by </span><span class="si">{</span><span class="n">target_1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Viz-117"><a href="#Viz-117"><span class="linenos">117</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Senior Citizen (0=No, 1=Yes)&#39;</span><span class="p">)</span>
</span><span id="Viz-118"><a href="#Viz-118"><span class="linenos">118</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Number of Customers&#39;</span><span class="p">)</span>
</span><span id="Viz-119"><a href="#Viz-119"><span class="linenos">119</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Churn&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;Yes&#39;</span><span class="p">])</span>
</span><span id="Viz-120"><a href="#Viz-120"><span class="linenos">120</span></a>
</span><span id="Viz-121"><a href="#Viz-121"><span class="linenos">121</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">churn_by_senior</span><span class="o">.</span><span class="n">index</span><span class="p">)):</span>
</span><span id="Viz-122"><a href="#Viz-122"><span class="linenos">122</span></a>            <span class="n">no_churn</span> <span class="o">=</span> <span class="n">percentages</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="Viz-123"><a href="#Viz-123"><span class="linenos">123</span></a>            <span class="n">churn</span> <span class="o">=</span> <span class="n">percentages</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="Viz-124"><a href="#Viz-124"><span class="linenos">124</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">churn_by_senior</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="Viz-125"><a href="#Viz-125"><span class="linenos">125</span></a>                     <span class="sa">f</span><span class="s1">&#39;No: </span><span class="si">{</span><span class="n">no_churn</span><span class="si">}</span><span class="s1">%</span><span class="se">\n</span><span class="s1">Yes: </span><span class="si">{</span><span class="n">churn</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span>
</span><span id="Viz-126"><a href="#Viz-126"><span class="linenos">126</span></a>                     <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
</span><span id="Viz-127"><a href="#Viz-127"><span class="linenos">127</span></a>
</span><span id="Viz-128"><a href="#Viz-128"><span class="linenos">128</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="Viz-129"><a href="#Viz-129"><span class="linenos">129</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="Viz-130"><a href="#Viz-130"><span class="linenos">130</span></a>
</span><span id="Viz-131"><a href="#Viz-131"><span class="linenos">131</span></a>
</span><span id="Viz-132"><a href="#Viz-132"><span class="linenos">132</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">total_charges_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Viz-133"><a href="#Viz-133"><span class="linenos">133</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz-134"><a href="#Viz-134"><span class="linenos">134</span></a><span class="sd">        Generates and displays a histogram representing the distribution of the</span>
</span><span id="Viz-135"><a href="#Viz-135"><span class="linenos">135</span></a><span class="sd">        &#39;TotalCharges&#39; column of a given DataFrame, segmented by the &#39;Churn&#39;</span>
</span><span id="Viz-136"><a href="#Viz-136"><span class="linenos">136</span></a><span class="sd">        status. The histogram includes percentage labels for each bin, indicating</span>
</span><span id="Viz-137"><a href="#Viz-137"><span class="linenos">137</span></a><span class="sd">        the percentage count of entries by churn group.</span>
</span><span id="Viz-138"><a href="#Viz-138"><span class="linenos">138</span></a>
</span><span id="Viz-139"><a href="#Viz-139"><span class="linenos">139</span></a><span class="sd">        :param df: A Pandas DataFrame containing the data to be visualized.</span>
</span><span id="Viz-140"><a href="#Viz-140"><span class="linenos">140</span></a><span class="sd">                   The DataFrame must include columns &#39;TotalCharges&#39; and &#39;Churn&#39;.</span>
</span><span id="Viz-141"><a href="#Viz-141"><span class="linenos">141</span></a><span class="sd">        :type df: pd.DataFrame</span>
</span><span id="Viz-142"><a href="#Viz-142"><span class="linenos">142</span></a><span class="sd">        :return: None</span>
</span><span id="Viz-143"><a href="#Viz-143"><span class="linenos">143</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz-144"><a href="#Viz-144"><span class="linenos">144</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Viz-145"><a href="#Viz-145"><span class="linenos">145</span></a>        <span class="c1"># Calculate the percentage for each bin</span>
</span><span id="Viz-146"><a href="#Viz-146"><span class="linenos">146</span></a>        <span class="n">hist_data_no</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Churn&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;TotalCharges&#39;</span><span class="p">],</span>
</span><span id="Viz-147"><a href="#Viz-147"><span class="linenos">147</span></a>                                <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Viz-148"><a href="#Viz-148"><span class="linenos">148</span></a>        <span class="n">hist_data_yes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Churn&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s1">&#39;TotalCharges&#39;</span><span class="p">],</span>
</span><span id="Viz-149"><a href="#Viz-149"><span class="linenos">149</span></a>                                 <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Viz-150"><a href="#Viz-150"><span class="linenos">150</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>  <span class="c1"># Clear the figure</span>
</span><span id="Viz-151"><a href="#Viz-151"><span class="linenos">151</span></a>
</span><span id="Viz-152"><a href="#Viz-152"><span class="linenos">152</span></a>        <span class="c1"># Plot with percentages</span>
</span><span id="Viz-153"><a href="#Viz-153"><span class="linenos">153</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;TotalCharges&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Churn&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
</span><span id="Viz-154"><a href="#Viz-154"><span class="linenos">154</span></a>                     <span class="n">multiple</span><span class="o">=</span><span class="s2">&quot;layer&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="Viz-155"><a href="#Viz-155"><span class="linenos">155</span></a>
</span><span id="Viz-156"><a href="#Viz-156"><span class="linenos">156</span></a>        <span class="c1"># Add percentage labels</span>
</span><span id="Viz-157"><a href="#Viz-157"><span class="linenos">157</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hist_data_no</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
</span><span id="Viz-158"><a href="#Viz-158"><span class="linenos">158</span></a>            <span class="k">if</span> <span class="n">hist_data_no</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Only add label if there are values in the bin</span>
</span><span id="Viz-159"><a href="#Viz-159"><span class="linenos">159</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">hist_data_no</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">hist_data_no</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span>
</span><span id="Viz-160"><a href="#Viz-160"><span class="linenos">160</span></a>                         <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">(</span><span class="n">hist_data_no</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Churn&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span>
</span><span id="Viz-161"><a href="#Viz-161"><span class="linenos">161</span></a>                         <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
</span><span id="Viz-162"><a href="#Viz-162"><span class="linenos">162</span></a>            <span class="k">if</span> <span class="n">hist_data_yes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Only add label if there are values in the bin</span>
</span><span id="Viz-163"><a href="#Viz-163"><span class="linenos">163</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">hist_data_yes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">hist_data_yes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span>
</span><span id="Viz-164"><a href="#Viz-164"><span class="linenos">164</span></a>                         <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">(</span><span class="n">hist_data_yes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Churn&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span>
</span><span id="Viz-165"><a href="#Viz-165"><span class="linenos">165</span></a>                         <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
</span><span id="Viz-166"><a href="#Viz-166"><span class="linenos">166</span></a>
</span><span id="Viz-167"><a href="#Viz-167"><span class="linenos">167</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Total Charges by Churn Status&#39;</span><span class="p">)</span>
</span><span id="Viz-168"><a href="#Viz-168"><span class="linenos">168</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Total Charges ($)&#39;</span><span class="p">)</span>
</span><span id="Viz-169"><a href="#Viz-169"><span class="linenos">169</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
</span><span id="Viz-170"><a href="#Viz-170"><span class="linenos">170</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Churn&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;Yes&#39;</span><span class="p">])</span>
</span><span id="Viz-171"><a href="#Viz-171"><span class="linenos">171</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="Viz-172"><a href="#Viz-172"><span class="linenos">172</span></a>
</span><span id="Viz-173"><a href="#Viz-173"><span class="linenos">173</span></a>
</span><span id="Viz-174"><a href="#Viz-174"><span class="linenos">174</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">feature_weights_bar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feature_weights</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Viz-175"><a href="#Viz-175"><span class="linenos">175</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz-176"><a href="#Viz-176"><span class="linenos">176</span></a><span class="sd">        Generates a bar plot for visualizing feature weights from a logistic regression model.</span>
</span><span id="Viz-177"><a href="#Viz-177"><span class="linenos">177</span></a>
</span><span id="Viz-178"><a href="#Viz-178"><span class="linenos">178</span></a><span class="sd">        This method uses seaborn to create a bar plot where the weights of the features</span>
</span><span id="Viz-179"><a href="#Viz-179"><span class="linenos">179</span></a><span class="sd">        are displayed along the x-axis and their corresponding feature names on the y-axis.</span>
</span><span id="Viz-180"><a href="#Viz-180"><span class="linenos">180</span></a><span class="sd">        The output figure provides an intuitive understanding of the importance of features</span>
</span><span id="Viz-181"><a href="#Viz-181"><span class="linenos">181</span></a><span class="sd">        in the logistic regression model.</span>
</span><span id="Viz-182"><a href="#Viz-182"><span class="linenos">182</span></a>
</span><span id="Viz-183"><a href="#Viz-183"><span class="linenos">183</span></a><span class="sd">        :param feature_weights: A Pandas DataFrame containing two columns, &#39;Weight&#39; and</span>
</span><span id="Viz-184"><a href="#Viz-184"><span class="linenos">184</span></a><span class="sd">            &#39;Feature&#39;, where &#39;Weight&#39; represents the corresponding feature importance and</span>
</span><span id="Viz-185"><a href="#Viz-185"><span class="linenos">185</span></a><span class="sd">            &#39;Feature&#39; provides the feature names.</span>
</span><span id="Viz-186"><a href="#Viz-186"><span class="linenos">186</span></a>
</span><span id="Viz-187"><a href="#Viz-187"><span class="linenos">187</span></a><span class="sd">        :return: None</span>
</span><span id="Viz-188"><a href="#Viz-188"><span class="linenos">188</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz-189"><a href="#Viz-189"><span class="linenos">189</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</span><span id="Viz-190"><a href="#Viz-190"><span class="linenos">190</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">feature_weights</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Weight&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Feature&#39;</span><span class="p">)</span>
</span><span id="Viz-191"><a href="#Viz-191"><span class="linenos">191</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Logistic Regression Feature Weights&#39;</span><span class="p">)</span>
</span><span id="Viz-192"><a href="#Viz-192"><span class="linenos">192</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Weight&#39;</span><span class="p">)</span>
</span><span id="Viz-193"><a href="#Viz-193"><span class="linenos">193</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Feature&#39;</span><span class="p">)</span>
</span><span id="Viz-194"><a href="#Viz-194"><span class="linenos">194</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="Viz-195"><a href="#Viz-195"><span class="linenos">195</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="Viz-196"><a href="#Viz-196"><span class="linenos">196</span></a>
</span><span id="Viz-197"><a href="#Viz-197"><span class="linenos">197</span></a>
</span><span id="Viz-198"><a href="#Viz-198"><span class="linenos">198</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">confusion_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Viz-199"><a href="#Viz-199"><span class="linenos">199</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz-200"><a href="#Viz-200"><span class="linenos">200</span></a><span class="sd">        Generates and visualizes a confusion matrix for the provided predictions and</span>
</span><span id="Viz-201"><a href="#Viz-201"><span class="linenos">201</span></a><span class="sd">        true labels. Calculates and displays various performance metrics such as</span>
</span><span id="Viz-202"><a href="#Viz-202"><span class="linenos">202</span></a><span class="sd">        accuracy, precision, specificity, and F1 score.</span>
</span><span id="Viz-203"><a href="#Viz-203"><span class="linenos">203</span></a>
</span><span id="Viz-204"><a href="#Viz-204"><span class="linenos">204</span></a><span class="sd">        :param predictions: Array of predicted labels, typically coming from</span>
</span><span id="Viz-205"><a href="#Viz-205"><span class="linenos">205</span></a><span class="sd">            a machine learning model&#39;s output.</span>
</span><span id="Viz-206"><a href="#Viz-206"><span class="linenos">206</span></a><span class="sd">        :type predictions: array-like</span>
</span><span id="Viz-207"><a href="#Viz-207"><span class="linenos">207</span></a><span class="sd">        :param y_test: Array of true labels against which predictions are compared.</span>
</span><span id="Viz-208"><a href="#Viz-208"><span class="linenos">208</span></a><span class="sd">        :type y_test: array-like</span>
</span><span id="Viz-209"><a href="#Viz-209"><span class="linenos">209</span></a><span class="sd">        :return: None</span>
</span><span id="Viz-210"><a href="#Viz-210"><span class="linenos">210</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz-211"><a href="#Viz-211"><span class="linenos">211</span></a>        <span class="c1"># Create confusion matrix</span>
</span><span id="Viz-212"><a href="#Viz-212"><span class="linenos">212</span></a>        <span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
</span><span id="Viz-213"><a href="#Viz-213"><span class="linenos">213</span></a>
</span><span id="Viz-214"><a href="#Viz-214"><span class="linenos">214</span></a>        <span class="c1"># Calculate specificity</span>
</span><span id="Viz-215"><a href="#Viz-215"><span class="linenos">215</span></a>        <span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</span><span id="Viz-216"><a href="#Viz-216"><span class="linenos">216</span></a>        <span class="n">specificity</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span> <span class="o">+</span> <span class="n">fp</span><span class="p">)</span>
</span><span id="Viz-217"><a href="#Viz-217"><span class="linenos">217</span></a>
</span><span id="Viz-218"><a href="#Viz-218"><span class="linenos">218</span></a>        <span class="c1"># Calculate other metrics</span>
</span><span id="Viz-219"><a href="#Viz-219"><span class="linenos">219</span></a>        <span class="n">precision</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
</span><span id="Viz-220"><a href="#Viz-220"><span class="linenos">220</span></a>        <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
</span><span id="Viz-221"><a href="#Viz-221"><span class="linenos">221</span></a>
</span><span id="Viz-222"><a href="#Viz-222"><span class="linenos">222</span></a>        <span class="c1"># Plot confusion matrix</span>
</span><span id="Viz-223"><a href="#Viz-223"><span class="linenos">223</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Viz-224"><a href="#Viz-224"><span class="linenos">224</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
</span><span id="Viz-225"><a href="#Viz-225"><span class="linenos">225</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion Matrix&#39;</span><span class="p">)</span>
</span><span id="Viz-226"><a href="#Viz-226"><span class="linenos">226</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;True Label&#39;</span><span class="p">)</span>
</span><span id="Viz-227"><a href="#Viz-227"><span class="linenos">227</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted Label&#39;</span><span class="p">)</span>
</span><span id="Viz-228"><a href="#Viz-228"><span class="linenos">228</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="Viz-229"><a href="#Viz-229"><span class="linenos">229</span></a>
</span><span id="Viz-230"><a href="#Viz-230"><span class="linenos">230</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Accuracy: </span><span class="si">{</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">predictions</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Viz-231"><a href="#Viz-231"><span class="linenos">231</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Precision: </span><span class="si">{</span><span class="n">precision</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Viz-232"><a href="#Viz-232"><span class="linenos">232</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Specificity: </span><span class="si">{</span><span class="n">specificity</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Viz-233"><a href="#Viz-233"><span class="linenos">233</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;F1 Score: </span><span class="si">{</span><span class="n">f1</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Viz-234"><a href="#Viz-234"><span class="linenos">234</span></a>
</span><span id="Viz-235"><a href="#Viz-235"><span class="linenos">235</span></a>
</span><span id="Viz-236"><a href="#Viz-236"><span class="linenos">236</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">roc_curve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_pred_probas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_test</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Viz-237"><a href="#Viz-237"><span class="linenos">237</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz-238"><a href="#Viz-238"><span class="linenos">238</span></a><span class="sd">        Plots the Receiver Operating Characteristic (ROC) Curve for given predicted probabilities and</span>
</span><span id="Viz-239"><a href="#Viz-239"><span class="linenos">239</span></a><span class="sd">        true labels. If a list of predicted probabilities and true labels is provided, it generates</span>
</span><span id="Viz-240"><a href="#Viz-240"><span class="linenos">240</span></a><span class="sd">        multiple ROC curves. The Area Under the Curve (AUC) is also computed and displayed for</span>
</span><span id="Viz-241"><a href="#Viz-241"><span class="linenos">241</span></a><span class="sd">        each curve.</span>
</span><span id="Viz-242"><a href="#Viz-242"><span class="linenos">242</span></a>
</span><span id="Viz-243"><a href="#Viz-243"><span class="linenos">243</span></a><span class="sd">        :param y_pred_probas: List or single array-like of predicted probabilities.</span>
</span><span id="Viz-244"><a href="#Viz-244"><span class="linenos">244</span></a><span class="sd">        :param y_test: List or single array-like of true labels.</span>
</span><span id="Viz-245"><a href="#Viz-245"><span class="linenos">245</span></a><span class="sd">        :param labels: List of strings to label each ROC curve. Defaults to [&#39;ROC curve&#39;] if not provided.</span>
</span><span id="Viz-246"><a href="#Viz-246"><span class="linenos">246</span></a><span class="sd">        :return: None</span>
</span><span id="Viz-247"><a href="#Viz-247"><span class="linenos">247</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz-248"><a href="#Viz-248"><span class="linenos">248</span></a>        <span class="c1"># If single curve</span>
</span><span id="Viz-249"><a href="#Viz-249"><span class="linenos">249</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred_probas</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Viz-250"><a href="#Viz-250"><span class="linenos">250</span></a>            <span class="n">y_pred_probas</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_pred_probas</span><span class="p">]</span>
</span><span id="Viz-251"><a href="#Viz-251"><span class="linenos">251</span></a>            <span class="n">y_test</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_test</span><span class="p">]</span> 
</span><span id="Viz-252"><a href="#Viz-252"><span class="linenos">252</span></a>            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ROC curve&#39;</span><span class="p">]</span>
</span><span id="Viz-253"><a href="#Viz-253"><span class="linenos">253</span></a>
</span><span id="Viz-254"><a href="#Viz-254"><span class="linenos">254</span></a>        <span class="c1"># Plot ROC curve</span>
</span><span id="Viz-255"><a href="#Viz-255"><span class="linenos">255</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Viz-256"><a href="#Viz-256"><span class="linenos">256</span></a>        
</span><span id="Viz-257"><a href="#Viz-257"><span class="linenos">257</span></a>        <span class="k">for</span> <span class="n">y_pred_proba</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">y_pred_probas</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
</span><span id="Viz-258"><a href="#Viz-258"><span class="linenos">258</span></a>            <span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">)</span>
</span><span id="Viz-259"><a href="#Viz-259"><span class="linenos">259</span></a>            <span class="n">roc_auc</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">)</span>
</span><span id="Viz-260"><a href="#Viz-260"><span class="linenos">260</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1"> (AUC = </span><span class="si">{</span><span class="n">roc_auc</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</span><span id="Viz-261"><a href="#Viz-261"><span class="linenos">261</span></a>
</span><span id="Viz-262"><a href="#Viz-262"><span class="linenos">262</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
</span><span id="Viz-263"><a href="#Viz-263"><span class="linenos">263</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
</span><span id="Viz-264"><a href="#Viz-264"><span class="linenos">264</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
</span><span id="Viz-265"><a href="#Viz-265"><span class="linenos">265</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;False Positive Rate&#39;</span><span class="p">)</span>
</span><span id="Viz-266"><a href="#Viz-266"><span class="linenos">266</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;True Positive Rate&#39;</span><span class="p">)</span> 
</span><span id="Viz-267"><a href="#Viz-267"><span class="linenos">267</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Receiver Operating Characteristic (ROC) Curve&#39;</span><span class="p">)</span>
</span><span id="Viz-268"><a href="#Viz-268"><span class="linenos">268</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
</span><span id="Viz-269"><a href="#Viz-269"><span class="linenos">269</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="Viz-270"><a href="#Viz-270"><span class="linenos">270</span></a>
</span><span id="Viz-271"><a href="#Viz-271"><span class="linenos">271</span></a>
</span><span id="Viz-272"><a href="#Viz-272"><span class="linenos">272</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">coef_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lr_model</span><span class="p">,</span> <span class="n">subset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Viz-273"><a href="#Viz-273"><span class="linenos">273</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz-274"><a href="#Viz-274"><span class="linenos">274</span></a><span class="sd">        Creates a bar plot of the coefficients of features for a given linear regression model</span>
</span><span id="Viz-275"><a href="#Viz-275"><span class="linenos">275</span></a><span class="sd">        and a subset of features. This visualization helps in understanding the importance or</span>
</span><span id="Viz-276"><a href="#Viz-276"><span class="linenos">276</span></a><span class="sd">        impact of each feature in the trained linear regression model.</span>
</span><span id="Viz-277"><a href="#Viz-277"><span class="linenos">277</span></a>
</span><span id="Viz-278"><a href="#Viz-278"><span class="linenos">278</span></a><span class="sd">        :param lr_model: A trained linear regression model whose coefficients will be used</span>
</span><span id="Viz-279"><a href="#Viz-279"><span class="linenos">279</span></a><span class="sd">            for plotting.</span>
</span><span id="Viz-280"><a href="#Viz-280"><span class="linenos">280</span></a><span class="sd">        :type lr_model: sklearn.linear_model._base.LinearRegression</span>
</span><span id="Viz-281"><a href="#Viz-281"><span class="linenos">281</span></a><span class="sd">        :param subset: A DataFrame containing the subset of features corresponding to the</span>
</span><span id="Viz-282"><a href="#Viz-282"><span class="linenos">282</span></a><span class="sd">            coefficients in the linear regression model.</span>
</span><span id="Viz-283"><a href="#Viz-283"><span class="linenos">283</span></a><span class="sd">        :type subset: pandas.DataFrame</span>
</span><span id="Viz-284"><a href="#Viz-284"><span class="linenos">284</span></a><span class="sd">        :return: None</span>
</span><span id="Viz-285"><a href="#Viz-285"><span class="linenos">285</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz-286"><a href="#Viz-286"><span class="linenos">286</span></a>
</span><span id="Viz-287"><a href="#Viz-287"><span class="linenos">287</span></a>        <span class="n">coef_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span><span id="Viz-288"><a href="#Viz-288"><span class="linenos">288</span></a>            <span class="s1">&#39;Feature&#39;</span><span class="p">:</span> <span class="n">subset</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
</span><span id="Viz-289"><a href="#Viz-289"><span class="linenos">289</span></a>            <span class="s1">&#39;Coefficient&#39;</span><span class="p">:</span> <span class="n">lr_model</span><span class="o">.</span><span class="n">coef_</span>
</span><span id="Viz-290"><a href="#Viz-290"><span class="linenos">290</span></a>        <span class="p">})</span>
</span><span id="Viz-291"><a href="#Viz-291"><span class="linenos">291</span></a>
</span><span id="Viz-292"><a href="#Viz-292"><span class="linenos">292</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Viz-293"><a href="#Viz-293"><span class="linenos">293</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">coef_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Coefficient&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Feature&#39;</span><span class="p">)</span>
</span><span id="Viz-294"><a href="#Viz-294"><span class="linenos">294</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Feature Coefficients in Linear Regression&#39;</span><span class="p">)</span>
</span><span id="Viz-295"><a href="#Viz-295"><span class="linenos">295</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Coefficient Value&#39;</span><span class="p">)</span>
</span><span id="Viz-296"><a href="#Viz-296"><span class="linenos">296</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Feature&#39;</span><span class="p">)</span>
</span><span id="Viz-297"><a href="#Viz-297"><span class="linenos">297</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="Viz-298"><a href="#Viz-298"><span class="linenos">298</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="Viz-299"><a href="#Viz-299"><span class="linenos">299</span></a>
</span><span id="Viz-300"><a href="#Viz-300"><span class="linenos">300</span></a>
</span><span id="Viz-301"><a href="#Viz-301"><span class="linenos">301</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">residuals_scatter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_test_sub</span><span class="p">,</span> <span class="n">prediction</span><span class="p">):</span>
</span><span id="Viz-302"><a href="#Viz-302"><span class="linenos">302</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz-303"><a href="#Viz-303"><span class="linenos">303</span></a><span class="sd">        Compute and display a residuals scatter plot. The residuals are calculated as</span>
</span><span id="Viz-304"><a href="#Viz-304"><span class="linenos">304</span></a><span class="sd">        the difference between the true values (`y_test_sub`) and the predicted</span>
</span><span id="Viz-305"><a href="#Viz-305"><span class="linenos">305</span></a><span class="sd">        values (`prediction`). The scatter plot visualizes these residuals against the</span>
</span><span id="Viz-306"><a href="#Viz-306"><span class="linenos">306</span></a><span class="sd">        predicted values, which can provide insights into the prediction model&#39;s</span>
</span><span id="Viz-307"><a href="#Viz-307"><span class="linenos">307</span></a><span class="sd">        performance and highlight any patterns or biases.</span>
</span><span id="Viz-308"><a href="#Viz-308"><span class="linenos">308</span></a>
</span><span id="Viz-309"><a href="#Viz-309"><span class="linenos">309</span></a><span class="sd">        :param y_test_sub: Array of true target values.</span>
</span><span id="Viz-310"><a href="#Viz-310"><span class="linenos">310</span></a><span class="sd">        :param prediction: Array of predicted target values.</span>
</span><span id="Viz-311"><a href="#Viz-311"><span class="linenos">311</span></a><span class="sd">        :return: None</span>
</span><span id="Viz-312"><a href="#Viz-312"><span class="linenos">312</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz-313"><a href="#Viz-313"><span class="linenos">313</span></a>        <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test_sub</span> <span class="o">-</span> <span class="n">prediction</span>
</span><span id="Viz-314"><a href="#Viz-314"><span class="linenos">314</span></a>
</span><span id="Viz-315"><a href="#Viz-315"><span class="linenos">315</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Viz-316"><a href="#Viz-316"><span class="linenos">316</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">prediction</span><span class="p">,</span> <span class="n">residuals</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="Viz-317"><a href="#Viz-317"><span class="linenos">317</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
</span><span id="Viz-318"><a href="#Viz-318"><span class="linenos">318</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Residual Plot&#39;</span><span class="p">)</span>
</span><span id="Viz-319"><a href="#Viz-319"><span class="linenos">319</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted Values&#39;</span><span class="p">)</span>
</span><span id="Viz-320"><a href="#Viz-320"><span class="linenos">320</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Residuals&#39;</span><span class="p">)</span>
</span><span id="Viz-321"><a href="#Viz-321"><span class="linenos">321</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="Viz-322"><a href="#Viz-322"><span class="linenos">322</span></a>
</span><span id="Viz-323"><a href="#Viz-323"><span class="linenos">323</span></a>
</span><span id="Viz-324"><a href="#Viz-324"><span class="linenos">324</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_r2_poly_degree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">poly_reg_scores</span><span class="p">):</span>
</span><span id="Viz-325"><a href="#Viz-325"><span class="linenos">325</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz-326"><a href="#Viz-326"><span class="linenos">326</span></a><span class="sd">        Plot the R² scores of polynomial regression models against their polynomial degrees.</span>
</span><span id="Viz-327"><a href="#Viz-327"><span class="linenos">327</span></a><span class="sd">        This function visualizes the relationship between different polynomial degrees and their</span>
</span><span id="Viz-328"><a href="#Viz-328"><span class="linenos">328</span></a><span class="sd">        corresponding R² scores using a bar chart. Each bar represents the R² score of a specific</span>
</span><span id="Viz-329"><a href="#Viz-329"><span class="linenos">329</span></a><span class="sd">        polynomial degree, and its exact value is displayed as text above the bar.</span>
</span><span id="Viz-330"><a href="#Viz-330"><span class="linenos">330</span></a>
</span><span id="Viz-331"><a href="#Viz-331"><span class="linenos">331</span></a><span class="sd">        :param poly_reg_scores: A dictionary where keys represent the degree of the polynomial</span>
</span><span id="Viz-332"><a href="#Viz-332"><span class="linenos">332</span></a><span class="sd">            (int) and values are the corresponding R² scores (float).</span>
</span><span id="Viz-333"><a href="#Viz-333"><span class="linenos">333</span></a><span class="sd">        :return: None. The function displays the plot but does not return any value.</span>
</span><span id="Viz-334"><a href="#Viz-334"><span class="linenos">334</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz-335"><a href="#Viz-335"><span class="linenos">335</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Viz-336"><a href="#Viz-336"><span class="linenos">336</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">poly_reg_scores</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">poly_reg_scores</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="Viz-337"><a href="#Viz-337"><span class="linenos">337</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;R² Score by Polynomial Degree&#39;</span><span class="p">)</span>
</span><span id="Viz-338"><a href="#Viz-338"><span class="linenos">338</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Polynomial Degree&#39;</span><span class="p">)</span>
</span><span id="Viz-339"><a href="#Viz-339"><span class="linenos">339</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;R² Score&#39;</span><span class="p">)</span>
</span><span id="Viz-340"><a href="#Viz-340"><span class="linenos">340</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Viz-341"><a href="#Viz-341"><span class="linenos">341</span></a>
</span><span id="Viz-342"><a href="#Viz-342"><span class="linenos">342</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">poly_reg_scores</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Viz-343"><a href="#Viz-343"><span class="linenos">343</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
</span><span id="Viz-344"><a href="#Viz-344"><span class="linenos">344</span></a>
</span><span id="Viz-345"><a href="#Viz-345"><span class="linenos">345</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="Viz-346"><a href="#Viz-346"><span class="linenos">346</span></a>
</span><span id="Viz-347"><a href="#Viz-347"><span class="linenos">347</span></a>
</span><span id="Viz-348"><a href="#Viz-348"><span class="linenos">348</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clf_tree</span><span class="p">):</span>
</span><span id="Viz-349"><a href="#Viz-349"><span class="linenos">349</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz-350"><a href="#Viz-350"><span class="linenos">350</span></a><span class="sd">        Visualizes a decision tree classifier using matplotlib.</span>
</span><span id="Viz-351"><a href="#Viz-351"><span class="linenos">351</span></a>
</span><span id="Viz-352"><a href="#Viz-352"><span class="linenos">352</span></a><span class="sd">        This method takes a decision tree classifier and generates a visual</span>
</span><span id="Viz-353"><a href="#Viz-353"><span class="linenos">353</span></a><span class="sd">        representation of the tree structure using matplotlib. The tree is</span>
</span><span id="Viz-354"><a href="#Viz-354"><span class="linenos">354</span></a><span class="sd">        plotted with a filled node style.</span>
</span><span id="Viz-355"><a href="#Viz-355"><span class="linenos">355</span></a>
</span><span id="Viz-356"><a href="#Viz-356"><span class="linenos">356</span></a><span class="sd">        :param clf_tree: The decision tree classifier model to be plotted.</span>
</span><span id="Viz-357"><a href="#Viz-357"><span class="linenos">357</span></a><span class="sd">        :type clf_tree: sklearn.tree.DecisionTreeClassifier</span>
</span><span id="Viz-358"><a href="#Viz-358"><span class="linenos">358</span></a><span class="sd">        :return: None</span>
</span><span id="Viz-359"><a href="#Viz-359"><span class="linenos">359</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz-360"><a href="#Viz-360"><span class="linenos">360</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn</span><span class="w"> </span><span class="kn">import</span> <span class="n">tree</span>
</span><span id="Viz-361"><a href="#Viz-361"><span class="linenos">361</span></a>
</span><span id="Viz-362"><a href="#Viz-362"><span class="linenos">362</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
</span><span id="Viz-363"><a href="#Viz-363"><span class="linenos">363</span></a>        <span class="n">tree</span><span class="o">.</span><span class="n">plot_tree</span><span class="p">(</span><span class="n">clf_tree</span><span class="p">,</span> <span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Viz-364"><a href="#Viz-364"><span class="linenos">364</span></a>
</span><span id="Viz-365"><a href="#Viz-365"><span class="linenos">365</span></a>
</span><span id="Viz-366"><a href="#Viz-366"><span class="linenos">366</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">importance_viz_barplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">importances</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
</span><span id="Viz-367"><a href="#Viz-367"><span class="linenos">367</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz-368"><a href="#Viz-368"><span class="linenos">368</span></a><span class="sd">        Generates a bar plot visualization of feature importances for a specific model.</span>
</span><span id="Viz-369"><a href="#Viz-369"><span class="linenos">369</span></a>
</span><span id="Viz-370"><a href="#Viz-370"><span class="linenos">370</span></a><span class="sd">        This function creates a horizontal bar plot for representing feature importance</span>
</span><span id="Viz-371"><a href="#Viz-371"><span class="linenos">371</span></a><span class="sd">        data by using Matplotlib and Seaborn libraries. The plot is titled to</span>
</span><span id="Viz-372"><a href="#Viz-372"><span class="linenos">372</span></a><span class="sd">        indicate the model&#39;s name, and it highlights the most important features</span>
</span><span id="Viz-373"><a href="#Viz-373"><span class="linenos">373</span></a><span class="sd">        in descending order of their importance.</span>
</span><span id="Viz-374"><a href="#Viz-374"><span class="linenos">374</span></a>
</span><span id="Viz-375"><a href="#Viz-375"><span class="linenos">375</span></a><span class="sd">        :param importances:</span>
</span><span id="Viz-376"><a href="#Viz-376"><span class="linenos">376</span></a><span class="sd">            A pandas DataFrame containing feature importance information. It is</span>
</span><span id="Viz-377"><a href="#Viz-377"><span class="linenos">377</span></a><span class="sd">            expected to have at least two columns:</span>
</span><span id="Viz-378"><a href="#Viz-378"><span class="linenos">378</span></a><span class="sd">            - &#39;feature&#39;: Names of the features.</span>
</span><span id="Viz-379"><a href="#Viz-379"><span class="linenos">379</span></a><span class="sd">            - &#39;importance&#39;: Importance scores for the features (assumed to be numerical).</span>
</span><span id="Viz-380"><a href="#Viz-380"><span class="linenos">380</span></a><span class="sd">        :param name:</span>
</span><span id="Viz-381"><a href="#Viz-381"><span class="linenos">381</span></a><span class="sd">            A string representing the name of the model whose feature</span>
</span><span id="Viz-382"><a href="#Viz-382"><span class="linenos">382</span></a><span class="sd">            importance is visualized.</span>
</span><span id="Viz-383"><a href="#Viz-383"><span class="linenos">383</span></a><span class="sd">        :return:</span>
</span><span id="Viz-384"><a href="#Viz-384"><span class="linenos">384</span></a><span class="sd">            None</span>
</span><span id="Viz-385"><a href="#Viz-385"><span class="linenos">385</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz-386"><a href="#Viz-386"><span class="linenos">386</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Viz-387"><a href="#Viz-387"><span class="linenos">387</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">importances</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;importance&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;feature&#39;</span><span class="p">)</span>
</span><span id="Viz-388"><a href="#Viz-388"><span class="linenos">388</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Top </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">importances</span><span class="p">)</span><span class="si">}</span><span class="s1"> Most Important Features in </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> Model&#39;</span><span class="p">)</span>
</span><span id="Viz-389"><a href="#Viz-389"><span class="linenos">389</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Feature Importance&#39;</span><span class="p">)</span>
</span><span id="Viz-390"><a href="#Viz-390"><span class="linenos">390</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="Viz-391"><a href="#Viz-391"><span class="linenos">391</span></a>
</span><span id="Viz-392"><a href="#Viz-392"><span class="linenos">392</span></a>
</span><span id="Viz-393"><a href="#Viz-393"><span class="linenos">393</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">scores_comparison_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metrics</span><span class="p">):</span>
</span><span id="Viz-394"><a href="#Viz-394"><span class="linenos">394</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz-395"><a href="#Viz-395"><span class="linenos">395</span></a><span class="sd">        Generates a series of bar plots to compare a set of classification metrics across</span>
</span><span id="Viz-396"><a href="#Viz-396"><span class="linenos">396</span></a><span class="sd">        different models or configurations.</span>
</span><span id="Viz-397"><a href="#Viz-397"><span class="linenos">397</span></a>
</span><span id="Viz-398"><a href="#Viz-398"><span class="linenos">398</span></a><span class="sd">        The function takes in a dictionary containing metric scores (Precision, Recall,</span>
</span><span id="Viz-399"><a href="#Viz-399"><span class="linenos">399</span></a><span class="sd">        F1, and AUC) for each model. It creates a 2x2 grid of subplots, where each subplot</span>
</span><span id="Viz-400"><a href="#Viz-400"><span class="linenos">400</span></a><span class="sd">        represents one of the metrics, and displays a side-by-side bar plot for the models.</span>
</span><span id="Viz-401"><a href="#Viz-401"><span class="linenos">401</span></a><span class="sd">        The function ensures the y-axis for each plot ranges from 0 to 1 to enhance</span>
</span><span id="Viz-402"><a href="#Viz-402"><span class="linenos">402</span></a><span class="sd">        comparability.</span>
</span><span id="Viz-403"><a href="#Viz-403"><span class="linenos">403</span></a>
</span><span id="Viz-404"><a href="#Viz-404"><span class="linenos">404</span></a><span class="sd">        :param metrics: A dictionary where keys are model names or configurations and</span>
</span><span id="Viz-405"><a href="#Viz-405"><span class="linenos">405</span></a><span class="sd">            values are nested dictionaries containing the metrics (&#39;Precision&#39;, &#39;Recall&#39;,</span>
</span><span id="Viz-406"><a href="#Viz-406"><span class="linenos">406</span></a><span class="sd">            &#39;F1&#39;, and &#39;AUC&#39;) as keys and their corresponding scores as values.</span>
</span><span id="Viz-407"><a href="#Viz-407"><span class="linenos">407</span></a><span class="sd">            Example:</span>
</span><span id="Viz-408"><a href="#Viz-408"><span class="linenos">408</span></a><span class="sd">                {</span>
</span><span id="Viz-409"><a href="#Viz-409"><span class="linenos">409</span></a><span class="sd">                    &quot;Model_1&quot;: {&quot;Precision&quot;: 0.85, &quot;Recall&quot;: 0.80, &quot;F1&quot;: 0.82, &quot;AUC&quot;: 0.90},</span>
</span><span id="Viz-410"><a href="#Viz-410"><span class="linenos">410</span></a><span class="sd">                    &quot;Model_2&quot;: {&quot;Precision&quot;: 0.83, &quot;Recall&quot;: 0.78, &quot;F1&quot;: 0.80, &quot;AUC&quot;: 0.89}</span>
</span><span id="Viz-411"><a href="#Viz-411"><span class="linenos">411</span></a><span class="sd">                }</span>
</span><span id="Viz-412"><a href="#Viz-412"><span class="linenos">412</span></a>
</span><span id="Viz-413"><a href="#Viz-413"><span class="linenos">413</span></a><span class="sd">        :return: None</span>
</span><span id="Viz-414"><a href="#Viz-414"><span class="linenos">414</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz-415"><a href="#Viz-415"><span class="linenos">415</span></a>        <span class="c1"># Create comparison plots</span>
</span><span id="Viz-416"><a href="#Viz-416"><span class="linenos">416</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">),</span> <span class="p">(</span><span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">))</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="Viz-417"><a href="#Viz-417"><span class="linenos">417</span></a>
</span><span id="Viz-418"><a href="#Viz-418"><span class="linenos">418</span></a>        <span class="n">metrics_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="Viz-419"><a href="#Viz-419"><span class="linenos">419</span></a>
</span><span id="Viz-420"><a href="#Viz-420"><span class="linenos">420</span></a>        <span class="c1"># Precision plot</span>
</span><span id="Viz-421"><a href="#Viz-421"><span class="linenos">421</span></a>        <span class="n">metrics_df</span><span class="p">[</span><span class="s1">&#39;Precision&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>
</span><span id="Viz-422"><a href="#Viz-422"><span class="linenos">422</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Precision Comparison&#39;</span><span class="p">)</span>
</span><span id="Viz-423"><a href="#Viz-423"><span class="linenos">423</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Viz-424"><a href="#Viz-424"><span class="linenos">424</span></a>
</span><span id="Viz-425"><a href="#Viz-425"><span class="linenos">425</span></a>        <span class="c1"># Recall plot</span>
</span><span id="Viz-426"><a href="#Viz-426"><span class="linenos">426</span></a>        <span class="n">metrics_df</span><span class="p">[</span><span class="s1">&#39;Recall&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgreen&#39;</span><span class="p">)</span>
</span><span id="Viz-427"><a href="#Viz-427"><span class="linenos">427</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Recall Comparison&#39;</span><span class="p">)</span>
</span><span id="Viz-428"><a href="#Viz-428"><span class="linenos">428</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Viz-429"><a href="#Viz-429"><span class="linenos">429</span></a>
</span><span id="Viz-430"><a href="#Viz-430"><span class="linenos">430</span></a>        <span class="c1"># F1 plot</span>
</span><span id="Viz-431"><a href="#Viz-431"><span class="linenos">431</span></a>        <span class="n">metrics_df</span><span class="p">[</span><span class="s1">&#39;F1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">)</span>
</span><span id="Viz-432"><a href="#Viz-432"><span class="linenos">432</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;F1 Score Comparison&#39;</span><span class="p">)</span>
</span><span id="Viz-433"><a href="#Viz-433"><span class="linenos">433</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Viz-434"><a href="#Viz-434"><span class="linenos">434</span></a>
</span><span id="Viz-435"><a href="#Viz-435"><span class="linenos">435</span></a>        <span class="c1"># AUC plot</span>
</span><span id="Viz-436"><a href="#Viz-436"><span class="linenos">436</span></a>        <span class="n">metrics_df</span><span class="p">[</span><span class="s1">&#39;AUC&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;plum&#39;</span><span class="p">)</span>
</span><span id="Viz-437"><a href="#Viz-437"><span class="linenos">437</span></a>        <span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;AUC Score Comparison&#39;</span><span class="p">)</span>
</span><span id="Viz-438"><a href="#Viz-438"><span class="linenos">438</span></a>        <span class="n">ax4</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Viz-439"><a href="#Viz-439"><span class="linenos">439</span></a>
</span><span id="Viz-440"><a href="#Viz-440"><span class="linenos">440</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="Viz-441"><a href="#Viz-441"><span class="linenos">441</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="Viz-442"><a href="#Viz-442"><span class="linenos">442</span></a>
</span><span id="Viz-443"><a href="#Viz-443"><span class="linenos">443</span></a>
</span><span id="Viz-444"><a href="#Viz-444"><span class="linenos">444</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cross_validation_comparison_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">models</span><span class="p">):</span>
</span><span id="Viz-445"><a href="#Viz-445"><span class="linenos">445</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz-446"><a href="#Viz-446"><span class="linenos">446</span></a><span class="sd">        Generates a bar plot comparing the mean and standard deviation of cross-validation</span>
</span><span id="Viz-447"><a href="#Viz-447"><span class="linenos">447</span></a><span class="sd">        scores for multiple models. The input `models` should be a dictionary where keys</span>
</span><span id="Viz-448"><a href="#Viz-448"><span class="linenos">448</span></a><span class="sd">        are model names and values are lists of cross-validation scores.</span>
</span><span id="Viz-449"><a href="#Viz-449"><span class="linenos">449</span></a>
</span><span id="Viz-450"><a href="#Viz-450"><span class="linenos">450</span></a><span class="sd">        The function computes the mean and standard deviation for each model, and visualizes</span>
</span><span id="Viz-451"><a href="#Viz-451"><span class="linenos">451</span></a><span class="sd">        them using a bar plot with error bars. Each bar represents a model&#39;s average score</span>
</span><span id="Viz-452"><a href="#Viz-452"><span class="linenos">452</span></a><span class="sd">        with corresponding error bars indicating its standard deviation.</span>
</span><span id="Viz-453"><a href="#Viz-453"><span class="linenos">453</span></a>
</span><span id="Viz-454"><a href="#Viz-454"><span class="linenos">454</span></a><span class="sd">        :param models: A dictionary where keys are model names (str) and values are lists</span>
</span><span id="Viz-455"><a href="#Viz-455"><span class="linenos">455</span></a><span class="sd">            of cross-validation scores (list of floats).</span>
</span><span id="Viz-456"><a href="#Viz-456"><span class="linenos">456</span></a><span class="sd">        :type models: dict</span>
</span><span id="Viz-457"><a href="#Viz-457"><span class="linenos">457</span></a><span class="sd">        :return: None</span>
</span><span id="Viz-458"><a href="#Viz-458"><span class="linenos">458</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz-459"><a href="#Viz-459"><span class="linenos">459</span></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="Viz-460"><a href="#Viz-460"><span class="linenos">460</span></a>
</span><span id="Viz-461"><a href="#Viz-461"><span class="linenos">461</span></a>        <span class="n">means</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">scores</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="Viz-462"><a href="#Viz-462"><span class="linenos">462</span></a>        <span class="n">stds</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">scores</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="Viz-463"><a href="#Viz-463"><span class="linenos">463</span></a>
</span><span id="Viz-464"><a href="#Viz-464"><span class="linenos">464</span></a>        <span class="c1"># Plot comparison</span>
</span><span id="Viz-465"><a href="#Viz-465"><span class="linenos">465</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Viz-466"><a href="#Viz-466"><span class="linenos">466</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">means</span><span class="p">)),</span> <span class="n">means</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">yerr</span><span class="o">=</span><span class="n">stds</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
</span><span id="Viz-467"><a href="#Viz-467"><span class="linenos">467</span></a>                <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="s1">&#39;lightgreen&#39;</span><span class="p">,</span> <span class="s1">&#39;salmon&#39;</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">])</span>
</span><span id="Viz-468"><a href="#Viz-468"><span class="linenos">468</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">means</span><span class="p">)),</span> <span class="n">means</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
</span><span id="Viz-469"><a href="#Viz-469"><span class="linenos">469</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Cross-Validation Scores Comparison&#39;</span><span class="p">)</span>
</span><span id="Viz-470"><a href="#Viz-470"><span class="linenos">470</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Mean CV Score&#39;</span><span class="p">)</span>
</span><span id="Viz-471"><a href="#Viz-471"><span class="linenos">471</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Viz-472"><a href="#Viz-472"><span class="linenos">472</span></a>
</span><span id="Viz-473"><a href="#Viz-473"><span class="linenos">473</span></a>        <span class="c1"># Add value labels</span>
</span><span id="Viz-474"><a href="#Viz-474"><span class="linenos">474</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">means</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="Viz-475"><a href="#Viz-475"><span class="linenos">475</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="o">+</span> <span class="n">stds</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">means</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">i</span><span class="p">]],</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
</span><span id="Viz-476"><a href="#Viz-476"><span class="linenos">476</span></a>                     <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
</span><span id="Viz-477"><a href="#Viz-477"><span class="linenos">477</span></a>
</span><span id="Viz-478"><a href="#Viz-478"><span class="linenos">478</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="Viz-479"><a href="#Viz-479"><span class="linenos">479</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="Viz-480"><a href="#Viz-480"><span class="linenos">480</span></a>
</span><span id="Viz-481"><a href="#Viz-481"><span class="linenos">481</span></a>
</span><span id="Viz-482"><a href="#Viz-482"><span class="linenos">482</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">grid_search_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metrics_comparison</span><span class="p">,</span> <span class="n">old_model</span><span class="p">,</span> <span class="n">old_model_class</span><span class="p">,</span> <span class="n">new_model</span><span class="p">,</span> <span class="n">new_model_class</span><span class="p">):</span>
</span><span id="Viz-483"><a href="#Viz-483"><span class="linenos">483</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz-484"><a href="#Viz-484"><span class="linenos">484</span></a><span class="sd">        Plots the comparison of multiple metrics (Accuracy, Precision, Recall, F1) between</span>
</span><span id="Viz-485"><a href="#Viz-485"><span class="linenos">485</span></a><span class="sd">        two models, and their respective ROC curves. The function creates a visual comparison</span>
</span><span id="Viz-486"><a href="#Viz-486"><span class="linenos">486</span></a><span class="sd">        of an original model and a tuned model, with subplots for each metric and a separate</span>
</span><span id="Viz-487"><a href="#Viz-487"><span class="linenos">487</span></a><span class="sd">        plot for the ROC curves. Metrics are displayed as bar plots, and ROC/AUC metrics</span>
</span><span id="Viz-488"><a href="#Viz-488"><span class="linenos">488</span></a><span class="sd">        are presented as line graphs.</span>
</span><span id="Viz-489"><a href="#Viz-489"><span class="linenos">489</span></a>
</span><span id="Viz-490"><a href="#Viz-490"><span class="linenos">490</span></a><span class="sd">        :param metrics_comparison: A dictionary containing metric values (e.g. Accuracy,</span>
</span><span id="Viz-491"><a href="#Viz-491"><span class="linenos">491</span></a><span class="sd">            Precision, Recall, F1) for the models being compared. The keys should include &#39;Original&#39;</span>
</span><span id="Viz-492"><a href="#Viz-492"><span class="linenos">492</span></a><span class="sd">            and &#39;Tuned&#39;, with associated metrics as subkeys.</span>
</span><span id="Viz-493"><a href="#Viz-493"><span class="linenos">493</span></a><span class="sd">        :type metrics_comparison: dict</span>
</span><span id="Viz-494"><a href="#Viz-494"><span class="linenos">494</span></a><span class="sd">        :param old_model: The original, &#39;untuned&#39; machine learning model. Must be a model</span>
</span><span id="Viz-495"><a href="#Viz-495"><span class="linenos">495</span></a><span class="sd">            object with a `predict_proba` method.</span>
</span><span id="Viz-496"><a href="#Viz-496"><span class="linenos">496</span></a><span class="sd">        :param old_model_class: An object encapsulating the test data (`X_test`, `y_test`).</span>
</span><span id="Viz-497"><a href="#Viz-497"><span class="linenos">497</span></a><span class="sd">            Must provide a `y_test` attribute and `X_test` attribute for predictions.</span>
</span><span id="Viz-498"><a href="#Viz-498"><span class="linenos">498</span></a><span class="sd">        :type old_model_class: object</span>
</span><span id="Viz-499"><a href="#Viz-499"><span class="linenos">499</span></a><span class="sd">        :param new_model: The optimized or tuned machine learning model. Must be a model</span>
</span><span id="Viz-500"><a href="#Viz-500"><span class="linenos">500</span></a><span class="sd">            object with a `predict_proba` method.</span>
</span><span id="Viz-501"><a href="#Viz-501"><span class="linenos">501</span></a><span class="sd">        :param new_model_class: An object encapsulating test data (`X_test`, `y_test`)</span>
</span><span id="Viz-502"><a href="#Viz-502"><span class="linenos">502</span></a><span class="sd">            for the tuned model. Must provide a `y_test` attribute and `X_test` attribute</span>
</span><span id="Viz-503"><a href="#Viz-503"><span class="linenos">503</span></a><span class="sd">            for predictions.</span>
</span><span id="Viz-504"><a href="#Viz-504"><span class="linenos">504</span></a><span class="sd">        :type new_model_class: object</span>
</span><span id="Viz-505"><a href="#Viz-505"><span class="linenos">505</span></a>
</span><span id="Viz-506"><a href="#Viz-506"><span class="linenos">506</span></a><span class="sd">        :return: None</span>
</span><span id="Viz-507"><a href="#Viz-507"><span class="linenos">507</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz-508"><a href="#Viz-508"><span class="linenos">508</span></a>        <span class="c1"># Create subplots for each metric</span>
</span><span id="Viz-509"><a href="#Viz-509"><span class="linenos">509</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">),</span> <span class="p">(</span><span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">))</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="Viz-510"><a href="#Viz-510"><span class="linenos">510</span></a>
</span><span id="Viz-511"><a href="#Viz-511"><span class="linenos">511</span></a>        <span class="c1"># Plot each metric</span>
</span><span id="Viz-512"><a href="#Viz-512"><span class="linenos">512</span></a>        <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;Precision&#39;</span><span class="p">,</span> <span class="s1">&#39;Recall&#39;</span><span class="p">,</span> <span class="s1">&#39;F1&#39;</span><span class="p">]</span>
</span><span id="Viz-513"><a href="#Viz-513"><span class="linenos">513</span></a>        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="s1">&#39;lightgreen&#39;</span><span class="p">]</span>
</span><span id="Viz-514"><a href="#Viz-514"><span class="linenos">514</span></a>
</span><span id="Viz-515"><a href="#Viz-515"><span class="linenos">515</span></a>        <span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">metrics</span><span class="p">,</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">]):</span>
</span><span id="Viz-516"><a href="#Viz-516"><span class="linenos">516</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">metrics_comparison</span><span class="p">[</span><span class="s1">&#39;Original&#39;</span><span class="p">][</span><span class="n">metric</span><span class="p">],</span>
</span><span id="Viz-517"><a href="#Viz-517"><span class="linenos">517</span></a>                      <span class="n">metrics_comparison</span><span class="p">[</span><span class="s1">&#39;Tuned&#39;</span><span class="p">][</span><span class="n">metric</span><span class="p">]]</span>
</span><span id="Viz-518"><a href="#Viz-518"><span class="linenos">518</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="s1">&#39;Original&#39;</span><span class="p">,</span> <span class="s1">&#39;Tuned&#39;</span><span class="p">],</span> <span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
</span><span id="Viz-519"><a href="#Viz-519"><span class="linenos">519</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s1"> Comparison&#39;</span><span class="p">)</span>
</span><span id="Viz-520"><a href="#Viz-520"><span class="linenos">520</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Viz-521"><a href="#Viz-521"><span class="linenos">521</span></a>
</span><span id="Viz-522"><a href="#Viz-522"><span class="linenos">522</span></a>            <span class="c1"># Add value labels</span>
</span><span id="Viz-523"><a href="#Viz-523"><span class="linenos">523</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
</span><span id="Viz-524"><a href="#Viz-524"><span class="linenos">524</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
</span><span id="Viz-525"><a href="#Viz-525"><span class="linenos">525</span></a>
</span><span id="Viz-526"><a href="#Viz-526"><span class="linenos">526</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="Viz-527"><a href="#Viz-527"><span class="linenos">527</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="Viz-528"><a href="#Viz-528"><span class="linenos">528</span></a>
</span><span id="Viz-529"><a href="#Viz-529"><span class="linenos">529</span></a>        <span class="c1"># Plot ROC curves for both models</span>
</span><span id="Viz-530"><a href="#Viz-530"><span class="linenos">530</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Viz-531"><a href="#Viz-531"><span class="linenos">531</span></a>
</span><span id="Viz-532"><a href="#Viz-532"><span class="linenos">532</span></a>        <span class="c1"># Original model ROC curve</span>
</span><span id="Viz-533"><a href="#Viz-533"><span class="linenos">533</span></a>        <span class="n">fpr_orig</span><span class="p">,</span> <span class="n">tpr_orig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">old_model_class</span><span class="o">.</span><span class="n">y_test</span><span class="p">,</span> <span class="n">old_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">old_model_class</span><span class="o">.</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="Viz-534"><a href="#Viz-534"><span class="linenos">534</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_orig</span><span class="p">,</span> <span class="n">tpr_orig</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span>
</span><span id="Viz-535"><a href="#Viz-535"><span class="linenos">535</span></a>                 <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Original (AUC = </span><span class="si">{</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">old_model_class</span><span class="o">.</span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">old_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">old_model_class</span><span class="o">.</span><span class="n">X_test</span><span class="p">)[:,</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</span><span id="Viz-536"><a href="#Viz-536"><span class="linenos">536</span></a>
</span><span id="Viz-537"><a href="#Viz-537"><span class="linenos">537</span></a>        <span class="c1"># Tuned model ROC curve</span>
</span><span id="Viz-538"><a href="#Viz-538"><span class="linenos">538</span></a>        <span class="n">fpr_tuned</span><span class="p">,</span> <span class="n">tpr_tuned</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">new_model_class</span><span class="o">.</span><span class="n">y_test</span><span class="p">,</span> <span class="n">new_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">new_model_class</span><span class="o">.</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="Viz-539"><a href="#Viz-539"><span class="linenos">539</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_tuned</span><span class="p">,</span> <span class="n">tpr_tuned</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgreen&#39;</span><span class="p">,</span>
</span><span id="Viz-540"><a href="#Viz-540"><span class="linenos">540</span></a>                 <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Tuned (AUC = </span><span class="si">{</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">new_model_class</span><span class="o">.</span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">new_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">new_model_class</span><span class="o">.</span><span class="n">X_test</span><span class="p">)[:,</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</span><span id="Viz-541"><a href="#Viz-541"><span class="linenos">541</span></a>
</span><span id="Viz-542"><a href="#Viz-542"><span class="linenos">542</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
</span><span id="Viz-543"><a href="#Viz-543"><span class="linenos">543</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
</span><span id="Viz-544"><a href="#Viz-544"><span class="linenos">544</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
</span><span id="Viz-545"><a href="#Viz-545"><span class="linenos">545</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;False Positive Rate&#39;</span><span class="p">)</span>
</span><span id="Viz-546"><a href="#Viz-546"><span class="linenos">546</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;True Positive Rate&#39;</span><span class="p">)</span>
</span><span id="Viz-547"><a href="#Viz-547"><span class="linenos">547</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ROC Curves Comparison&#39;</span><span class="p">)</span>
</span><span id="Viz-548"><a href="#Viz-548"><span class="linenos">548</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
</span><span id="Viz-549"><a href="#Viz-549"><span class="linenos">549</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="Viz-550"><a href="#Viz-550"><span class="linenos">550</span></a>
</span><span id="Viz-551"><a href="#Viz-551"><span class="linenos">551</span></a>
</span><span id="Viz-552"><a href="#Viz-552"><span class="linenos">552</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cv_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cv_results</span><span class="p">,</span> <span class="n">models</span><span class="p">):</span>
</span><span id="Viz-553"><a href="#Viz-553"><span class="linenos">553</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz-554"><a href="#Viz-554"><span class="linenos">554</span></a><span class="sd">        Plots cross-validation results for multiple models.</span>
</span><span id="Viz-555"><a href="#Viz-555"><span class="linenos">555</span></a>
</span><span id="Viz-556"><a href="#Viz-556"><span class="linenos">556</span></a><span class="sd">        This function generates bar plots for evaluation metrics such as accuracy,</span>
</span><span id="Viz-557"><a href="#Viz-557"><span class="linenos">557</span></a><span class="sd">        precision, recall, and F1-score. Each plot displays the mean values along</span>
</span><span id="Viz-558"><a href="#Viz-558"><span class="linenos">558</span></a><span class="sd">        with error bars representing the standard deviation for the specified metrics.</span>
</span><span id="Viz-559"><a href="#Viz-559"><span class="linenos">559</span></a><span class="sd">        The results are visualized using a grid layout.</span>
</span><span id="Viz-560"><a href="#Viz-560"><span class="linenos">560</span></a>
</span><span id="Viz-561"><a href="#Viz-561"><span class="linenos">561</span></a><span class="sd">        :param cv_results: A dictionary containing cross-validation results for</span>
</span><span id="Viz-562"><a href="#Viz-562"><span class="linenos">562</span></a><span class="sd">            each model. The format should be:</span>
</span><span id="Viz-563"><a href="#Viz-563"><span class="linenos">563</span></a><span class="sd">            {</span>
</span><span id="Viz-564"><a href="#Viz-564"><span class="linenos">564</span></a><span class="sd">                &#39;model_name&#39;: {</span>
</span><span id="Viz-565"><a href="#Viz-565"><span class="linenos">565</span></a><span class="sd">                    &#39;accuracy&#39;: {&#39;mean&#39;: float, &#39;std&#39;: float},</span>
</span><span id="Viz-566"><a href="#Viz-566"><span class="linenos">566</span></a><span class="sd">                    &#39;precision&#39;: {&#39;mean&#39;: float, &#39;std&#39;: float},</span>
</span><span id="Viz-567"><a href="#Viz-567"><span class="linenos">567</span></a><span class="sd">                    &#39;recall&#39;: {&#39;mean&#39;: float, &#39;std&#39;: float},</span>
</span><span id="Viz-568"><a href="#Viz-568"><span class="linenos">568</span></a><span class="sd">                    &#39;f1&#39;: {&#39;mean&#39;: float, &#39;std&#39;: float}</span>
</span><span id="Viz-569"><a href="#Viz-569"><span class="linenos">569</span></a><span class="sd">                },</span>
</span><span id="Viz-570"><a href="#Viz-570"><span class="linenos">570</span></a><span class="sd">                ...</span>
</span><span id="Viz-571"><a href="#Viz-571"><span class="linenos">571</span></a><span class="sd">            }</span>
</span><span id="Viz-572"><a href="#Viz-572"><span class="linenos">572</span></a><span class="sd">        :param dict models: A dictionary containing model names as keys and their</span>
</span><span id="Viz-573"><a href="#Viz-573"><span class="linenos">573</span></a><span class="sd">            corresponding estimators or classifiers as values. The keys are used in the</span>
</span><span id="Viz-574"><a href="#Viz-574"><span class="linenos">574</span></a><span class="sd">            plot as labels.</span>
</span><span id="Viz-575"><a href="#Viz-575"><span class="linenos">575</span></a><span class="sd">        :return: None</span>
</span><span id="Viz-576"><a href="#Viz-576"><span class="linenos">576</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz-577"><a href="#Viz-577"><span class="linenos">577</span></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="Viz-578"><a href="#Viz-578"><span class="linenos">578</span></a>
</span><span id="Viz-579"><a href="#Viz-579"><span class="linenos">579</span></a>        <span class="c1"># Plot results</span>
</span><span id="Viz-580"><a href="#Viz-580"><span class="linenos">580</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">),</span> <span class="p">(</span><span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">))</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="Viz-581"><a href="#Viz-581"><span class="linenos">581</span></a>
</span><span id="Viz-582"><a href="#Viz-582"><span class="linenos">582</span></a>        <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="s1">&#39;recall&#39;</span><span class="p">,</span> <span class="s1">&#39;f1&#39;</span><span class="p">]</span>
</span><span id="Viz-583"><a href="#Viz-583"><span class="linenos">583</span></a>        <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">]</span>
</span><span id="Viz-584"><a href="#Viz-584"><span class="linenos">584</span></a>        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="s1">&#39;lightgreen&#39;</span><span class="p">,</span> <span class="s1">&#39;salmon&#39;</span><span class="p">]</span>
</span><span id="Viz-585"><a href="#Viz-585"><span class="linenos">585</span></a>
</span><span id="Viz-586"><a href="#Viz-586"><span class="linenos">586</span></a>        <span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">metrics</span><span class="p">,</span> <span class="n">axes</span><span class="p">):</span>
</span><span id="Viz-587"><a href="#Viz-587"><span class="linenos">587</span></a>            <span class="n">means</span> <span class="o">=</span> <span class="p">[</span><span class="n">cv_results</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">metric</span><span class="p">][</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
</span><span id="Viz-588"><a href="#Viz-588"><span class="linenos">588</span></a>            <span class="n">stds</span> <span class="o">=</span> <span class="p">[</span><span class="n">cv_results</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">metric</span><span class="p">][</span><span class="s1">&#39;std&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
</span><span id="Viz-589"><a href="#Viz-589"><span class="linenos">589</span></a>
</span><span id="Viz-590"><a href="#Viz-590"><span class="linenos">590</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">))</span>
</span><span id="Viz-591"><a href="#Viz-591"><span class="linenos">591</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">means</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">stds</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
</span><span id="Viz-592"><a href="#Viz-592"><span class="linenos">592</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Viz-593"><a href="#Viz-593"><span class="linenos">593</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
</span><span id="Viz-594"><a href="#Viz-594"><span class="linenos">594</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">metric</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s1"> Score&#39;</span><span class="p">)</span>
</span><span id="Viz-595"><a href="#Viz-595"><span class="linenos">595</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Viz-596"><a href="#Viz-596"><span class="linenos">596</span></a>
</span><span id="Viz-597"><a href="#Viz-597"><span class="linenos">597</span></a>            <span class="c1"># Add value labels</span>
</span><span id="Viz-598"><a href="#Viz-598"><span class="linenos">598</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">means</span><span class="p">):</span>
</span><span id="Viz-599"><a href="#Viz-599"><span class="linenos">599</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="o">+</span> <span class="n">stds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
</span><span id="Viz-600"><a href="#Viz-600"><span class="linenos">600</span></a>
</span><span id="Viz-601"><a href="#Viz-601"><span class="linenos">601</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="Viz-602"><a href="#Viz-602"><span class="linenos">602</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></pre></div>


    

                            <div id="Viz.plot_corr_with_target" class="classattr">
                                        <input id="Viz.plot_corr_with_target-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_corr_with_target</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">df</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>, </span><span class="param"><span class="n">target</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Viz.plot_corr_with_target-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Viz.plot_corr_with_target"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Viz.plot_corr_with_target-13"><a href="#Viz.plot_corr_with_target-13"><span class="linenos">13</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_corr_with_target</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Viz.plot_corr_with_target-14"><a href="#Viz.plot_corr_with_target-14"><span class="linenos">14</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz.plot_corr_with_target-15"><a href="#Viz.plot_corr_with_target-15"><span class="linenos">15</span></a><span class="sd">        Plots the correlation of the given target variable with all other features in the</span>
</span><span id="Viz.plot_corr_with_target-16"><a href="#Viz.plot_corr_with_target-16"><span class="linenos">16</span></a><span class="sd">        DataFrame. The function calculates the Pearson correlation of the target variable</span>
</span><span id="Viz.plot_corr_with_target-17"><a href="#Viz.plot_corr_with_target-17"><span class="linenos">17</span></a><span class="sd">        with other features, sorts them in descending order, and visualizes them using</span>
</span><span id="Viz.plot_corr_with_target-18"><a href="#Viz.plot_corr_with_target-18"><span class="linenos">18</span></a><span class="sd">        a horizontal bar plot.</span>
</span><span id="Viz.plot_corr_with_target-19"><a href="#Viz.plot_corr_with_target-19"><span class="linenos">19</span></a>
</span><span id="Viz.plot_corr_with_target-20"><a href="#Viz.plot_corr_with_target-20"><span class="linenos">20</span></a><span class="sd">        :param df: A pandas DataFrame containing the features and the target variable.</span>
</span><span id="Viz.plot_corr_with_target-21"><a href="#Viz.plot_corr_with_target-21"><span class="linenos">21</span></a><span class="sd">        :type df: pd.DataFrame</span>
</span><span id="Viz.plot_corr_with_target-22"><a href="#Viz.plot_corr_with_target-22"><span class="linenos">22</span></a><span class="sd">        :param target: The column name of the target variable for which correlation</span>
</span><span id="Viz.plot_corr_with_target-23"><a href="#Viz.plot_corr_with_target-23"><span class="linenos">23</span></a><span class="sd">            is to be visualized.</span>
</span><span id="Viz.plot_corr_with_target-24"><a href="#Viz.plot_corr_with_target-24"><span class="linenos">24</span></a><span class="sd">        :type target: str</span>
</span><span id="Viz.plot_corr_with_target-25"><a href="#Viz.plot_corr_with_target-25"><span class="linenos">25</span></a><span class="sd">        :return: Does not return a value. Saves the plot as a PNG file named</span>
</span><span id="Viz.plot_corr_with_target-26"><a href="#Viz.plot_corr_with_target-26"><span class="linenos">26</span></a><span class="sd">            &#39;corr_with_&lt;target&gt;.png&#39; in the &#39;../reports/figures/&#39; directory.</span>
</span><span id="Viz.plot_corr_with_target-27"><a href="#Viz.plot_corr_with_target-27"><span class="linenos">27</span></a><span class="sd">        :rtype: None</span>
</span><span id="Viz.plot_corr_with_target-28"><a href="#Viz.plot_corr_with_target-28"><span class="linenos">28</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz.plot_corr_with_target-29"><a href="#Viz.plot_corr_with_target-29"><span class="linenos">29</span></a>        <span class="n">corr</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">()[</span><span class="n">target</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Viz.plot_corr_with_target-30"><a href="#Viz.plot_corr_with_target-30"><span class="linenos">30</span></a>
</span><span id="Viz.plot_corr_with_target-31"><a href="#Viz.plot_corr_with_target-31"><span class="linenos">31</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</span><span id="Viz.plot_corr_with_target-32"><a href="#Viz.plot_corr_with_target-32"><span class="linenos">32</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">corr</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">corr</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Set2&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="n">corr</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</span><span id="Viz.plot_corr_with_target-33"><a href="#Viz.plot_corr_with_target-33"><span class="linenos">33</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Correlation with Churn&#39;</span><span class="p">)</span>
</span><span id="Viz.plot_corr_with_target-34"><a href="#Viz.plot_corr_with_target-34"><span class="linenos">34</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Pearson correlation&#39;</span><span class="p">)</span>
</span><span id="Viz.plot_corr_with_target-35"><a href="#Viz.plot_corr_with_target-35"><span class="linenos">35</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Feature&#39;</span><span class="p">)</span>
</span><span id="Viz.plot_corr_with_target-36"><a href="#Viz.plot_corr_with_target-36"><span class="linenos">36</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</span><span id="Viz.plot_corr_with_target-37"><a href="#Viz.plot_corr_with_target-37"><span class="linenos">37</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;../reports/figures/corr_with_</span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plots the correlation of the given target variable with all other features in the
DataFrame. The function calculates the Pearson correlation of the target variable
with other features, sorts them in descending order, and visualizes them using
a horizontal bar plot.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>df</strong>:  A pandas DataFrame containing the features and the target variable.</li>
<li><strong>target</strong>:  The column name of the target variable for which correlation
is to be visualized.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Does not return a value. Saves the plot as a PNG file named
      'corr_with_<target>.png' in the '../reports/figures/' directory.</p>
</blockquote>
</div>


                            </div>
                            <div id="Viz.simple_comparison_bar_plot" class="classattr">
                                        <input id="Viz.simple_comparison_bar_plot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">simple_comparison_bar_plot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">df</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>, </span><span class="param"><span class="n">target</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Viz.simple_comparison_bar_plot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Viz.simple_comparison_bar_plot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Viz.simple_comparison_bar_plot-40"><a href="#Viz.simple_comparison_bar_plot-40"><span class="linenos">40</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">simple_comparison_bar_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="p">:</span>
</span><span id="Viz.simple_comparison_bar_plot-41"><a href="#Viz.simple_comparison_bar_plot-41"><span class="linenos">41</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz.simple_comparison_bar_plot-42"><a href="#Viz.simple_comparison_bar_plot-42"><span class="linenos">42</span></a><span class="sd">        Create a bar plot to visualize the percentage distribution of a target column in</span>
</span><span id="Viz.simple_comparison_bar_plot-43"><a href="#Viz.simple_comparison_bar_plot-43"><span class="linenos">43</span></a><span class="sd">        a given DataFrame. The function calculates the percentage for each unique value</span>
</span><span id="Viz.simple_comparison_bar_plot-44"><a href="#Viz.simple_comparison_bar_plot-44"><span class="linenos">44</span></a><span class="sd">        in the column and displays them as a bar chart with percentage labels.</span>
</span><span id="Viz.simple_comparison_bar_plot-45"><a href="#Viz.simple_comparison_bar_plot-45"><span class="linenos">45</span></a>
</span><span id="Viz.simple_comparison_bar_plot-46"><a href="#Viz.simple_comparison_bar_plot-46"><span class="linenos">46</span></a><span class="sd">        :param df: Input DataFrame containing the dataset.</span>
</span><span id="Viz.simple_comparison_bar_plot-47"><a href="#Viz.simple_comparison_bar_plot-47"><span class="linenos">47</span></a><span class="sd">        :type df: pd.DataFrame</span>
</span><span id="Viz.simple_comparison_bar_plot-48"><a href="#Viz.simple_comparison_bar_plot-48"><span class="linenos">48</span></a><span class="sd">        :param target: Column name in the DataFrame for which the distribution is visualized.</span>
</span><span id="Viz.simple_comparison_bar_plot-49"><a href="#Viz.simple_comparison_bar_plot-49"><span class="linenos">49</span></a><span class="sd">        :type target: str</span>
</span><span id="Viz.simple_comparison_bar_plot-50"><a href="#Viz.simple_comparison_bar_plot-50"><span class="linenos">50</span></a><span class="sd">        :return: None</span>
</span><span id="Viz.simple_comparison_bar_plot-51"><a href="#Viz.simple_comparison_bar_plot-51"><span class="linenos">51</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz.simple_comparison_bar_plot-52"><a href="#Viz.simple_comparison_bar_plot-52"><span class="linenos">52</span></a>        <span class="c1"># Calculate percentages</span>
</span><span id="Viz.simple_comparison_bar_plot-53"><a href="#Viz.simple_comparison_bar_plot-53"><span class="linenos">53</span></a>        <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target</span><span class="p">])</span>
</span><span id="Viz.simple_comparison_bar_plot-54"><a href="#Viz.simple_comparison_bar_plot-54"><span class="linenos">54</span></a>        <span class="n">percentages</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span> <span class="o">/</span> <span class="n">total</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="Viz.simple_comparison_bar_plot-55"><a href="#Viz.simple_comparison_bar_plot-55"><span class="linenos">55</span></a>
</span><span id="Viz.simple_comparison_bar_plot-56"><a href="#Viz.simple_comparison_bar_plot-56"><span class="linenos">56</span></a>        <span class="c1"># Create a bar plot with percentages</span>
</span><span id="Viz.simple_comparison_bar_plot-57"><a href="#Viz.simple_comparison_bar_plot-57"><span class="linenos">57</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">percentages</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s1"> Distribution&#39;</span><span class="p">)</span>
</span><span id="Viz.simple_comparison_bar_plot-58"><a href="#Viz.simple_comparison_bar_plot-58"><span class="linenos">58</span></a>
</span><span id="Viz.simple_comparison_bar_plot-59"><a href="#Viz.simple_comparison_bar_plot-59"><span class="linenos">59</span></a>        <span class="c1"># Add percentage labels on top of each bar</span>
</span><span id="Viz.simple_comparison_bar_plot-60"><a href="#Viz.simple_comparison_bar_plot-60"><span class="linenos">60</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">percentages</span><span class="p">):</span>
</span><span id="Viz.simple_comparison_bar_plot-61"><a href="#Viz.simple_comparison_bar_plot-61"><span class="linenos">61</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
</span><span id="Viz.simple_comparison_bar_plot-62"><a href="#Viz.simple_comparison_bar_plot-62"><span class="linenos">62</span></a>
</span><span id="Viz.simple_comparison_bar_plot-63"><a href="#Viz.simple_comparison_bar_plot-63"><span class="linenos">63</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Percentage&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a bar plot to visualize the percentage distribution of a target column in
a given DataFrame. The function calculates the percentage for each unique value
in the column and displays them as a bar chart with percentage labels.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>df</strong>:  Input DataFrame containing the dataset.</li>
<li><strong>target</strong>:  Column name in the DataFrame for which the distribution is visualized.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="Viz.superposed_bar_plot" class="classattr">
                                        <input id="Viz.superposed_bar_plot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">superposed_bar_plot</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">df</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>,</span><span class="param">	<span class="n">target_1</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">target_2</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Viz.superposed_bar_plot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Viz.superposed_bar_plot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Viz.superposed_bar_plot-66"><a href="#Viz.superposed_bar_plot-66"><span class="linenos">66</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">superposed_bar_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">target_1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target_2</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Viz.superposed_bar_plot-67"><a href="#Viz.superposed_bar_plot-67"><span class="linenos">67</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz.superposed_bar_plot-68"><a href="#Viz.superposed_bar_plot-68"><span class="linenos">68</span></a><span class="sd">        Generates a superposed bar plot to visualize the distribution of a specified target</span>
</span><span id="Viz.superposed_bar_plot-69"><a href="#Viz.superposed_bar_plot-69"><span class="linenos">69</span></a><span class="sd">        variable for two subsets of data, split based on another categorical column.</span>
</span><span id="Viz.superposed_bar_plot-70"><a href="#Viz.superposed_bar_plot-70"><span class="linenos">70</span></a>
</span><span id="Viz.superposed_bar_plot-71"><a href="#Viz.superposed_bar_plot-71"><span class="linenos">71</span></a><span class="sd">        This function creates overlaid histograms for two groups within the dataset,</span>
</span><span id="Viz.superposed_bar_plot-72"><a href="#Viz.superposed_bar_plot-72"><span class="linenos">72</span></a><span class="sd">        distinguished by the binary values of the categorical column (`target_1`). The</span>
</span><span id="Viz.superposed_bar_plot-73"><a href="#Viz.superposed_bar_plot-73"><span class="linenos">73</span></a><span class="sd">        distribution is shown for another numerical or categorical column (`target_2`),</span>
</span><span id="Viz.superposed_bar_plot-74"><a href="#Viz.superposed_bar_plot-74"><span class="linenos">74</span></a><span class="sd">        providing insights on how the values of the numerical/categorical column vary</span>
</span><span id="Viz.superposed_bar_plot-75"><a href="#Viz.superposed_bar_plot-75"><span class="linenos">75</span></a><span class="sd">        across the two subsets.</span>
</span><span id="Viz.superposed_bar_plot-76"><a href="#Viz.superposed_bar_plot-76"><span class="linenos">76</span></a>
</span><span id="Viz.superposed_bar_plot-77"><a href="#Viz.superposed_bar_plot-77"><span class="linenos">77</span></a><span class="sd">        :param df: A pandas DataFrame containing the data to be visualized.</span>
</span><span id="Viz.superposed_bar_plot-78"><a href="#Viz.superposed_bar_plot-78"><span class="linenos">78</span></a><span class="sd">        :param target_1: The name of the categorical column is used to split the data into</span>
</span><span id="Viz.superposed_bar_plot-79"><a href="#Viz.superposed_bar_plot-79"><span class="linenos">79</span></a><span class="sd">            two subsets. Should have binary values (e.g., 0 and 1).</span>
</span><span id="Viz.superposed_bar_plot-80"><a href="#Viz.superposed_bar_plot-80"><span class="linenos">80</span></a><span class="sd">        :param target_2: The name of the numerical or categorical column for which the</span>
</span><span id="Viz.superposed_bar_plot-81"><a href="#Viz.superposed_bar_plot-81"><span class="linenos">81</span></a><span class="sd">            distribution is visualized using histograms.</span>
</span><span id="Viz.superposed_bar_plot-82"><a href="#Viz.superposed_bar_plot-82"><span class="linenos">82</span></a><span class="sd">        :return: None</span>
</span><span id="Viz.superposed_bar_plot-83"><a href="#Viz.superposed_bar_plot-83"><span class="linenos">83</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz.superposed_bar_plot-84"><a href="#Viz.superposed_bar_plot-84"><span class="linenos">84</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Viz.superposed_bar_plot-85"><a href="#Viz.superposed_bar_plot-85"><span class="linenos">85</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">target_1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">target_2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;No </span><span class="si">{</span><span class="n">target_1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="Viz.superposed_bar_plot-86"><a href="#Viz.superposed_bar_plot-86"><span class="linenos">86</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">target_1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">target_2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">target_1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="Viz.superposed_bar_plot-87"><a href="#Viz.superposed_bar_plot-87"><span class="linenos">87</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Distribution of Customer </span><span class="si">{</span><span class="n">target_2</span><span class="si">}</span><span class="s1"> by </span><span class="si">{</span><span class="n">target_1</span><span class="si">}</span><span class="s1"> Status&#39;</span><span class="p">)</span>
</span><span id="Viz.superposed_bar_plot-88"><a href="#Viz.superposed_bar_plot-88"><span class="linenos">88</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">target_2</span><span class="si">}</span><span class="s1"> (months)&#39;</span><span class="p">)</span>
</span><span id="Viz.superposed_bar_plot-89"><a href="#Viz.superposed_bar_plot-89"><span class="linenos">89</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
</span><span id="Viz.superposed_bar_plot-90"><a href="#Viz.superposed_bar_plot-90"><span class="linenos">90</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="Viz.superposed_bar_plot-91"><a href="#Viz.superposed_bar_plot-91"><span class="linenos">91</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Generates a superposed bar plot to visualize the distribution of a specified target
variable for two subsets of data, split based on another categorical column.</p>

<p>This function creates overlaid histograms for two groups within the dataset,
distinguished by the binary values of the categorical column (<code>target_1</code>). The
distribution is shown for another numerical or categorical column (<code>target_2</code>),
providing insights on how the values of the numerical/categorical column vary
across the two subsets.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>df</strong>:  A pandas DataFrame containing the data to be visualized.</li>
<li><strong>target_1</strong>:  The name of the categorical column is used to split the data into
two subsets. Should have binary values (e.g., 0 and 1).</li>
<li><strong>target_2</strong>:  The name of the numerical or categorical column for which the
distribution is visualized using histograms.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="Viz.stacked_bar_plot" class="classattr">
                                        <input id="Viz.stacked_bar_plot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">stacked_bar_plot</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">df</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>,</span><span class="param">	<span class="n">target_1</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">target_2</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Viz.stacked_bar_plot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Viz.stacked_bar_plot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Viz.stacked_bar_plot-94"><a href="#Viz.stacked_bar_plot-94"><span class="linenos"> 94</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">stacked_bar_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">target_1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target_2</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Viz.stacked_bar_plot-95"><a href="#Viz.stacked_bar_plot-95"><span class="linenos"> 95</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz.stacked_bar_plot-96"><a href="#Viz.stacked_bar_plot-96"><span class="linenos"> 96</span></a><span class="sd">        Creates a stacked bar plot visualizing the proportion of a target variable</span>
</span><span id="Viz.stacked_bar_plot-97"><a href="#Viz.stacked_bar_plot-97"><span class="linenos"> 97</span></a><span class="sd">        across subcategories of another categorical variable. The proportions are</span>
</span><span id="Viz.stacked_bar_plot-98"><a href="#Viz.stacked_bar_plot-98"><span class="linenos"> 98</span></a><span class="sd">        displayed as percentages within each bar.</span>
</span><span id="Viz.stacked_bar_plot-99"><a href="#Viz.stacked_bar_plot-99"><span class="linenos"> 99</span></a>
</span><span id="Viz.stacked_bar_plot-100"><a href="#Viz.stacked_bar_plot-100"><span class="linenos">100</span></a><span class="sd">        :param df: Pandas DataFrame containing the data used for the plot.</span>
</span><span id="Viz.stacked_bar_plot-101"><a href="#Viz.stacked_bar_plot-101"><span class="linenos">101</span></a><span class="sd">        :type df: pd.DataFrame</span>
</span><span id="Viz.stacked_bar_plot-102"><a href="#Viz.stacked_bar_plot-102"><span class="linenos">102</span></a><span class="sd">        :param target_1: The column name for the first categorical variable to group by.</span>
</span><span id="Viz.stacked_bar_plot-103"><a href="#Viz.stacked_bar_plot-103"><span class="linenos">103</span></a><span class="sd">        :type target_1: str</span>
</span><span id="Viz.stacked_bar_plot-104"><a href="#Viz.stacked_bar_plot-104"><span class="linenos">104</span></a><span class="sd">        :param target_2: The column name for the second categorical variable</span>
</span><span id="Viz.stacked_bar_plot-105"><a href="#Viz.stacked_bar_plot-105"><span class="linenos">105</span></a><span class="sd">                         representing the target whose distribution is plotted.</span>
</span><span id="Viz.stacked_bar_plot-106"><a href="#Viz.stacked_bar_plot-106"><span class="linenos">106</span></a><span class="sd">        :type target_2: str</span>
</span><span id="Viz.stacked_bar_plot-107"><a href="#Viz.stacked_bar_plot-107"><span class="linenos">107</span></a><span class="sd">        :return: None. Displays a matplotlib plot.</span>
</span><span id="Viz.stacked_bar_plot-108"><a href="#Viz.stacked_bar_plot-108"><span class="linenos">108</span></a><span class="sd">        :rtype: None</span>
</span><span id="Viz.stacked_bar_plot-109"><a href="#Viz.stacked_bar_plot-109"><span class="linenos">109</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz.stacked_bar_plot-110"><a href="#Viz.stacked_bar_plot-110"><span class="linenos">110</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Viz.stacked_bar_plot-111"><a href="#Viz.stacked_bar_plot-111"><span class="linenos">111</span></a>        <span class="n">churn_by_senior</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">target_1</span><span class="p">,</span> <span class="n">target_2</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</span><span id="Viz.stacked_bar_plot-112"><a href="#Viz.stacked_bar_plot-112"><span class="linenos">112</span></a>        <span class="n">total</span> <span class="o">=</span> <span class="n">churn_by_senior</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Viz.stacked_bar_plot-113"><a href="#Viz.stacked_bar_plot-113"><span class="linenos">113</span></a>        <span class="n">percentages</span> <span class="o">=</span> <span class="p">(</span><span class="n">churn_by_senior</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">total</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Viz.stacked_bar_plot-114"><a href="#Viz.stacked_bar_plot-114"><span class="linenos">114</span></a>
</span><span id="Viz.stacked_bar_plot-115"><a href="#Viz.stacked_bar_plot-115"><span class="linenos">115</span></a>        <span class="n">churn_by_senior</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Viz.stacked_bar_plot-116"><a href="#Viz.stacked_bar_plot-116"><span class="linenos">116</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Churn Distribution by </span><span class="si">{</span><span class="n">target_1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Viz.stacked_bar_plot-117"><a href="#Viz.stacked_bar_plot-117"><span class="linenos">117</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Senior Citizen (0=No, 1=Yes)&#39;</span><span class="p">)</span>
</span><span id="Viz.stacked_bar_plot-118"><a href="#Viz.stacked_bar_plot-118"><span class="linenos">118</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Number of Customers&#39;</span><span class="p">)</span>
</span><span id="Viz.stacked_bar_plot-119"><a href="#Viz.stacked_bar_plot-119"><span class="linenos">119</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Churn&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;Yes&#39;</span><span class="p">])</span>
</span><span id="Viz.stacked_bar_plot-120"><a href="#Viz.stacked_bar_plot-120"><span class="linenos">120</span></a>
</span><span id="Viz.stacked_bar_plot-121"><a href="#Viz.stacked_bar_plot-121"><span class="linenos">121</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">churn_by_senior</span><span class="o">.</span><span class="n">index</span><span class="p">)):</span>
</span><span id="Viz.stacked_bar_plot-122"><a href="#Viz.stacked_bar_plot-122"><span class="linenos">122</span></a>            <span class="n">no_churn</span> <span class="o">=</span> <span class="n">percentages</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="Viz.stacked_bar_plot-123"><a href="#Viz.stacked_bar_plot-123"><span class="linenos">123</span></a>            <span class="n">churn</span> <span class="o">=</span> <span class="n">percentages</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="Viz.stacked_bar_plot-124"><a href="#Viz.stacked_bar_plot-124"><span class="linenos">124</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">churn_by_senior</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="Viz.stacked_bar_plot-125"><a href="#Viz.stacked_bar_plot-125"><span class="linenos">125</span></a>                     <span class="sa">f</span><span class="s1">&#39;No: </span><span class="si">{</span><span class="n">no_churn</span><span class="si">}</span><span class="s1">%</span><span class="se">\n</span><span class="s1">Yes: </span><span class="si">{</span><span class="n">churn</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span>
</span><span id="Viz.stacked_bar_plot-126"><a href="#Viz.stacked_bar_plot-126"><span class="linenos">126</span></a>                     <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
</span><span id="Viz.stacked_bar_plot-127"><a href="#Viz.stacked_bar_plot-127"><span class="linenos">127</span></a>
</span><span id="Viz.stacked_bar_plot-128"><a href="#Viz.stacked_bar_plot-128"><span class="linenos">128</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="Viz.stacked_bar_plot-129"><a href="#Viz.stacked_bar_plot-129"><span class="linenos">129</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Creates a stacked bar plot visualizing the proportion of a target variable
across subcategories of another categorical variable. The proportions are
displayed as percentages within each bar.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>df</strong>:  Pandas DataFrame containing the data used for the plot.</li>
<li><strong>target_1</strong>:  The column name for the first categorical variable to group by.</li>
<li><strong>target_2</strong>:  The column name for the second categorical variable
representing the target whose distribution is plotted.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None. Displays a matplotlib plot.</p>
</blockquote>
</div>


                            </div>
                            <div id="Viz.total_charges_distribution" class="classattr">
                                        <input id="Viz.total_charges_distribution-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">total_charges_distribution</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">df</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Viz.total_charges_distribution-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Viz.total_charges_distribution"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Viz.total_charges_distribution-132"><a href="#Viz.total_charges_distribution-132"><span class="linenos">132</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">total_charges_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Viz.total_charges_distribution-133"><a href="#Viz.total_charges_distribution-133"><span class="linenos">133</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz.total_charges_distribution-134"><a href="#Viz.total_charges_distribution-134"><span class="linenos">134</span></a><span class="sd">        Generates and displays a histogram representing the distribution of the</span>
</span><span id="Viz.total_charges_distribution-135"><a href="#Viz.total_charges_distribution-135"><span class="linenos">135</span></a><span class="sd">        &#39;TotalCharges&#39; column of a given DataFrame, segmented by the &#39;Churn&#39;</span>
</span><span id="Viz.total_charges_distribution-136"><a href="#Viz.total_charges_distribution-136"><span class="linenos">136</span></a><span class="sd">        status. The histogram includes percentage labels for each bin, indicating</span>
</span><span id="Viz.total_charges_distribution-137"><a href="#Viz.total_charges_distribution-137"><span class="linenos">137</span></a><span class="sd">        the percentage count of entries by churn group.</span>
</span><span id="Viz.total_charges_distribution-138"><a href="#Viz.total_charges_distribution-138"><span class="linenos">138</span></a>
</span><span id="Viz.total_charges_distribution-139"><a href="#Viz.total_charges_distribution-139"><span class="linenos">139</span></a><span class="sd">        :param df: A Pandas DataFrame containing the data to be visualized.</span>
</span><span id="Viz.total_charges_distribution-140"><a href="#Viz.total_charges_distribution-140"><span class="linenos">140</span></a><span class="sd">                   The DataFrame must include columns &#39;TotalCharges&#39; and &#39;Churn&#39;.</span>
</span><span id="Viz.total_charges_distribution-141"><a href="#Viz.total_charges_distribution-141"><span class="linenos">141</span></a><span class="sd">        :type df: pd.DataFrame</span>
</span><span id="Viz.total_charges_distribution-142"><a href="#Viz.total_charges_distribution-142"><span class="linenos">142</span></a><span class="sd">        :return: None</span>
</span><span id="Viz.total_charges_distribution-143"><a href="#Viz.total_charges_distribution-143"><span class="linenos">143</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz.total_charges_distribution-144"><a href="#Viz.total_charges_distribution-144"><span class="linenos">144</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Viz.total_charges_distribution-145"><a href="#Viz.total_charges_distribution-145"><span class="linenos">145</span></a>        <span class="c1"># Calculate the percentage for each bin</span>
</span><span id="Viz.total_charges_distribution-146"><a href="#Viz.total_charges_distribution-146"><span class="linenos">146</span></a>        <span class="n">hist_data_no</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Churn&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;TotalCharges&#39;</span><span class="p">],</span>
</span><span id="Viz.total_charges_distribution-147"><a href="#Viz.total_charges_distribution-147"><span class="linenos">147</span></a>                                <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Viz.total_charges_distribution-148"><a href="#Viz.total_charges_distribution-148"><span class="linenos">148</span></a>        <span class="n">hist_data_yes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Churn&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s1">&#39;TotalCharges&#39;</span><span class="p">],</span>
</span><span id="Viz.total_charges_distribution-149"><a href="#Viz.total_charges_distribution-149"><span class="linenos">149</span></a>                                 <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Viz.total_charges_distribution-150"><a href="#Viz.total_charges_distribution-150"><span class="linenos">150</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>  <span class="c1"># Clear the figure</span>
</span><span id="Viz.total_charges_distribution-151"><a href="#Viz.total_charges_distribution-151"><span class="linenos">151</span></a>
</span><span id="Viz.total_charges_distribution-152"><a href="#Viz.total_charges_distribution-152"><span class="linenos">152</span></a>        <span class="c1"># Plot with percentages</span>
</span><span id="Viz.total_charges_distribution-153"><a href="#Viz.total_charges_distribution-153"><span class="linenos">153</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;TotalCharges&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Churn&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
</span><span id="Viz.total_charges_distribution-154"><a href="#Viz.total_charges_distribution-154"><span class="linenos">154</span></a>                     <span class="n">multiple</span><span class="o">=</span><span class="s2">&quot;layer&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="Viz.total_charges_distribution-155"><a href="#Viz.total_charges_distribution-155"><span class="linenos">155</span></a>
</span><span id="Viz.total_charges_distribution-156"><a href="#Viz.total_charges_distribution-156"><span class="linenos">156</span></a>        <span class="c1"># Add percentage labels</span>
</span><span id="Viz.total_charges_distribution-157"><a href="#Viz.total_charges_distribution-157"><span class="linenos">157</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hist_data_no</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
</span><span id="Viz.total_charges_distribution-158"><a href="#Viz.total_charges_distribution-158"><span class="linenos">158</span></a>            <span class="k">if</span> <span class="n">hist_data_no</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Only add label if there are values in the bin</span>
</span><span id="Viz.total_charges_distribution-159"><a href="#Viz.total_charges_distribution-159"><span class="linenos">159</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">hist_data_no</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">hist_data_no</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span>
</span><span id="Viz.total_charges_distribution-160"><a href="#Viz.total_charges_distribution-160"><span class="linenos">160</span></a>                         <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">(</span><span class="n">hist_data_no</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Churn&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span>
</span><span id="Viz.total_charges_distribution-161"><a href="#Viz.total_charges_distribution-161"><span class="linenos">161</span></a>                         <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
</span><span id="Viz.total_charges_distribution-162"><a href="#Viz.total_charges_distribution-162"><span class="linenos">162</span></a>            <span class="k">if</span> <span class="n">hist_data_yes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Only add label if there are values in the bin</span>
</span><span id="Viz.total_charges_distribution-163"><a href="#Viz.total_charges_distribution-163"><span class="linenos">163</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">hist_data_yes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">hist_data_yes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span>
</span><span id="Viz.total_charges_distribution-164"><a href="#Viz.total_charges_distribution-164"><span class="linenos">164</span></a>                         <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">(</span><span class="n">hist_data_yes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Churn&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span>
</span><span id="Viz.total_charges_distribution-165"><a href="#Viz.total_charges_distribution-165"><span class="linenos">165</span></a>                         <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
</span><span id="Viz.total_charges_distribution-166"><a href="#Viz.total_charges_distribution-166"><span class="linenos">166</span></a>
</span><span id="Viz.total_charges_distribution-167"><a href="#Viz.total_charges_distribution-167"><span class="linenos">167</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Total Charges by Churn Status&#39;</span><span class="p">)</span>
</span><span id="Viz.total_charges_distribution-168"><a href="#Viz.total_charges_distribution-168"><span class="linenos">168</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Total Charges ($)&#39;</span><span class="p">)</span>
</span><span id="Viz.total_charges_distribution-169"><a href="#Viz.total_charges_distribution-169"><span class="linenos">169</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
</span><span id="Viz.total_charges_distribution-170"><a href="#Viz.total_charges_distribution-170"><span class="linenos">170</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Churn&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;Yes&#39;</span><span class="p">])</span>
</span><span id="Viz.total_charges_distribution-171"><a href="#Viz.total_charges_distribution-171"><span class="linenos">171</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Generates and displays a histogram representing the distribution of the
'TotalCharges' column of a given DataFrame, segmented by the 'Churn'
status. The histogram includes percentage labels for each bin, indicating
the percentage count of entries by churn group.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>df</strong>:  A Pandas DataFrame containing the data to be visualized.
The DataFrame must include columns 'TotalCharges' and 'Churn'.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="Viz.feature_weights_bar" class="classattr">
                                        <input id="Viz.feature_weights_bar-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">feature_weights_bar</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">feature_weights</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Viz.feature_weights_bar-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Viz.feature_weights_bar"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Viz.feature_weights_bar-174"><a href="#Viz.feature_weights_bar-174"><span class="linenos">174</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">feature_weights_bar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feature_weights</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Viz.feature_weights_bar-175"><a href="#Viz.feature_weights_bar-175"><span class="linenos">175</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz.feature_weights_bar-176"><a href="#Viz.feature_weights_bar-176"><span class="linenos">176</span></a><span class="sd">        Generates a bar plot for visualizing feature weights from a logistic regression model.</span>
</span><span id="Viz.feature_weights_bar-177"><a href="#Viz.feature_weights_bar-177"><span class="linenos">177</span></a>
</span><span id="Viz.feature_weights_bar-178"><a href="#Viz.feature_weights_bar-178"><span class="linenos">178</span></a><span class="sd">        This method uses seaborn to create a bar plot where the weights of the features</span>
</span><span id="Viz.feature_weights_bar-179"><a href="#Viz.feature_weights_bar-179"><span class="linenos">179</span></a><span class="sd">        are displayed along the x-axis and their corresponding feature names on the y-axis.</span>
</span><span id="Viz.feature_weights_bar-180"><a href="#Viz.feature_weights_bar-180"><span class="linenos">180</span></a><span class="sd">        The output figure provides an intuitive understanding of the importance of features</span>
</span><span id="Viz.feature_weights_bar-181"><a href="#Viz.feature_weights_bar-181"><span class="linenos">181</span></a><span class="sd">        in the logistic regression model.</span>
</span><span id="Viz.feature_weights_bar-182"><a href="#Viz.feature_weights_bar-182"><span class="linenos">182</span></a>
</span><span id="Viz.feature_weights_bar-183"><a href="#Viz.feature_weights_bar-183"><span class="linenos">183</span></a><span class="sd">        :param feature_weights: A Pandas DataFrame containing two columns, &#39;Weight&#39; and</span>
</span><span id="Viz.feature_weights_bar-184"><a href="#Viz.feature_weights_bar-184"><span class="linenos">184</span></a><span class="sd">            &#39;Feature&#39;, where &#39;Weight&#39; represents the corresponding feature importance and</span>
</span><span id="Viz.feature_weights_bar-185"><a href="#Viz.feature_weights_bar-185"><span class="linenos">185</span></a><span class="sd">            &#39;Feature&#39; provides the feature names.</span>
</span><span id="Viz.feature_weights_bar-186"><a href="#Viz.feature_weights_bar-186"><span class="linenos">186</span></a>
</span><span id="Viz.feature_weights_bar-187"><a href="#Viz.feature_weights_bar-187"><span class="linenos">187</span></a><span class="sd">        :return: None</span>
</span><span id="Viz.feature_weights_bar-188"><a href="#Viz.feature_weights_bar-188"><span class="linenos">188</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz.feature_weights_bar-189"><a href="#Viz.feature_weights_bar-189"><span class="linenos">189</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</span><span id="Viz.feature_weights_bar-190"><a href="#Viz.feature_weights_bar-190"><span class="linenos">190</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">feature_weights</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Weight&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Feature&#39;</span><span class="p">)</span>
</span><span id="Viz.feature_weights_bar-191"><a href="#Viz.feature_weights_bar-191"><span class="linenos">191</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Logistic Regression Feature Weights&#39;</span><span class="p">)</span>
</span><span id="Viz.feature_weights_bar-192"><a href="#Viz.feature_weights_bar-192"><span class="linenos">192</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Weight&#39;</span><span class="p">)</span>
</span><span id="Viz.feature_weights_bar-193"><a href="#Viz.feature_weights_bar-193"><span class="linenos">193</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Feature&#39;</span><span class="p">)</span>
</span><span id="Viz.feature_weights_bar-194"><a href="#Viz.feature_weights_bar-194"><span class="linenos">194</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="Viz.feature_weights_bar-195"><a href="#Viz.feature_weights_bar-195"><span class="linenos">195</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Generates a bar plot for visualizing feature weights from a logistic regression model.</p>

<p>This method uses seaborn to create a bar plot where the weights of the features
are displayed along the x-axis and their corresponding feature names on the y-axis.
The output figure provides an intuitive understanding of the importance of features
in the logistic regression model.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>feature_weights</strong>:  A Pandas DataFrame containing two columns, 'Weight' and
'Feature', where 'Weight' represents the corresponding feature importance and
'Feature' provides the feature names.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="Viz.confusion_matrix" class="classattr">
                                        <input id="Viz.confusion_matrix-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">confusion_matrix</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">predictions</span>, </span><span class="param"><span class="n">y_test</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Viz.confusion_matrix-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Viz.confusion_matrix"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Viz.confusion_matrix-198"><a href="#Viz.confusion_matrix-198"><span class="linenos">198</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">confusion_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Viz.confusion_matrix-199"><a href="#Viz.confusion_matrix-199"><span class="linenos">199</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz.confusion_matrix-200"><a href="#Viz.confusion_matrix-200"><span class="linenos">200</span></a><span class="sd">        Generates and visualizes a confusion matrix for the provided predictions and</span>
</span><span id="Viz.confusion_matrix-201"><a href="#Viz.confusion_matrix-201"><span class="linenos">201</span></a><span class="sd">        true labels. Calculates and displays various performance metrics such as</span>
</span><span id="Viz.confusion_matrix-202"><a href="#Viz.confusion_matrix-202"><span class="linenos">202</span></a><span class="sd">        accuracy, precision, specificity, and F1 score.</span>
</span><span id="Viz.confusion_matrix-203"><a href="#Viz.confusion_matrix-203"><span class="linenos">203</span></a>
</span><span id="Viz.confusion_matrix-204"><a href="#Viz.confusion_matrix-204"><span class="linenos">204</span></a><span class="sd">        :param predictions: Array of predicted labels, typically coming from</span>
</span><span id="Viz.confusion_matrix-205"><a href="#Viz.confusion_matrix-205"><span class="linenos">205</span></a><span class="sd">            a machine learning model&#39;s output.</span>
</span><span id="Viz.confusion_matrix-206"><a href="#Viz.confusion_matrix-206"><span class="linenos">206</span></a><span class="sd">        :type predictions: array-like</span>
</span><span id="Viz.confusion_matrix-207"><a href="#Viz.confusion_matrix-207"><span class="linenos">207</span></a><span class="sd">        :param y_test: Array of true labels against which predictions are compared.</span>
</span><span id="Viz.confusion_matrix-208"><a href="#Viz.confusion_matrix-208"><span class="linenos">208</span></a><span class="sd">        :type y_test: array-like</span>
</span><span id="Viz.confusion_matrix-209"><a href="#Viz.confusion_matrix-209"><span class="linenos">209</span></a><span class="sd">        :return: None</span>
</span><span id="Viz.confusion_matrix-210"><a href="#Viz.confusion_matrix-210"><span class="linenos">210</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz.confusion_matrix-211"><a href="#Viz.confusion_matrix-211"><span class="linenos">211</span></a>        <span class="c1"># Create confusion matrix</span>
</span><span id="Viz.confusion_matrix-212"><a href="#Viz.confusion_matrix-212"><span class="linenos">212</span></a>        <span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
</span><span id="Viz.confusion_matrix-213"><a href="#Viz.confusion_matrix-213"><span class="linenos">213</span></a>
</span><span id="Viz.confusion_matrix-214"><a href="#Viz.confusion_matrix-214"><span class="linenos">214</span></a>        <span class="c1"># Calculate specificity</span>
</span><span id="Viz.confusion_matrix-215"><a href="#Viz.confusion_matrix-215"><span class="linenos">215</span></a>        <span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</span><span id="Viz.confusion_matrix-216"><a href="#Viz.confusion_matrix-216"><span class="linenos">216</span></a>        <span class="n">specificity</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span> <span class="o">+</span> <span class="n">fp</span><span class="p">)</span>
</span><span id="Viz.confusion_matrix-217"><a href="#Viz.confusion_matrix-217"><span class="linenos">217</span></a>
</span><span id="Viz.confusion_matrix-218"><a href="#Viz.confusion_matrix-218"><span class="linenos">218</span></a>        <span class="c1"># Calculate other metrics</span>
</span><span id="Viz.confusion_matrix-219"><a href="#Viz.confusion_matrix-219"><span class="linenos">219</span></a>        <span class="n">precision</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
</span><span id="Viz.confusion_matrix-220"><a href="#Viz.confusion_matrix-220"><span class="linenos">220</span></a>        <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
</span><span id="Viz.confusion_matrix-221"><a href="#Viz.confusion_matrix-221"><span class="linenos">221</span></a>
</span><span id="Viz.confusion_matrix-222"><a href="#Viz.confusion_matrix-222"><span class="linenos">222</span></a>        <span class="c1"># Plot confusion matrix</span>
</span><span id="Viz.confusion_matrix-223"><a href="#Viz.confusion_matrix-223"><span class="linenos">223</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Viz.confusion_matrix-224"><a href="#Viz.confusion_matrix-224"><span class="linenos">224</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
</span><span id="Viz.confusion_matrix-225"><a href="#Viz.confusion_matrix-225"><span class="linenos">225</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion Matrix&#39;</span><span class="p">)</span>
</span><span id="Viz.confusion_matrix-226"><a href="#Viz.confusion_matrix-226"><span class="linenos">226</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;True Label&#39;</span><span class="p">)</span>
</span><span id="Viz.confusion_matrix-227"><a href="#Viz.confusion_matrix-227"><span class="linenos">227</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted Label&#39;</span><span class="p">)</span>
</span><span id="Viz.confusion_matrix-228"><a href="#Viz.confusion_matrix-228"><span class="linenos">228</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="Viz.confusion_matrix-229"><a href="#Viz.confusion_matrix-229"><span class="linenos">229</span></a>
</span><span id="Viz.confusion_matrix-230"><a href="#Viz.confusion_matrix-230"><span class="linenos">230</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Accuracy: </span><span class="si">{</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">predictions</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Viz.confusion_matrix-231"><a href="#Viz.confusion_matrix-231"><span class="linenos">231</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Precision: </span><span class="si">{</span><span class="n">precision</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Viz.confusion_matrix-232"><a href="#Viz.confusion_matrix-232"><span class="linenos">232</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Specificity: </span><span class="si">{</span><span class="n">specificity</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Viz.confusion_matrix-233"><a href="#Viz.confusion_matrix-233"><span class="linenos">233</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;F1 Score: </span><span class="si">{</span><span class="n">f1</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Generates and visualizes a confusion matrix for the provided predictions and
true labels. Calculates and displays various performance metrics such as
accuracy, precision, specificity, and F1 score.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>predictions</strong>:  Array of predicted labels, typically coming from
a machine learning model's output.</li>
<li><strong>y_test</strong>:  Array of true labels against which predictions are compared.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="Viz.roc_curve" class="classattr">
                                        <input id="Viz.roc_curve-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">roc_curve</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">y_pred_probas</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">y_test</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">labels</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Viz.roc_curve-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Viz.roc_curve"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Viz.roc_curve-236"><a href="#Viz.roc_curve-236"><span class="linenos">236</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">roc_curve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_pred_probas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_test</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Viz.roc_curve-237"><a href="#Viz.roc_curve-237"><span class="linenos">237</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz.roc_curve-238"><a href="#Viz.roc_curve-238"><span class="linenos">238</span></a><span class="sd">        Plots the Receiver Operating Characteristic (ROC) Curve for given predicted probabilities and</span>
</span><span id="Viz.roc_curve-239"><a href="#Viz.roc_curve-239"><span class="linenos">239</span></a><span class="sd">        true labels. If a list of predicted probabilities and true labels is provided, it generates</span>
</span><span id="Viz.roc_curve-240"><a href="#Viz.roc_curve-240"><span class="linenos">240</span></a><span class="sd">        multiple ROC curves. The Area Under the Curve (AUC) is also computed and displayed for</span>
</span><span id="Viz.roc_curve-241"><a href="#Viz.roc_curve-241"><span class="linenos">241</span></a><span class="sd">        each curve.</span>
</span><span id="Viz.roc_curve-242"><a href="#Viz.roc_curve-242"><span class="linenos">242</span></a>
</span><span id="Viz.roc_curve-243"><a href="#Viz.roc_curve-243"><span class="linenos">243</span></a><span class="sd">        :param y_pred_probas: List or single array-like of predicted probabilities.</span>
</span><span id="Viz.roc_curve-244"><a href="#Viz.roc_curve-244"><span class="linenos">244</span></a><span class="sd">        :param y_test: List or single array-like of true labels.</span>
</span><span id="Viz.roc_curve-245"><a href="#Viz.roc_curve-245"><span class="linenos">245</span></a><span class="sd">        :param labels: List of strings to label each ROC curve. Defaults to [&#39;ROC curve&#39;] if not provided.</span>
</span><span id="Viz.roc_curve-246"><a href="#Viz.roc_curve-246"><span class="linenos">246</span></a><span class="sd">        :return: None</span>
</span><span id="Viz.roc_curve-247"><a href="#Viz.roc_curve-247"><span class="linenos">247</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz.roc_curve-248"><a href="#Viz.roc_curve-248"><span class="linenos">248</span></a>        <span class="c1"># If single curve</span>
</span><span id="Viz.roc_curve-249"><a href="#Viz.roc_curve-249"><span class="linenos">249</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred_probas</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Viz.roc_curve-250"><a href="#Viz.roc_curve-250"><span class="linenos">250</span></a>            <span class="n">y_pred_probas</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_pred_probas</span><span class="p">]</span>
</span><span id="Viz.roc_curve-251"><a href="#Viz.roc_curve-251"><span class="linenos">251</span></a>            <span class="n">y_test</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_test</span><span class="p">]</span> 
</span><span id="Viz.roc_curve-252"><a href="#Viz.roc_curve-252"><span class="linenos">252</span></a>            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ROC curve&#39;</span><span class="p">]</span>
</span><span id="Viz.roc_curve-253"><a href="#Viz.roc_curve-253"><span class="linenos">253</span></a>
</span><span id="Viz.roc_curve-254"><a href="#Viz.roc_curve-254"><span class="linenos">254</span></a>        <span class="c1"># Plot ROC curve</span>
</span><span id="Viz.roc_curve-255"><a href="#Viz.roc_curve-255"><span class="linenos">255</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Viz.roc_curve-256"><a href="#Viz.roc_curve-256"><span class="linenos">256</span></a>        
</span><span id="Viz.roc_curve-257"><a href="#Viz.roc_curve-257"><span class="linenos">257</span></a>        <span class="k">for</span> <span class="n">y_pred_proba</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">y_pred_probas</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
</span><span id="Viz.roc_curve-258"><a href="#Viz.roc_curve-258"><span class="linenos">258</span></a>            <span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">)</span>
</span><span id="Viz.roc_curve-259"><a href="#Viz.roc_curve-259"><span class="linenos">259</span></a>            <span class="n">roc_auc</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">)</span>
</span><span id="Viz.roc_curve-260"><a href="#Viz.roc_curve-260"><span class="linenos">260</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1"> (AUC = </span><span class="si">{</span><span class="n">roc_auc</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</span><span id="Viz.roc_curve-261"><a href="#Viz.roc_curve-261"><span class="linenos">261</span></a>
</span><span id="Viz.roc_curve-262"><a href="#Viz.roc_curve-262"><span class="linenos">262</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
</span><span id="Viz.roc_curve-263"><a href="#Viz.roc_curve-263"><span class="linenos">263</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
</span><span id="Viz.roc_curve-264"><a href="#Viz.roc_curve-264"><span class="linenos">264</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
</span><span id="Viz.roc_curve-265"><a href="#Viz.roc_curve-265"><span class="linenos">265</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;False Positive Rate&#39;</span><span class="p">)</span>
</span><span id="Viz.roc_curve-266"><a href="#Viz.roc_curve-266"><span class="linenos">266</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;True Positive Rate&#39;</span><span class="p">)</span> 
</span><span id="Viz.roc_curve-267"><a href="#Viz.roc_curve-267"><span class="linenos">267</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Receiver Operating Characteristic (ROC) Curve&#39;</span><span class="p">)</span>
</span><span id="Viz.roc_curve-268"><a href="#Viz.roc_curve-268"><span class="linenos">268</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
</span><span id="Viz.roc_curve-269"><a href="#Viz.roc_curve-269"><span class="linenos">269</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Plots the Receiver Operating Characteristic (ROC) Curve for given predicted probabilities and
true labels. If a list of predicted probabilities and true labels is provided, it generates
multiple ROC curves. The Area Under the Curve (AUC) is also computed and displayed for
each curve.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>y_pred_probas</strong>:  List or single array-like of predicted probabilities.</li>
<li><strong>y_test</strong>:  List or single array-like of true labels.</li>
<li><strong>labels</strong>:  List of strings to label each ROC curve. Defaults to ['ROC curve'] if not provided.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="Viz.coef_plot" class="classattr">
                                        <input id="Viz.coef_plot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">coef_plot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">lr_model</span>, </span><span class="param"><span class="n">subset</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Viz.coef_plot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Viz.coef_plot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Viz.coef_plot-272"><a href="#Viz.coef_plot-272"><span class="linenos">272</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">coef_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lr_model</span><span class="p">,</span> <span class="n">subset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Viz.coef_plot-273"><a href="#Viz.coef_plot-273"><span class="linenos">273</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz.coef_plot-274"><a href="#Viz.coef_plot-274"><span class="linenos">274</span></a><span class="sd">        Creates a bar plot of the coefficients of features for a given linear regression model</span>
</span><span id="Viz.coef_plot-275"><a href="#Viz.coef_plot-275"><span class="linenos">275</span></a><span class="sd">        and a subset of features. This visualization helps in understanding the importance or</span>
</span><span id="Viz.coef_plot-276"><a href="#Viz.coef_plot-276"><span class="linenos">276</span></a><span class="sd">        impact of each feature in the trained linear regression model.</span>
</span><span id="Viz.coef_plot-277"><a href="#Viz.coef_plot-277"><span class="linenos">277</span></a>
</span><span id="Viz.coef_plot-278"><a href="#Viz.coef_plot-278"><span class="linenos">278</span></a><span class="sd">        :param lr_model: A trained linear regression model whose coefficients will be used</span>
</span><span id="Viz.coef_plot-279"><a href="#Viz.coef_plot-279"><span class="linenos">279</span></a><span class="sd">            for plotting.</span>
</span><span id="Viz.coef_plot-280"><a href="#Viz.coef_plot-280"><span class="linenos">280</span></a><span class="sd">        :type lr_model: sklearn.linear_model._base.LinearRegression</span>
</span><span id="Viz.coef_plot-281"><a href="#Viz.coef_plot-281"><span class="linenos">281</span></a><span class="sd">        :param subset: A DataFrame containing the subset of features corresponding to the</span>
</span><span id="Viz.coef_plot-282"><a href="#Viz.coef_plot-282"><span class="linenos">282</span></a><span class="sd">            coefficients in the linear regression model.</span>
</span><span id="Viz.coef_plot-283"><a href="#Viz.coef_plot-283"><span class="linenos">283</span></a><span class="sd">        :type subset: pandas.DataFrame</span>
</span><span id="Viz.coef_plot-284"><a href="#Viz.coef_plot-284"><span class="linenos">284</span></a><span class="sd">        :return: None</span>
</span><span id="Viz.coef_plot-285"><a href="#Viz.coef_plot-285"><span class="linenos">285</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz.coef_plot-286"><a href="#Viz.coef_plot-286"><span class="linenos">286</span></a>
</span><span id="Viz.coef_plot-287"><a href="#Viz.coef_plot-287"><span class="linenos">287</span></a>        <span class="n">coef_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span><span id="Viz.coef_plot-288"><a href="#Viz.coef_plot-288"><span class="linenos">288</span></a>            <span class="s1">&#39;Feature&#39;</span><span class="p">:</span> <span class="n">subset</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
</span><span id="Viz.coef_plot-289"><a href="#Viz.coef_plot-289"><span class="linenos">289</span></a>            <span class="s1">&#39;Coefficient&#39;</span><span class="p">:</span> <span class="n">lr_model</span><span class="o">.</span><span class="n">coef_</span>
</span><span id="Viz.coef_plot-290"><a href="#Viz.coef_plot-290"><span class="linenos">290</span></a>        <span class="p">})</span>
</span><span id="Viz.coef_plot-291"><a href="#Viz.coef_plot-291"><span class="linenos">291</span></a>
</span><span id="Viz.coef_plot-292"><a href="#Viz.coef_plot-292"><span class="linenos">292</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Viz.coef_plot-293"><a href="#Viz.coef_plot-293"><span class="linenos">293</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">coef_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Coefficient&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Feature&#39;</span><span class="p">)</span>
</span><span id="Viz.coef_plot-294"><a href="#Viz.coef_plot-294"><span class="linenos">294</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Feature Coefficients in Linear Regression&#39;</span><span class="p">)</span>
</span><span id="Viz.coef_plot-295"><a href="#Viz.coef_plot-295"><span class="linenos">295</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Coefficient Value&#39;</span><span class="p">)</span>
</span><span id="Viz.coef_plot-296"><a href="#Viz.coef_plot-296"><span class="linenos">296</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Feature&#39;</span><span class="p">)</span>
</span><span id="Viz.coef_plot-297"><a href="#Viz.coef_plot-297"><span class="linenos">297</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="Viz.coef_plot-298"><a href="#Viz.coef_plot-298"><span class="linenos">298</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Creates a bar plot of the coefficients of features for a given linear regression model
and a subset of features. This visualization helps in understanding the importance or
impact of each feature in the trained linear regression model.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>lr_model</strong>:  A trained linear regression model whose coefficients will be used
for plotting.</li>
<li><strong>subset</strong>:  A DataFrame containing the subset of features corresponding to the
coefficients in the linear regression model.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="Viz.residuals_scatter" class="classattr">
                                        <input id="Viz.residuals_scatter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">residuals_scatter</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">y_test_sub</span>, </span><span class="param"><span class="n">prediction</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Viz.residuals_scatter-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Viz.residuals_scatter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Viz.residuals_scatter-301"><a href="#Viz.residuals_scatter-301"><span class="linenos">301</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">residuals_scatter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_test_sub</span><span class="p">,</span> <span class="n">prediction</span><span class="p">):</span>
</span><span id="Viz.residuals_scatter-302"><a href="#Viz.residuals_scatter-302"><span class="linenos">302</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz.residuals_scatter-303"><a href="#Viz.residuals_scatter-303"><span class="linenos">303</span></a><span class="sd">        Compute and display a residuals scatter plot. The residuals are calculated as</span>
</span><span id="Viz.residuals_scatter-304"><a href="#Viz.residuals_scatter-304"><span class="linenos">304</span></a><span class="sd">        the difference between the true values (`y_test_sub`) and the predicted</span>
</span><span id="Viz.residuals_scatter-305"><a href="#Viz.residuals_scatter-305"><span class="linenos">305</span></a><span class="sd">        values (`prediction`). The scatter plot visualizes these residuals against the</span>
</span><span id="Viz.residuals_scatter-306"><a href="#Viz.residuals_scatter-306"><span class="linenos">306</span></a><span class="sd">        predicted values, which can provide insights into the prediction model&#39;s</span>
</span><span id="Viz.residuals_scatter-307"><a href="#Viz.residuals_scatter-307"><span class="linenos">307</span></a><span class="sd">        performance and highlight any patterns or biases.</span>
</span><span id="Viz.residuals_scatter-308"><a href="#Viz.residuals_scatter-308"><span class="linenos">308</span></a>
</span><span id="Viz.residuals_scatter-309"><a href="#Viz.residuals_scatter-309"><span class="linenos">309</span></a><span class="sd">        :param y_test_sub: Array of true target values.</span>
</span><span id="Viz.residuals_scatter-310"><a href="#Viz.residuals_scatter-310"><span class="linenos">310</span></a><span class="sd">        :param prediction: Array of predicted target values.</span>
</span><span id="Viz.residuals_scatter-311"><a href="#Viz.residuals_scatter-311"><span class="linenos">311</span></a><span class="sd">        :return: None</span>
</span><span id="Viz.residuals_scatter-312"><a href="#Viz.residuals_scatter-312"><span class="linenos">312</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz.residuals_scatter-313"><a href="#Viz.residuals_scatter-313"><span class="linenos">313</span></a>        <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test_sub</span> <span class="o">-</span> <span class="n">prediction</span>
</span><span id="Viz.residuals_scatter-314"><a href="#Viz.residuals_scatter-314"><span class="linenos">314</span></a>
</span><span id="Viz.residuals_scatter-315"><a href="#Viz.residuals_scatter-315"><span class="linenos">315</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Viz.residuals_scatter-316"><a href="#Viz.residuals_scatter-316"><span class="linenos">316</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">prediction</span><span class="p">,</span> <span class="n">residuals</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="Viz.residuals_scatter-317"><a href="#Viz.residuals_scatter-317"><span class="linenos">317</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
</span><span id="Viz.residuals_scatter-318"><a href="#Viz.residuals_scatter-318"><span class="linenos">318</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Residual Plot&#39;</span><span class="p">)</span>
</span><span id="Viz.residuals_scatter-319"><a href="#Viz.residuals_scatter-319"><span class="linenos">319</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted Values&#39;</span><span class="p">)</span>
</span><span id="Viz.residuals_scatter-320"><a href="#Viz.residuals_scatter-320"><span class="linenos">320</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Residuals&#39;</span><span class="p">)</span>
</span><span id="Viz.residuals_scatter-321"><a href="#Viz.residuals_scatter-321"><span class="linenos">321</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Compute and display a residuals scatter plot. The residuals are calculated as
the difference between the true values (<code>y_test_sub</code>) and the predicted
values (<code>prediction</code>). The scatter plot visualizes these residuals against the
predicted values, which can provide insights into the prediction model's
performance and highlight any patterns or biases.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>y_test_sub</strong>:  Array of true target values.</li>
<li><strong>prediction</strong>:  Array of predicted target values.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="Viz.plot_r2_poly_degree" class="classattr">
                                        <input id="Viz.plot_r2_poly_degree-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_r2_poly_degree</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">poly_reg_scores</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Viz.plot_r2_poly_degree-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Viz.plot_r2_poly_degree"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Viz.plot_r2_poly_degree-324"><a href="#Viz.plot_r2_poly_degree-324"><span class="linenos">324</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_r2_poly_degree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">poly_reg_scores</span><span class="p">):</span>
</span><span id="Viz.plot_r2_poly_degree-325"><a href="#Viz.plot_r2_poly_degree-325"><span class="linenos">325</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz.plot_r2_poly_degree-326"><a href="#Viz.plot_r2_poly_degree-326"><span class="linenos">326</span></a><span class="sd">        Plot the R² scores of polynomial regression models against their polynomial degrees.</span>
</span><span id="Viz.plot_r2_poly_degree-327"><a href="#Viz.plot_r2_poly_degree-327"><span class="linenos">327</span></a><span class="sd">        This function visualizes the relationship between different polynomial degrees and their</span>
</span><span id="Viz.plot_r2_poly_degree-328"><a href="#Viz.plot_r2_poly_degree-328"><span class="linenos">328</span></a><span class="sd">        corresponding R² scores using a bar chart. Each bar represents the R² score of a specific</span>
</span><span id="Viz.plot_r2_poly_degree-329"><a href="#Viz.plot_r2_poly_degree-329"><span class="linenos">329</span></a><span class="sd">        polynomial degree, and its exact value is displayed as text above the bar.</span>
</span><span id="Viz.plot_r2_poly_degree-330"><a href="#Viz.plot_r2_poly_degree-330"><span class="linenos">330</span></a>
</span><span id="Viz.plot_r2_poly_degree-331"><a href="#Viz.plot_r2_poly_degree-331"><span class="linenos">331</span></a><span class="sd">        :param poly_reg_scores: A dictionary where keys represent the degree of the polynomial</span>
</span><span id="Viz.plot_r2_poly_degree-332"><a href="#Viz.plot_r2_poly_degree-332"><span class="linenos">332</span></a><span class="sd">            (int) and values are the corresponding R² scores (float).</span>
</span><span id="Viz.plot_r2_poly_degree-333"><a href="#Viz.plot_r2_poly_degree-333"><span class="linenos">333</span></a><span class="sd">        :return: None. The function displays the plot but does not return any value.</span>
</span><span id="Viz.plot_r2_poly_degree-334"><a href="#Viz.plot_r2_poly_degree-334"><span class="linenos">334</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz.plot_r2_poly_degree-335"><a href="#Viz.plot_r2_poly_degree-335"><span class="linenos">335</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Viz.plot_r2_poly_degree-336"><a href="#Viz.plot_r2_poly_degree-336"><span class="linenos">336</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">poly_reg_scores</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">poly_reg_scores</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="Viz.plot_r2_poly_degree-337"><a href="#Viz.plot_r2_poly_degree-337"><span class="linenos">337</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;R² Score by Polynomial Degree&#39;</span><span class="p">)</span>
</span><span id="Viz.plot_r2_poly_degree-338"><a href="#Viz.plot_r2_poly_degree-338"><span class="linenos">338</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Polynomial Degree&#39;</span><span class="p">)</span>
</span><span id="Viz.plot_r2_poly_degree-339"><a href="#Viz.plot_r2_poly_degree-339"><span class="linenos">339</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;R² Score&#39;</span><span class="p">)</span>
</span><span id="Viz.plot_r2_poly_degree-340"><a href="#Viz.plot_r2_poly_degree-340"><span class="linenos">340</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Viz.plot_r2_poly_degree-341"><a href="#Viz.plot_r2_poly_degree-341"><span class="linenos">341</span></a>
</span><span id="Viz.plot_r2_poly_degree-342"><a href="#Viz.plot_r2_poly_degree-342"><span class="linenos">342</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">poly_reg_scores</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Viz.plot_r2_poly_degree-343"><a href="#Viz.plot_r2_poly_degree-343"><span class="linenos">343</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
</span><span id="Viz.plot_r2_poly_degree-344"><a href="#Viz.plot_r2_poly_degree-344"><span class="linenos">344</span></a>
</span><span id="Viz.plot_r2_poly_degree-345"><a href="#Viz.plot_r2_poly_degree-345"><span class="linenos">345</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Plot the R² scores of polynomial regression models against their polynomial degrees.
This function visualizes the relationship between different polynomial degrees and their
corresponding R² scores using a bar chart. Each bar represents the R² score of a specific
polynomial degree, and its exact value is displayed as text above the bar.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>poly_reg_scores</strong>:  A dictionary where keys represent the degree of the polynomial
(int) and values are the corresponding R² scores (float).</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None. The function displays the plot but does not return any value.</p>
</blockquote>
</div>


                            </div>
                            <div id="Viz.plot_tree" class="classattr">
                                        <input id="Viz.plot_tree-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_tree</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">clf_tree</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Viz.plot_tree-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Viz.plot_tree"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Viz.plot_tree-348"><a href="#Viz.plot_tree-348"><span class="linenos">348</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clf_tree</span><span class="p">):</span>
</span><span id="Viz.plot_tree-349"><a href="#Viz.plot_tree-349"><span class="linenos">349</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz.plot_tree-350"><a href="#Viz.plot_tree-350"><span class="linenos">350</span></a><span class="sd">        Visualizes a decision tree classifier using matplotlib.</span>
</span><span id="Viz.plot_tree-351"><a href="#Viz.plot_tree-351"><span class="linenos">351</span></a>
</span><span id="Viz.plot_tree-352"><a href="#Viz.plot_tree-352"><span class="linenos">352</span></a><span class="sd">        This method takes a decision tree classifier and generates a visual</span>
</span><span id="Viz.plot_tree-353"><a href="#Viz.plot_tree-353"><span class="linenos">353</span></a><span class="sd">        representation of the tree structure using matplotlib. The tree is</span>
</span><span id="Viz.plot_tree-354"><a href="#Viz.plot_tree-354"><span class="linenos">354</span></a><span class="sd">        plotted with a filled node style.</span>
</span><span id="Viz.plot_tree-355"><a href="#Viz.plot_tree-355"><span class="linenos">355</span></a>
</span><span id="Viz.plot_tree-356"><a href="#Viz.plot_tree-356"><span class="linenos">356</span></a><span class="sd">        :param clf_tree: The decision tree classifier model to be plotted.</span>
</span><span id="Viz.plot_tree-357"><a href="#Viz.plot_tree-357"><span class="linenos">357</span></a><span class="sd">        :type clf_tree: sklearn.tree.DecisionTreeClassifier</span>
</span><span id="Viz.plot_tree-358"><a href="#Viz.plot_tree-358"><span class="linenos">358</span></a><span class="sd">        :return: None</span>
</span><span id="Viz.plot_tree-359"><a href="#Viz.plot_tree-359"><span class="linenos">359</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz.plot_tree-360"><a href="#Viz.plot_tree-360"><span class="linenos">360</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn</span><span class="w"> </span><span class="kn">import</span> <span class="n">tree</span>
</span><span id="Viz.plot_tree-361"><a href="#Viz.plot_tree-361"><span class="linenos">361</span></a>
</span><span id="Viz.plot_tree-362"><a href="#Viz.plot_tree-362"><span class="linenos">362</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
</span><span id="Viz.plot_tree-363"><a href="#Viz.plot_tree-363"><span class="linenos">363</span></a>        <span class="n">tree</span><span class="o">.</span><span class="n">plot_tree</span><span class="p">(</span><span class="n">clf_tree</span><span class="p">,</span> <span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Visualizes a decision tree classifier using matplotlib.</p>

<p>This method takes a decision tree classifier and generates a visual
representation of the tree structure using matplotlib. The tree is
plotted with a filled node style.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>clf_tree</strong>:  The decision tree classifier model to be plotted.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="Viz.importance_viz_barplot" class="classattr">
                                        <input id="Viz.importance_viz_barplot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">importance_viz_barplot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">importances</span>, </span><span class="param"><span class="n">name</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Viz.importance_viz_barplot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Viz.importance_viz_barplot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Viz.importance_viz_barplot-366"><a href="#Viz.importance_viz_barplot-366"><span class="linenos">366</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">importance_viz_barplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">importances</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
</span><span id="Viz.importance_viz_barplot-367"><a href="#Viz.importance_viz_barplot-367"><span class="linenos">367</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz.importance_viz_barplot-368"><a href="#Viz.importance_viz_barplot-368"><span class="linenos">368</span></a><span class="sd">        Generates a bar plot visualization of feature importances for a specific model.</span>
</span><span id="Viz.importance_viz_barplot-369"><a href="#Viz.importance_viz_barplot-369"><span class="linenos">369</span></a>
</span><span id="Viz.importance_viz_barplot-370"><a href="#Viz.importance_viz_barplot-370"><span class="linenos">370</span></a><span class="sd">        This function creates a horizontal bar plot for representing feature importance</span>
</span><span id="Viz.importance_viz_barplot-371"><a href="#Viz.importance_viz_barplot-371"><span class="linenos">371</span></a><span class="sd">        data by using Matplotlib and Seaborn libraries. The plot is titled to</span>
</span><span id="Viz.importance_viz_barplot-372"><a href="#Viz.importance_viz_barplot-372"><span class="linenos">372</span></a><span class="sd">        indicate the model&#39;s name, and it highlights the most important features</span>
</span><span id="Viz.importance_viz_barplot-373"><a href="#Viz.importance_viz_barplot-373"><span class="linenos">373</span></a><span class="sd">        in descending order of their importance.</span>
</span><span id="Viz.importance_viz_barplot-374"><a href="#Viz.importance_viz_barplot-374"><span class="linenos">374</span></a>
</span><span id="Viz.importance_viz_barplot-375"><a href="#Viz.importance_viz_barplot-375"><span class="linenos">375</span></a><span class="sd">        :param importances:</span>
</span><span id="Viz.importance_viz_barplot-376"><a href="#Viz.importance_viz_barplot-376"><span class="linenos">376</span></a><span class="sd">            A pandas DataFrame containing feature importance information. It is</span>
</span><span id="Viz.importance_viz_barplot-377"><a href="#Viz.importance_viz_barplot-377"><span class="linenos">377</span></a><span class="sd">            expected to have at least two columns:</span>
</span><span id="Viz.importance_viz_barplot-378"><a href="#Viz.importance_viz_barplot-378"><span class="linenos">378</span></a><span class="sd">            - &#39;feature&#39;: Names of the features.</span>
</span><span id="Viz.importance_viz_barplot-379"><a href="#Viz.importance_viz_barplot-379"><span class="linenos">379</span></a><span class="sd">            - &#39;importance&#39;: Importance scores for the features (assumed to be numerical).</span>
</span><span id="Viz.importance_viz_barplot-380"><a href="#Viz.importance_viz_barplot-380"><span class="linenos">380</span></a><span class="sd">        :param name:</span>
</span><span id="Viz.importance_viz_barplot-381"><a href="#Viz.importance_viz_barplot-381"><span class="linenos">381</span></a><span class="sd">            A string representing the name of the model whose feature</span>
</span><span id="Viz.importance_viz_barplot-382"><a href="#Viz.importance_viz_barplot-382"><span class="linenos">382</span></a><span class="sd">            importance is visualized.</span>
</span><span id="Viz.importance_viz_barplot-383"><a href="#Viz.importance_viz_barplot-383"><span class="linenos">383</span></a><span class="sd">        :return:</span>
</span><span id="Viz.importance_viz_barplot-384"><a href="#Viz.importance_viz_barplot-384"><span class="linenos">384</span></a><span class="sd">            None</span>
</span><span id="Viz.importance_viz_barplot-385"><a href="#Viz.importance_viz_barplot-385"><span class="linenos">385</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz.importance_viz_barplot-386"><a href="#Viz.importance_viz_barplot-386"><span class="linenos">386</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Viz.importance_viz_barplot-387"><a href="#Viz.importance_viz_barplot-387"><span class="linenos">387</span></a>        <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">importances</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;importance&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;feature&#39;</span><span class="p">)</span>
</span><span id="Viz.importance_viz_barplot-388"><a href="#Viz.importance_viz_barplot-388"><span class="linenos">388</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Top </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">importances</span><span class="p">)</span><span class="si">}</span><span class="s1"> Most Important Features in </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> Model&#39;</span><span class="p">)</span>
</span><span id="Viz.importance_viz_barplot-389"><a href="#Viz.importance_viz_barplot-389"><span class="linenos">389</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Feature Importance&#39;</span><span class="p">)</span>
</span><span id="Viz.importance_viz_barplot-390"><a href="#Viz.importance_viz_barplot-390"><span class="linenos">390</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Generates a bar plot visualization of feature importances for a specific model.</p>

<p>This function creates a horizontal bar plot for representing feature importance
data by using Matplotlib and Seaborn libraries. The plot is titled to
indicate the model's name, and it highlights the most important features
in descending order of their importance.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>importances</strong>: 
A pandas DataFrame containing feature importance information. It is
expected to have at least two columns:
<ul>
<li>'feature': Names of the features.</li>
<li>'importance': Importance scores for the features (assumed to be numerical).</li>
</ul></li>
<li><strong>name</strong>: 
A string representing the name of the model whose feature
importance is visualized.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
<pre><code>None
</code></pre>
</blockquote>
</div>


                            </div>
                            <div id="Viz.scores_comparison_plot" class="classattr">
                                        <input id="Viz.scores_comparison_plot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">scores_comparison_plot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">metrics</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Viz.scores_comparison_plot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Viz.scores_comparison_plot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Viz.scores_comparison_plot-393"><a href="#Viz.scores_comparison_plot-393"><span class="linenos">393</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">scores_comparison_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metrics</span><span class="p">):</span>
</span><span id="Viz.scores_comparison_plot-394"><a href="#Viz.scores_comparison_plot-394"><span class="linenos">394</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz.scores_comparison_plot-395"><a href="#Viz.scores_comparison_plot-395"><span class="linenos">395</span></a><span class="sd">        Generates a series of bar plots to compare a set of classification metrics across</span>
</span><span id="Viz.scores_comparison_plot-396"><a href="#Viz.scores_comparison_plot-396"><span class="linenos">396</span></a><span class="sd">        different models or configurations.</span>
</span><span id="Viz.scores_comparison_plot-397"><a href="#Viz.scores_comparison_plot-397"><span class="linenos">397</span></a>
</span><span id="Viz.scores_comparison_plot-398"><a href="#Viz.scores_comparison_plot-398"><span class="linenos">398</span></a><span class="sd">        The function takes in a dictionary containing metric scores (Precision, Recall,</span>
</span><span id="Viz.scores_comparison_plot-399"><a href="#Viz.scores_comparison_plot-399"><span class="linenos">399</span></a><span class="sd">        F1, and AUC) for each model. It creates a 2x2 grid of subplots, where each subplot</span>
</span><span id="Viz.scores_comparison_plot-400"><a href="#Viz.scores_comparison_plot-400"><span class="linenos">400</span></a><span class="sd">        represents one of the metrics, and displays a side-by-side bar plot for the models.</span>
</span><span id="Viz.scores_comparison_plot-401"><a href="#Viz.scores_comparison_plot-401"><span class="linenos">401</span></a><span class="sd">        The function ensures the y-axis for each plot ranges from 0 to 1 to enhance</span>
</span><span id="Viz.scores_comparison_plot-402"><a href="#Viz.scores_comparison_plot-402"><span class="linenos">402</span></a><span class="sd">        comparability.</span>
</span><span id="Viz.scores_comparison_plot-403"><a href="#Viz.scores_comparison_plot-403"><span class="linenos">403</span></a>
</span><span id="Viz.scores_comparison_plot-404"><a href="#Viz.scores_comparison_plot-404"><span class="linenos">404</span></a><span class="sd">        :param metrics: A dictionary where keys are model names or configurations and</span>
</span><span id="Viz.scores_comparison_plot-405"><a href="#Viz.scores_comparison_plot-405"><span class="linenos">405</span></a><span class="sd">            values are nested dictionaries containing the metrics (&#39;Precision&#39;, &#39;Recall&#39;,</span>
</span><span id="Viz.scores_comparison_plot-406"><a href="#Viz.scores_comparison_plot-406"><span class="linenos">406</span></a><span class="sd">            &#39;F1&#39;, and &#39;AUC&#39;) as keys and their corresponding scores as values.</span>
</span><span id="Viz.scores_comparison_plot-407"><a href="#Viz.scores_comparison_plot-407"><span class="linenos">407</span></a><span class="sd">            Example:</span>
</span><span id="Viz.scores_comparison_plot-408"><a href="#Viz.scores_comparison_plot-408"><span class="linenos">408</span></a><span class="sd">                {</span>
</span><span id="Viz.scores_comparison_plot-409"><a href="#Viz.scores_comparison_plot-409"><span class="linenos">409</span></a><span class="sd">                    &quot;Model_1&quot;: {&quot;Precision&quot;: 0.85, &quot;Recall&quot;: 0.80, &quot;F1&quot;: 0.82, &quot;AUC&quot;: 0.90},</span>
</span><span id="Viz.scores_comparison_plot-410"><a href="#Viz.scores_comparison_plot-410"><span class="linenos">410</span></a><span class="sd">                    &quot;Model_2&quot;: {&quot;Precision&quot;: 0.83, &quot;Recall&quot;: 0.78, &quot;F1&quot;: 0.80, &quot;AUC&quot;: 0.89}</span>
</span><span id="Viz.scores_comparison_plot-411"><a href="#Viz.scores_comparison_plot-411"><span class="linenos">411</span></a><span class="sd">                }</span>
</span><span id="Viz.scores_comparison_plot-412"><a href="#Viz.scores_comparison_plot-412"><span class="linenos">412</span></a>
</span><span id="Viz.scores_comparison_plot-413"><a href="#Viz.scores_comparison_plot-413"><span class="linenos">413</span></a><span class="sd">        :return: None</span>
</span><span id="Viz.scores_comparison_plot-414"><a href="#Viz.scores_comparison_plot-414"><span class="linenos">414</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz.scores_comparison_plot-415"><a href="#Viz.scores_comparison_plot-415"><span class="linenos">415</span></a>        <span class="c1"># Create comparison plots</span>
</span><span id="Viz.scores_comparison_plot-416"><a href="#Viz.scores_comparison_plot-416"><span class="linenos">416</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">),</span> <span class="p">(</span><span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">))</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="Viz.scores_comparison_plot-417"><a href="#Viz.scores_comparison_plot-417"><span class="linenos">417</span></a>
</span><span id="Viz.scores_comparison_plot-418"><a href="#Viz.scores_comparison_plot-418"><span class="linenos">418</span></a>        <span class="n">metrics_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="Viz.scores_comparison_plot-419"><a href="#Viz.scores_comparison_plot-419"><span class="linenos">419</span></a>
</span><span id="Viz.scores_comparison_plot-420"><a href="#Viz.scores_comparison_plot-420"><span class="linenos">420</span></a>        <span class="c1"># Precision plot</span>
</span><span id="Viz.scores_comparison_plot-421"><a href="#Viz.scores_comparison_plot-421"><span class="linenos">421</span></a>        <span class="n">metrics_df</span><span class="p">[</span><span class="s1">&#39;Precision&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>
</span><span id="Viz.scores_comparison_plot-422"><a href="#Viz.scores_comparison_plot-422"><span class="linenos">422</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Precision Comparison&#39;</span><span class="p">)</span>
</span><span id="Viz.scores_comparison_plot-423"><a href="#Viz.scores_comparison_plot-423"><span class="linenos">423</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Viz.scores_comparison_plot-424"><a href="#Viz.scores_comparison_plot-424"><span class="linenos">424</span></a>
</span><span id="Viz.scores_comparison_plot-425"><a href="#Viz.scores_comparison_plot-425"><span class="linenos">425</span></a>        <span class="c1"># Recall plot</span>
</span><span id="Viz.scores_comparison_plot-426"><a href="#Viz.scores_comparison_plot-426"><span class="linenos">426</span></a>        <span class="n">metrics_df</span><span class="p">[</span><span class="s1">&#39;Recall&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgreen&#39;</span><span class="p">)</span>
</span><span id="Viz.scores_comparison_plot-427"><a href="#Viz.scores_comparison_plot-427"><span class="linenos">427</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Recall Comparison&#39;</span><span class="p">)</span>
</span><span id="Viz.scores_comparison_plot-428"><a href="#Viz.scores_comparison_plot-428"><span class="linenos">428</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Viz.scores_comparison_plot-429"><a href="#Viz.scores_comparison_plot-429"><span class="linenos">429</span></a>
</span><span id="Viz.scores_comparison_plot-430"><a href="#Viz.scores_comparison_plot-430"><span class="linenos">430</span></a>        <span class="c1"># F1 plot</span>
</span><span id="Viz.scores_comparison_plot-431"><a href="#Viz.scores_comparison_plot-431"><span class="linenos">431</span></a>        <span class="n">metrics_df</span><span class="p">[</span><span class="s1">&#39;F1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">)</span>
</span><span id="Viz.scores_comparison_plot-432"><a href="#Viz.scores_comparison_plot-432"><span class="linenos">432</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;F1 Score Comparison&#39;</span><span class="p">)</span>
</span><span id="Viz.scores_comparison_plot-433"><a href="#Viz.scores_comparison_plot-433"><span class="linenos">433</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Viz.scores_comparison_plot-434"><a href="#Viz.scores_comparison_plot-434"><span class="linenos">434</span></a>
</span><span id="Viz.scores_comparison_plot-435"><a href="#Viz.scores_comparison_plot-435"><span class="linenos">435</span></a>        <span class="c1"># AUC plot</span>
</span><span id="Viz.scores_comparison_plot-436"><a href="#Viz.scores_comparison_plot-436"><span class="linenos">436</span></a>        <span class="n">metrics_df</span><span class="p">[</span><span class="s1">&#39;AUC&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;plum&#39;</span><span class="p">)</span>
</span><span id="Viz.scores_comparison_plot-437"><a href="#Viz.scores_comparison_plot-437"><span class="linenos">437</span></a>        <span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;AUC Score Comparison&#39;</span><span class="p">)</span>
</span><span id="Viz.scores_comparison_plot-438"><a href="#Viz.scores_comparison_plot-438"><span class="linenos">438</span></a>        <span class="n">ax4</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Viz.scores_comparison_plot-439"><a href="#Viz.scores_comparison_plot-439"><span class="linenos">439</span></a>
</span><span id="Viz.scores_comparison_plot-440"><a href="#Viz.scores_comparison_plot-440"><span class="linenos">440</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="Viz.scores_comparison_plot-441"><a href="#Viz.scores_comparison_plot-441"><span class="linenos">441</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Generates a series of bar plots to compare a set of classification metrics across
different models or configurations.</p>

<p>The function takes in a dictionary containing metric scores (Precision, Recall,
F1, and AUC) for each model. It creates a 2x2 grid of subplots, where each subplot
represents one of the metrics, and displays a side-by-side bar plot for the models.
The function ensures the y-axis for each plot ranges from 0 to 1 to enhance
comparability.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>metrics</strong>:  A dictionary where keys are model names or configurations and
values are nested dictionaries containing the metrics ('Precision', 'Recall',
'F1', and 'AUC') as keys and their corresponding scores as values.
Example:
    {
        "Model_1": {"Precision": 0.85, "Recall": 0.80, "F1": 0.82, "AUC": 0.90},
        "Model_2": {"Precision": 0.83, "Recall": 0.78, "F1": 0.80, "AUC": 0.89}
    }</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="Viz.cross_validation_comparison_plot" class="classattr">
                                        <input id="Viz.cross_validation_comparison_plot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">cross_validation_comparison_plot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">models</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Viz.cross_validation_comparison_plot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Viz.cross_validation_comparison_plot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Viz.cross_validation_comparison_plot-444"><a href="#Viz.cross_validation_comparison_plot-444"><span class="linenos">444</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cross_validation_comparison_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">models</span><span class="p">):</span>
</span><span id="Viz.cross_validation_comparison_plot-445"><a href="#Viz.cross_validation_comparison_plot-445"><span class="linenos">445</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz.cross_validation_comparison_plot-446"><a href="#Viz.cross_validation_comparison_plot-446"><span class="linenos">446</span></a><span class="sd">        Generates a bar plot comparing the mean and standard deviation of cross-validation</span>
</span><span id="Viz.cross_validation_comparison_plot-447"><a href="#Viz.cross_validation_comparison_plot-447"><span class="linenos">447</span></a><span class="sd">        scores for multiple models. The input `models` should be a dictionary where keys</span>
</span><span id="Viz.cross_validation_comparison_plot-448"><a href="#Viz.cross_validation_comparison_plot-448"><span class="linenos">448</span></a><span class="sd">        are model names and values are lists of cross-validation scores.</span>
</span><span id="Viz.cross_validation_comparison_plot-449"><a href="#Viz.cross_validation_comparison_plot-449"><span class="linenos">449</span></a>
</span><span id="Viz.cross_validation_comparison_plot-450"><a href="#Viz.cross_validation_comparison_plot-450"><span class="linenos">450</span></a><span class="sd">        The function computes the mean and standard deviation for each model, and visualizes</span>
</span><span id="Viz.cross_validation_comparison_plot-451"><a href="#Viz.cross_validation_comparison_plot-451"><span class="linenos">451</span></a><span class="sd">        them using a bar plot with error bars. Each bar represents a model&#39;s average score</span>
</span><span id="Viz.cross_validation_comparison_plot-452"><a href="#Viz.cross_validation_comparison_plot-452"><span class="linenos">452</span></a><span class="sd">        with corresponding error bars indicating its standard deviation.</span>
</span><span id="Viz.cross_validation_comparison_plot-453"><a href="#Viz.cross_validation_comparison_plot-453"><span class="linenos">453</span></a>
</span><span id="Viz.cross_validation_comparison_plot-454"><a href="#Viz.cross_validation_comparison_plot-454"><span class="linenos">454</span></a><span class="sd">        :param models: A dictionary where keys are model names (str) and values are lists</span>
</span><span id="Viz.cross_validation_comparison_plot-455"><a href="#Viz.cross_validation_comparison_plot-455"><span class="linenos">455</span></a><span class="sd">            of cross-validation scores (list of floats).</span>
</span><span id="Viz.cross_validation_comparison_plot-456"><a href="#Viz.cross_validation_comparison_plot-456"><span class="linenos">456</span></a><span class="sd">        :type models: dict</span>
</span><span id="Viz.cross_validation_comparison_plot-457"><a href="#Viz.cross_validation_comparison_plot-457"><span class="linenos">457</span></a><span class="sd">        :return: None</span>
</span><span id="Viz.cross_validation_comparison_plot-458"><a href="#Viz.cross_validation_comparison_plot-458"><span class="linenos">458</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz.cross_validation_comparison_plot-459"><a href="#Viz.cross_validation_comparison_plot-459"><span class="linenos">459</span></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="Viz.cross_validation_comparison_plot-460"><a href="#Viz.cross_validation_comparison_plot-460"><span class="linenos">460</span></a>
</span><span id="Viz.cross_validation_comparison_plot-461"><a href="#Viz.cross_validation_comparison_plot-461"><span class="linenos">461</span></a>        <span class="n">means</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">scores</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="Viz.cross_validation_comparison_plot-462"><a href="#Viz.cross_validation_comparison_plot-462"><span class="linenos">462</span></a>        <span class="n">stds</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">scores</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="Viz.cross_validation_comparison_plot-463"><a href="#Viz.cross_validation_comparison_plot-463"><span class="linenos">463</span></a>
</span><span id="Viz.cross_validation_comparison_plot-464"><a href="#Viz.cross_validation_comparison_plot-464"><span class="linenos">464</span></a>        <span class="c1"># Plot comparison</span>
</span><span id="Viz.cross_validation_comparison_plot-465"><a href="#Viz.cross_validation_comparison_plot-465"><span class="linenos">465</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Viz.cross_validation_comparison_plot-466"><a href="#Viz.cross_validation_comparison_plot-466"><span class="linenos">466</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">means</span><span class="p">)),</span> <span class="n">means</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">yerr</span><span class="o">=</span><span class="n">stds</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
</span><span id="Viz.cross_validation_comparison_plot-467"><a href="#Viz.cross_validation_comparison_plot-467"><span class="linenos">467</span></a>                <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="s1">&#39;lightgreen&#39;</span><span class="p">,</span> <span class="s1">&#39;salmon&#39;</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">])</span>
</span><span id="Viz.cross_validation_comparison_plot-468"><a href="#Viz.cross_validation_comparison_plot-468"><span class="linenos">468</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">means</span><span class="p">)),</span> <span class="n">means</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
</span><span id="Viz.cross_validation_comparison_plot-469"><a href="#Viz.cross_validation_comparison_plot-469"><span class="linenos">469</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Cross-Validation Scores Comparison&#39;</span><span class="p">)</span>
</span><span id="Viz.cross_validation_comparison_plot-470"><a href="#Viz.cross_validation_comparison_plot-470"><span class="linenos">470</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Mean CV Score&#39;</span><span class="p">)</span>
</span><span id="Viz.cross_validation_comparison_plot-471"><a href="#Viz.cross_validation_comparison_plot-471"><span class="linenos">471</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Viz.cross_validation_comparison_plot-472"><a href="#Viz.cross_validation_comparison_plot-472"><span class="linenos">472</span></a>
</span><span id="Viz.cross_validation_comparison_plot-473"><a href="#Viz.cross_validation_comparison_plot-473"><span class="linenos">473</span></a>        <span class="c1"># Add value labels</span>
</span><span id="Viz.cross_validation_comparison_plot-474"><a href="#Viz.cross_validation_comparison_plot-474"><span class="linenos">474</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">means</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="Viz.cross_validation_comparison_plot-475"><a href="#Viz.cross_validation_comparison_plot-475"><span class="linenos">475</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="o">+</span> <span class="n">stds</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">means</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">i</span><span class="p">]],</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
</span><span id="Viz.cross_validation_comparison_plot-476"><a href="#Viz.cross_validation_comparison_plot-476"><span class="linenos">476</span></a>                     <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
</span><span id="Viz.cross_validation_comparison_plot-477"><a href="#Viz.cross_validation_comparison_plot-477"><span class="linenos">477</span></a>
</span><span id="Viz.cross_validation_comparison_plot-478"><a href="#Viz.cross_validation_comparison_plot-478"><span class="linenos">478</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="Viz.cross_validation_comparison_plot-479"><a href="#Viz.cross_validation_comparison_plot-479"><span class="linenos">479</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Generates a bar plot comparing the mean and standard deviation of cross-validation
scores for multiple models. The input <code>models</code> should be a dictionary where keys
are model names and values are lists of cross-validation scores.</p>

<p>The function computes the mean and standard deviation for each model, and visualizes
them using a bar plot with error bars. Each bar represents a model's average score
with corresponding error bars indicating its standard deviation.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>models</strong>:  A dictionary where keys are model names (str) and values are lists
of cross-validation scores (list of floats).</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="Viz.grid_search_plot" class="classattr">
                                        <input id="Viz.grid_search_plot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">grid_search_plot</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">metrics_comparison</span>,</span><span class="param">	<span class="n">old_model</span>,</span><span class="param">	<span class="n">old_model_class</span>,</span><span class="param">	<span class="n">new_model</span>,</span><span class="param">	<span class="n">new_model_class</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Viz.grid_search_plot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Viz.grid_search_plot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Viz.grid_search_plot-482"><a href="#Viz.grid_search_plot-482"><span class="linenos">482</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">grid_search_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metrics_comparison</span><span class="p">,</span> <span class="n">old_model</span><span class="p">,</span> <span class="n">old_model_class</span><span class="p">,</span> <span class="n">new_model</span><span class="p">,</span> <span class="n">new_model_class</span><span class="p">):</span>
</span><span id="Viz.grid_search_plot-483"><a href="#Viz.grid_search_plot-483"><span class="linenos">483</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz.grid_search_plot-484"><a href="#Viz.grid_search_plot-484"><span class="linenos">484</span></a><span class="sd">        Plots the comparison of multiple metrics (Accuracy, Precision, Recall, F1) between</span>
</span><span id="Viz.grid_search_plot-485"><a href="#Viz.grid_search_plot-485"><span class="linenos">485</span></a><span class="sd">        two models, and their respective ROC curves. The function creates a visual comparison</span>
</span><span id="Viz.grid_search_plot-486"><a href="#Viz.grid_search_plot-486"><span class="linenos">486</span></a><span class="sd">        of an original model and a tuned model, with subplots for each metric and a separate</span>
</span><span id="Viz.grid_search_plot-487"><a href="#Viz.grid_search_plot-487"><span class="linenos">487</span></a><span class="sd">        plot for the ROC curves. Metrics are displayed as bar plots, and ROC/AUC metrics</span>
</span><span id="Viz.grid_search_plot-488"><a href="#Viz.grid_search_plot-488"><span class="linenos">488</span></a><span class="sd">        are presented as line graphs.</span>
</span><span id="Viz.grid_search_plot-489"><a href="#Viz.grid_search_plot-489"><span class="linenos">489</span></a>
</span><span id="Viz.grid_search_plot-490"><a href="#Viz.grid_search_plot-490"><span class="linenos">490</span></a><span class="sd">        :param metrics_comparison: A dictionary containing metric values (e.g. Accuracy,</span>
</span><span id="Viz.grid_search_plot-491"><a href="#Viz.grid_search_plot-491"><span class="linenos">491</span></a><span class="sd">            Precision, Recall, F1) for the models being compared. The keys should include &#39;Original&#39;</span>
</span><span id="Viz.grid_search_plot-492"><a href="#Viz.grid_search_plot-492"><span class="linenos">492</span></a><span class="sd">            and &#39;Tuned&#39;, with associated metrics as subkeys.</span>
</span><span id="Viz.grid_search_plot-493"><a href="#Viz.grid_search_plot-493"><span class="linenos">493</span></a><span class="sd">        :type metrics_comparison: dict</span>
</span><span id="Viz.grid_search_plot-494"><a href="#Viz.grid_search_plot-494"><span class="linenos">494</span></a><span class="sd">        :param old_model: The original, &#39;untuned&#39; machine learning model. Must be a model</span>
</span><span id="Viz.grid_search_plot-495"><a href="#Viz.grid_search_plot-495"><span class="linenos">495</span></a><span class="sd">            object with a `predict_proba` method.</span>
</span><span id="Viz.grid_search_plot-496"><a href="#Viz.grid_search_plot-496"><span class="linenos">496</span></a><span class="sd">        :param old_model_class: An object encapsulating the test data (`X_test`, `y_test`).</span>
</span><span id="Viz.grid_search_plot-497"><a href="#Viz.grid_search_plot-497"><span class="linenos">497</span></a><span class="sd">            Must provide a `y_test` attribute and `X_test` attribute for predictions.</span>
</span><span id="Viz.grid_search_plot-498"><a href="#Viz.grid_search_plot-498"><span class="linenos">498</span></a><span class="sd">        :type old_model_class: object</span>
</span><span id="Viz.grid_search_plot-499"><a href="#Viz.grid_search_plot-499"><span class="linenos">499</span></a><span class="sd">        :param new_model: The optimized or tuned machine learning model. Must be a model</span>
</span><span id="Viz.grid_search_plot-500"><a href="#Viz.grid_search_plot-500"><span class="linenos">500</span></a><span class="sd">            object with a `predict_proba` method.</span>
</span><span id="Viz.grid_search_plot-501"><a href="#Viz.grid_search_plot-501"><span class="linenos">501</span></a><span class="sd">        :param new_model_class: An object encapsulating test data (`X_test`, `y_test`)</span>
</span><span id="Viz.grid_search_plot-502"><a href="#Viz.grid_search_plot-502"><span class="linenos">502</span></a><span class="sd">            for the tuned model. Must provide a `y_test` attribute and `X_test` attribute</span>
</span><span id="Viz.grid_search_plot-503"><a href="#Viz.grid_search_plot-503"><span class="linenos">503</span></a><span class="sd">            for predictions.</span>
</span><span id="Viz.grid_search_plot-504"><a href="#Viz.grid_search_plot-504"><span class="linenos">504</span></a><span class="sd">        :type new_model_class: object</span>
</span><span id="Viz.grid_search_plot-505"><a href="#Viz.grid_search_plot-505"><span class="linenos">505</span></a>
</span><span id="Viz.grid_search_plot-506"><a href="#Viz.grid_search_plot-506"><span class="linenos">506</span></a><span class="sd">        :return: None</span>
</span><span id="Viz.grid_search_plot-507"><a href="#Viz.grid_search_plot-507"><span class="linenos">507</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz.grid_search_plot-508"><a href="#Viz.grid_search_plot-508"><span class="linenos">508</span></a>        <span class="c1"># Create subplots for each metric</span>
</span><span id="Viz.grid_search_plot-509"><a href="#Viz.grid_search_plot-509"><span class="linenos">509</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">),</span> <span class="p">(</span><span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">))</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="Viz.grid_search_plot-510"><a href="#Viz.grid_search_plot-510"><span class="linenos">510</span></a>
</span><span id="Viz.grid_search_plot-511"><a href="#Viz.grid_search_plot-511"><span class="linenos">511</span></a>        <span class="c1"># Plot each metric</span>
</span><span id="Viz.grid_search_plot-512"><a href="#Viz.grid_search_plot-512"><span class="linenos">512</span></a>        <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;Precision&#39;</span><span class="p">,</span> <span class="s1">&#39;Recall&#39;</span><span class="p">,</span> <span class="s1">&#39;F1&#39;</span><span class="p">]</span>
</span><span id="Viz.grid_search_plot-513"><a href="#Viz.grid_search_plot-513"><span class="linenos">513</span></a>        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="s1">&#39;lightgreen&#39;</span><span class="p">]</span>
</span><span id="Viz.grid_search_plot-514"><a href="#Viz.grid_search_plot-514"><span class="linenos">514</span></a>
</span><span id="Viz.grid_search_plot-515"><a href="#Viz.grid_search_plot-515"><span class="linenos">515</span></a>        <span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">metrics</span><span class="p">,</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">]):</span>
</span><span id="Viz.grid_search_plot-516"><a href="#Viz.grid_search_plot-516"><span class="linenos">516</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">metrics_comparison</span><span class="p">[</span><span class="s1">&#39;Original&#39;</span><span class="p">][</span><span class="n">metric</span><span class="p">],</span>
</span><span id="Viz.grid_search_plot-517"><a href="#Viz.grid_search_plot-517"><span class="linenos">517</span></a>                      <span class="n">metrics_comparison</span><span class="p">[</span><span class="s1">&#39;Tuned&#39;</span><span class="p">][</span><span class="n">metric</span><span class="p">]]</span>
</span><span id="Viz.grid_search_plot-518"><a href="#Viz.grid_search_plot-518"><span class="linenos">518</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="s1">&#39;Original&#39;</span><span class="p">,</span> <span class="s1">&#39;Tuned&#39;</span><span class="p">],</span> <span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
</span><span id="Viz.grid_search_plot-519"><a href="#Viz.grid_search_plot-519"><span class="linenos">519</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s1"> Comparison&#39;</span><span class="p">)</span>
</span><span id="Viz.grid_search_plot-520"><a href="#Viz.grid_search_plot-520"><span class="linenos">520</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Viz.grid_search_plot-521"><a href="#Viz.grid_search_plot-521"><span class="linenos">521</span></a>
</span><span id="Viz.grid_search_plot-522"><a href="#Viz.grid_search_plot-522"><span class="linenos">522</span></a>            <span class="c1"># Add value labels</span>
</span><span id="Viz.grid_search_plot-523"><a href="#Viz.grid_search_plot-523"><span class="linenos">523</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
</span><span id="Viz.grid_search_plot-524"><a href="#Viz.grid_search_plot-524"><span class="linenos">524</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
</span><span id="Viz.grid_search_plot-525"><a href="#Viz.grid_search_plot-525"><span class="linenos">525</span></a>
</span><span id="Viz.grid_search_plot-526"><a href="#Viz.grid_search_plot-526"><span class="linenos">526</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="Viz.grid_search_plot-527"><a href="#Viz.grid_search_plot-527"><span class="linenos">527</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="Viz.grid_search_plot-528"><a href="#Viz.grid_search_plot-528"><span class="linenos">528</span></a>
</span><span id="Viz.grid_search_plot-529"><a href="#Viz.grid_search_plot-529"><span class="linenos">529</span></a>        <span class="c1"># Plot ROC curves for both models</span>
</span><span id="Viz.grid_search_plot-530"><a href="#Viz.grid_search_plot-530"><span class="linenos">530</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Viz.grid_search_plot-531"><a href="#Viz.grid_search_plot-531"><span class="linenos">531</span></a>
</span><span id="Viz.grid_search_plot-532"><a href="#Viz.grid_search_plot-532"><span class="linenos">532</span></a>        <span class="c1"># Original model ROC curve</span>
</span><span id="Viz.grid_search_plot-533"><a href="#Viz.grid_search_plot-533"><span class="linenos">533</span></a>        <span class="n">fpr_orig</span><span class="p">,</span> <span class="n">tpr_orig</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">old_model_class</span><span class="o">.</span><span class="n">y_test</span><span class="p">,</span> <span class="n">old_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">old_model_class</span><span class="o">.</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="Viz.grid_search_plot-534"><a href="#Viz.grid_search_plot-534"><span class="linenos">534</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_orig</span><span class="p">,</span> <span class="n">tpr_orig</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span>
</span><span id="Viz.grid_search_plot-535"><a href="#Viz.grid_search_plot-535"><span class="linenos">535</span></a>                 <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Original (AUC = </span><span class="si">{</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">old_model_class</span><span class="o">.</span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">old_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">old_model_class</span><span class="o">.</span><span class="n">X_test</span><span class="p">)[:,</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</span><span id="Viz.grid_search_plot-536"><a href="#Viz.grid_search_plot-536"><span class="linenos">536</span></a>
</span><span id="Viz.grid_search_plot-537"><a href="#Viz.grid_search_plot-537"><span class="linenos">537</span></a>        <span class="c1"># Tuned model ROC curve</span>
</span><span id="Viz.grid_search_plot-538"><a href="#Viz.grid_search_plot-538"><span class="linenos">538</span></a>        <span class="n">fpr_tuned</span><span class="p">,</span> <span class="n">tpr_tuned</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">new_model_class</span><span class="o">.</span><span class="n">y_test</span><span class="p">,</span> <span class="n">new_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">new_model_class</span><span class="o">.</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="Viz.grid_search_plot-539"><a href="#Viz.grid_search_plot-539"><span class="linenos">539</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_tuned</span><span class="p">,</span> <span class="n">tpr_tuned</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgreen&#39;</span><span class="p">,</span>
</span><span id="Viz.grid_search_plot-540"><a href="#Viz.grid_search_plot-540"><span class="linenos">540</span></a>                 <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Tuned (AUC = </span><span class="si">{</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">new_model_class</span><span class="o">.</span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">new_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">new_model_class</span><span class="o">.</span><span class="n">X_test</span><span class="p">)[:,</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</span><span id="Viz.grid_search_plot-541"><a href="#Viz.grid_search_plot-541"><span class="linenos">541</span></a>
</span><span id="Viz.grid_search_plot-542"><a href="#Viz.grid_search_plot-542"><span class="linenos">542</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
</span><span id="Viz.grid_search_plot-543"><a href="#Viz.grid_search_plot-543"><span class="linenos">543</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
</span><span id="Viz.grid_search_plot-544"><a href="#Viz.grid_search_plot-544"><span class="linenos">544</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
</span><span id="Viz.grid_search_plot-545"><a href="#Viz.grid_search_plot-545"><span class="linenos">545</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;False Positive Rate&#39;</span><span class="p">)</span>
</span><span id="Viz.grid_search_plot-546"><a href="#Viz.grid_search_plot-546"><span class="linenos">546</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;True Positive Rate&#39;</span><span class="p">)</span>
</span><span id="Viz.grid_search_plot-547"><a href="#Viz.grid_search_plot-547"><span class="linenos">547</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ROC Curves Comparison&#39;</span><span class="p">)</span>
</span><span id="Viz.grid_search_plot-548"><a href="#Viz.grid_search_plot-548"><span class="linenos">548</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
</span><span id="Viz.grid_search_plot-549"><a href="#Viz.grid_search_plot-549"><span class="linenos">549</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Plots the comparison of multiple metrics (Accuracy, Precision, Recall, F1) between
two models, and their respective ROC curves. The function creates a visual comparison
of an original model and a tuned model, with subplots for each metric and a separate
plot for the ROC curves. Metrics are displayed as bar plots, and ROC/AUC metrics
are presented as line graphs.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>metrics_comparison</strong>:  A dictionary containing metric values (e.g. Accuracy,
Precision, Recall, F1) for the models being compared. The keys should include 'Original'
and 'Tuned', with associated metrics as subkeys.</li>
<li><strong>old_model</strong>:  The original, 'untuned' machine learning model. Must be a model
object with a <code>predict_proba</code> method.</li>
<li><strong>old_model_class</strong>:  An object encapsulating the test data (<code>X_test</code>, <code>y_test</code>).
Must provide a <code>y_test</code> attribute and <code>X_test</code> attribute for predictions.</li>
<li><strong>new_model</strong>:  The optimized or tuned machine learning model. Must be a model
object with a <code>predict_proba</code> method.</li>
<li><strong>new_model_class</strong>:  An object encapsulating test data (<code>X_test</code>, <code>y_test</code>)
for the tuned model. Must provide a <code>y_test</code> attribute and <code>X_test</code> attribute
for predictions.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="Viz.cv_plot" class="classattr">
                                        <input id="Viz.cv_plot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">cv_plot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">cv_results</span>, </span><span class="param"><span class="n">models</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Viz.cv_plot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Viz.cv_plot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Viz.cv_plot-552"><a href="#Viz.cv_plot-552"><span class="linenos">552</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cv_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cv_results</span><span class="p">,</span> <span class="n">models</span><span class="p">):</span>
</span><span id="Viz.cv_plot-553"><a href="#Viz.cv_plot-553"><span class="linenos">553</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Viz.cv_plot-554"><a href="#Viz.cv_plot-554"><span class="linenos">554</span></a><span class="sd">        Plots cross-validation results for multiple models.</span>
</span><span id="Viz.cv_plot-555"><a href="#Viz.cv_plot-555"><span class="linenos">555</span></a>
</span><span id="Viz.cv_plot-556"><a href="#Viz.cv_plot-556"><span class="linenos">556</span></a><span class="sd">        This function generates bar plots for evaluation metrics such as accuracy,</span>
</span><span id="Viz.cv_plot-557"><a href="#Viz.cv_plot-557"><span class="linenos">557</span></a><span class="sd">        precision, recall, and F1-score. Each plot displays the mean values along</span>
</span><span id="Viz.cv_plot-558"><a href="#Viz.cv_plot-558"><span class="linenos">558</span></a><span class="sd">        with error bars representing the standard deviation for the specified metrics.</span>
</span><span id="Viz.cv_plot-559"><a href="#Viz.cv_plot-559"><span class="linenos">559</span></a><span class="sd">        The results are visualized using a grid layout.</span>
</span><span id="Viz.cv_plot-560"><a href="#Viz.cv_plot-560"><span class="linenos">560</span></a>
</span><span id="Viz.cv_plot-561"><a href="#Viz.cv_plot-561"><span class="linenos">561</span></a><span class="sd">        :param cv_results: A dictionary containing cross-validation results for</span>
</span><span id="Viz.cv_plot-562"><a href="#Viz.cv_plot-562"><span class="linenos">562</span></a><span class="sd">            each model. The format should be:</span>
</span><span id="Viz.cv_plot-563"><a href="#Viz.cv_plot-563"><span class="linenos">563</span></a><span class="sd">            {</span>
</span><span id="Viz.cv_plot-564"><a href="#Viz.cv_plot-564"><span class="linenos">564</span></a><span class="sd">                &#39;model_name&#39;: {</span>
</span><span id="Viz.cv_plot-565"><a href="#Viz.cv_plot-565"><span class="linenos">565</span></a><span class="sd">                    &#39;accuracy&#39;: {&#39;mean&#39;: float, &#39;std&#39;: float},</span>
</span><span id="Viz.cv_plot-566"><a href="#Viz.cv_plot-566"><span class="linenos">566</span></a><span class="sd">                    &#39;precision&#39;: {&#39;mean&#39;: float, &#39;std&#39;: float},</span>
</span><span id="Viz.cv_plot-567"><a href="#Viz.cv_plot-567"><span class="linenos">567</span></a><span class="sd">                    &#39;recall&#39;: {&#39;mean&#39;: float, &#39;std&#39;: float},</span>
</span><span id="Viz.cv_plot-568"><a href="#Viz.cv_plot-568"><span class="linenos">568</span></a><span class="sd">                    &#39;f1&#39;: {&#39;mean&#39;: float, &#39;std&#39;: float}</span>
</span><span id="Viz.cv_plot-569"><a href="#Viz.cv_plot-569"><span class="linenos">569</span></a><span class="sd">                },</span>
</span><span id="Viz.cv_plot-570"><a href="#Viz.cv_plot-570"><span class="linenos">570</span></a><span class="sd">                ...</span>
</span><span id="Viz.cv_plot-571"><a href="#Viz.cv_plot-571"><span class="linenos">571</span></a><span class="sd">            }</span>
</span><span id="Viz.cv_plot-572"><a href="#Viz.cv_plot-572"><span class="linenos">572</span></a><span class="sd">        :param dict models: A dictionary containing model names as keys and their</span>
</span><span id="Viz.cv_plot-573"><a href="#Viz.cv_plot-573"><span class="linenos">573</span></a><span class="sd">            corresponding estimators or classifiers as values. The keys are used in the</span>
</span><span id="Viz.cv_plot-574"><a href="#Viz.cv_plot-574"><span class="linenos">574</span></a><span class="sd">            plot as labels.</span>
</span><span id="Viz.cv_plot-575"><a href="#Viz.cv_plot-575"><span class="linenos">575</span></a><span class="sd">        :return: None</span>
</span><span id="Viz.cv_plot-576"><a href="#Viz.cv_plot-576"><span class="linenos">576</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Viz.cv_plot-577"><a href="#Viz.cv_plot-577"><span class="linenos">577</span></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="Viz.cv_plot-578"><a href="#Viz.cv_plot-578"><span class="linenos">578</span></a>
</span><span id="Viz.cv_plot-579"><a href="#Viz.cv_plot-579"><span class="linenos">579</span></a>        <span class="c1"># Plot results</span>
</span><span id="Viz.cv_plot-580"><a href="#Viz.cv_plot-580"><span class="linenos">580</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">),</span> <span class="p">(</span><span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">))</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="Viz.cv_plot-581"><a href="#Viz.cv_plot-581"><span class="linenos">581</span></a>
</span><span id="Viz.cv_plot-582"><a href="#Viz.cv_plot-582"><span class="linenos">582</span></a>        <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="s1">&#39;recall&#39;</span><span class="p">,</span> <span class="s1">&#39;f1&#39;</span><span class="p">]</span>
</span><span id="Viz.cv_plot-583"><a href="#Viz.cv_plot-583"><span class="linenos">583</span></a>        <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">]</span>
</span><span id="Viz.cv_plot-584"><a href="#Viz.cv_plot-584"><span class="linenos">584</span></a>        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="s1">&#39;lightgreen&#39;</span><span class="p">,</span> <span class="s1">&#39;salmon&#39;</span><span class="p">]</span>
</span><span id="Viz.cv_plot-585"><a href="#Viz.cv_plot-585"><span class="linenos">585</span></a>
</span><span id="Viz.cv_plot-586"><a href="#Viz.cv_plot-586"><span class="linenos">586</span></a>        <span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">metrics</span><span class="p">,</span> <span class="n">axes</span><span class="p">):</span>
</span><span id="Viz.cv_plot-587"><a href="#Viz.cv_plot-587"><span class="linenos">587</span></a>            <span class="n">means</span> <span class="o">=</span> <span class="p">[</span><span class="n">cv_results</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">metric</span><span class="p">][</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
</span><span id="Viz.cv_plot-588"><a href="#Viz.cv_plot-588"><span class="linenos">588</span></a>            <span class="n">stds</span> <span class="o">=</span> <span class="p">[</span><span class="n">cv_results</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">metric</span><span class="p">][</span><span class="s1">&#39;std&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
</span><span id="Viz.cv_plot-589"><a href="#Viz.cv_plot-589"><span class="linenos">589</span></a>
</span><span id="Viz.cv_plot-590"><a href="#Viz.cv_plot-590"><span class="linenos">590</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">))</span>
</span><span id="Viz.cv_plot-591"><a href="#Viz.cv_plot-591"><span class="linenos">591</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">means</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">stds</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
</span><span id="Viz.cv_plot-592"><a href="#Viz.cv_plot-592"><span class="linenos">592</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Viz.cv_plot-593"><a href="#Viz.cv_plot-593"><span class="linenos">593</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
</span><span id="Viz.cv_plot-594"><a href="#Viz.cv_plot-594"><span class="linenos">594</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">metric</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s1"> Score&#39;</span><span class="p">)</span>
</span><span id="Viz.cv_plot-595"><a href="#Viz.cv_plot-595"><span class="linenos">595</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Viz.cv_plot-596"><a href="#Viz.cv_plot-596"><span class="linenos">596</span></a>
</span><span id="Viz.cv_plot-597"><a href="#Viz.cv_plot-597"><span class="linenos">597</span></a>            <span class="c1"># Add value labels</span>
</span><span id="Viz.cv_plot-598"><a href="#Viz.cv_plot-598"><span class="linenos">598</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">means</span><span class="p">):</span>
</span><span id="Viz.cv_plot-599"><a href="#Viz.cv_plot-599"><span class="linenos">599</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="o">+</span> <span class="n">stds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
</span><span id="Viz.cv_plot-600"><a href="#Viz.cv_plot-600"><span class="linenos">600</span></a>
</span><span id="Viz.cv_plot-601"><a href="#Viz.cv_plot-601"><span class="linenos">601</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="Viz.cv_plot-602"><a href="#Viz.cv_plot-602"><span class="linenos">602</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Plots cross-validation results for multiple models.</p>

<p>This function generates bar plots for evaluation metrics such as accuracy,
precision, recall, and F1-score. Each plot displays the mean values along
with error bars representing the standard deviation for the specified metrics.
The results are visualized using a grid layout.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>cv_results</strong>:  A dictionary containing cross-validation results for
each model. The format should be:
{
    'model_name': {
        'accuracy': {'mean': float, 'std': float},
        'precision': {'mean': float, 'std': float},
        'recall': {'mean': float, 'std': float},
        'f1': {'mean': float, 'std': float}
    },
    ...
}</li>
<li><strong>dict models</strong>:  A dictionary containing model names as keys and their
corresponding estimators or classifiers as values. The keys are used in the
plot as labels.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                </section>
    </main>
</body>
</html>